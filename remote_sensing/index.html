
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="package to easily get data relevant to snow">
      
      
        <meta name="author" content="egagli">
      
      
        <link rel="canonical" href="https://egagli.github.io/easysnowdata/remote_sensing/">
      
      
        <link rel="prev" href="../easysnowdata/">
      
      
        <link rel="next" href="../automatic_weather_stations/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>remote_sensing module - easysnowdata</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Google+Sans:300,300i,400,400i,700,700i%7CRegular:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Google Sans";--md-code-font:"Regular"}</style>
      
    
    
      <link rel="stylesheet" href="../css/timeago.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#remote_sensing-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="easysnowdata" class="md-header__button md-logo" aria-label="easysnowdata" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            easysnowdata
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              remote_sensing module
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/egagli/easysnowdata" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="easysnowdata" class="md-nav__button md-logo" aria-label="easysnowdata" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    easysnowdata
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/egagli/easysnowdata" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/egagli/easysnowdata/issues" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Report Issues
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/remote_sensing_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remote sensing examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/automatic_weather_station_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automatic weather station examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/topography_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Topography examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/hydroclimatology_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hydroclimatology examples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../easysnowdata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    easysnowdata module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    remote_sensing module
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    remote_sensing module
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing" class="md-nav__link">
    <span class="md-ellipsis">
      easysnowdata.remote_sensing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS" class="md-nav__link">
    <span class="md-ellipsis">
      HLS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HLS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.get_ndvi" class="md-nav__link">
    <span class="md-ellipsis">
      get_ndvi()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.get_rgb" class="md-nav__link">
    <span class="md-ellipsis">
      get_rgb()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.get_rgb_clahe" class="md-nav__link">
    <span class="md-ellipsis">
      get_rgb_clahe()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.get_rgb_percentile" class="md-nav__link">
    <span class="md-ellipsis">
      get_rgb_percentile()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.mask_data" class="md-nav__link">
    <span class="md-ellipsis">
      mask_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.remove_nodata_inplace" class="md-nav__link">
    <span class="md-ellipsis">
      remove_nodata_inplace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.scale_data_inplace" class="md-nav__link">
    <span class="md-ellipsis">
      scale_data_inplace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.search_data" class="md-nav__link">
    <span class="md-ellipsis">
      search_data()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.MODIS_snow" class="md-nav__link">
    <span class="md-ellipsis">
      MODIS_snow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1" class="md-nav__link">
    <span class="md-ellipsis">
      Sentinel1
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sentinel1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.add_orbit_info" class="md-nav__link">
    <span class="md-ellipsis">
      add_orbit_info()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.db_to_linear" class="md-nav__link">
    <span class="md-ellipsis">
      db_to_linear()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.get_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.linear_to_db" class="md-nav__link">
    <span class="md-ellipsis">
      linear_to_db()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.search_data" class="md-nav__link">
    <span class="md-ellipsis">
      search_data()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2" class="md-nav__link">
    <span class="md-ellipsis">
      Sentinel2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sentinel2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_evi" class="md-nav__link">
    <span class="md-ellipsis">
      get_evi()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_ndbi" class="md-nav__link">
    <span class="md-ellipsis">
      get_ndbi()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_ndsi" class="md-nav__link">
    <span class="md-ellipsis">
      get_ndsi()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_ndvi" class="md-nav__link">
    <span class="md-ellipsis">
      get_ndvi()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_ndwi" class="md-nav__link">
    <span class="md-ellipsis">
      get_ndwi()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_rgb" class="md-nav__link">
    <span class="md-ellipsis">
      get_rgb()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_rgb_clahe" class="md-nav__link">
    <span class="md-ellipsis">
      get_rgb_clahe()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_rgb_percentile" class="md-nav__link">
    <span class="md-ellipsis">
      get_rgb_percentile()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.harmonize_to_old_inplace" class="md-nav__link">
    <span class="md-ellipsis">
      harmonize_to_old_inplace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.mask_data" class="md-nav__link">
    <span class="md-ellipsis">
      mask_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.remove_nodata_inplace" class="md-nav__link">
    <span class="md-ellipsis">
      remove_nodata_inplace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.scale_data_inplace" class="md-nav__link">
    <span class="md-ellipsis">
      scale_data_inplace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.search_data" class="md-nav__link">
    <span class="md-ellipsis">
      search_data()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.authenticate_all" class="md-nav__link">
    <span class="md-ellipsis">
      authenticate_all()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.get_esa_worldcover" class="md-nav__link">
    <span class="md-ellipsis">
      get_esa_worldcover()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.get_forest_cover_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      get_forest_cover_fraction()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.get_nlcd_landcover" class="md-nav__link">
    <span class="md-ellipsis">
      get_nlcd_landcover()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.get_seasonal_mountain_snow_mask" class="md-nav__link">
    <span class="md-ellipsis">
      get_seasonal_mountain_snow_mask()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.get_seasonal_snow_classification" class="md-nav__link">
    <span class="md-ellipsis">
      get_seasonal_snow_classification()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../automatic_weather_stations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    automatic_weather_station module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    topography module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydroclimatology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hydroclimatology module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils module
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing" class="md-nav__link">
    <span class="md-ellipsis">
      easysnowdata.remote_sensing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS" class="md-nav__link">
    <span class="md-ellipsis">
      HLS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HLS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.get_ndvi" class="md-nav__link">
    <span class="md-ellipsis">
      get_ndvi()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.get_rgb" class="md-nav__link">
    <span class="md-ellipsis">
      get_rgb()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.get_rgb_clahe" class="md-nav__link">
    <span class="md-ellipsis">
      get_rgb_clahe()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.get_rgb_percentile" class="md-nav__link">
    <span class="md-ellipsis">
      get_rgb_percentile()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.mask_data" class="md-nav__link">
    <span class="md-ellipsis">
      mask_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.remove_nodata_inplace" class="md-nav__link">
    <span class="md-ellipsis">
      remove_nodata_inplace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.scale_data_inplace" class="md-nav__link">
    <span class="md-ellipsis">
      scale_data_inplace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.HLS.search_data" class="md-nav__link">
    <span class="md-ellipsis">
      search_data()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.MODIS_snow" class="md-nav__link">
    <span class="md-ellipsis">
      MODIS_snow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1" class="md-nav__link">
    <span class="md-ellipsis">
      Sentinel1
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sentinel1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.add_orbit_info" class="md-nav__link">
    <span class="md-ellipsis">
      add_orbit_info()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.db_to_linear" class="md-nav__link">
    <span class="md-ellipsis">
      db_to_linear()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.get_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.linear_to_db" class="md-nav__link">
    <span class="md-ellipsis">
      linear_to_db()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel1.search_data" class="md-nav__link">
    <span class="md-ellipsis">
      search_data()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2" class="md-nav__link">
    <span class="md-ellipsis">
      Sentinel2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sentinel2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_evi" class="md-nav__link">
    <span class="md-ellipsis">
      get_evi()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_ndbi" class="md-nav__link">
    <span class="md-ellipsis">
      get_ndbi()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_ndsi" class="md-nav__link">
    <span class="md-ellipsis">
      get_ndsi()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_ndvi" class="md-nav__link">
    <span class="md-ellipsis">
      get_ndvi()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_ndwi" class="md-nav__link">
    <span class="md-ellipsis">
      get_ndwi()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_rgb" class="md-nav__link">
    <span class="md-ellipsis">
      get_rgb()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_rgb_clahe" class="md-nav__link">
    <span class="md-ellipsis">
      get_rgb_clahe()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.get_rgb_percentile" class="md-nav__link">
    <span class="md-ellipsis">
      get_rgb_percentile()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.harmonize_to_old_inplace" class="md-nav__link">
    <span class="md-ellipsis">
      harmonize_to_old_inplace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.mask_data" class="md-nav__link">
    <span class="md-ellipsis">
      mask_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.remove_nodata_inplace" class="md-nav__link">
    <span class="md-ellipsis">
      remove_nodata_inplace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.scale_data_inplace" class="md-nav__link">
    <span class="md-ellipsis">
      scale_data_inplace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.Sentinel2.search_data" class="md-nav__link">
    <span class="md-ellipsis">
      search_data()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.authenticate_all" class="md-nav__link">
    <span class="md-ellipsis">
      authenticate_all()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.get_esa_worldcover" class="md-nav__link">
    <span class="md-ellipsis">
      get_esa_worldcover()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.get_forest_cover_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      get_forest_cover_fraction()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.get_nlcd_landcover" class="md-nav__link">
    <span class="md-ellipsis">
      get_nlcd_landcover()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.get_seasonal_mountain_snow_mask" class="md-nav__link">
    <span class="md-ellipsis">
      get_seasonal_mountain_snow_mask()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easysnowdata.remote_sensing.get_seasonal_snow_classification" class="md-nav__link">
    <span class="md-ellipsis">
      get_seasonal_snow_classification()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                



                  


  
  


<h1 id="remote_sensing-module">remote_sensing module<a class="headerlink" href="#remote_sensing-module" title="Permanent link">&para;</a></h1>


  <div class="doc doc-object doc-module">

<a id="easysnowdata.remote_sensing"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">









  <div class="doc doc-object doc-class">



<h2 id="easysnowdata.remote_sensing.HLS" class="doc doc-heading">
        <code>
HLS        </code>



<a href="#easysnowdata.remote_sensing.HLS" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>A class to handle Harmonized Landsat Sentinel (HLS) satellite data.</p>
<p>This class provides functionality to search, retrieve, and process HLS data, which combines
data from Landsat and Sentinel-2 satellites. It supports various data operations including
masking, scaling, and metadata retrieval.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox_input</code></td>
        <td><code>geopandas.GeoDataFrame or tuple or Shapely Geometry</code></td>
        <td><p>GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date for the data in the format 'YYYY-MM-DD'. Default is '2014-01-01'.</p></td>
        <td><code>&#39;2014-01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date for the data in the format 'YYYY-MM-DD'. Default is today's date.</p></td>
        <td><code>&#39;2025-03-03&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>The bands to be used. Default is all bands.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>resolution</code></td>
        <td><code>str</code></td>
        <td><p>The resolution of the data. Defaults to native resolution.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system. Default is 'utm'.</p></td>
        <td><code>&#39;utm&#39;</code></td>
      </tr>
      <tr>
        <td><code>remove_nodata</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove no data values. Default is True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>scale_data</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to scale the data. Default is True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>add_metadata</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add metadata to the data. Default is True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>add_platform</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add platform information to the data. Default is True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>groupby</code></td>
        <td><code>str</code></td>
        <td><p>The groupby parameter for the data. Default is "solar_day".</p></td>
        <td><code>&#39;solar_day&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>xarray.Dataset</code></td>
        <td><p>The loaded HLS data.</p></td>
      </tr>
      <tr>
        <td><code>metadata</code></td>
        <td><code>geopandas.GeoDataFrame</code></td>
        <td><p>Metadata for the retrieved HLS scenes.</p></td>
      </tr>
      <tr>
        <td><code>rgb</code></td>
        <td><code>xarray.DataArray</code></td>
        <td><p>RGB composite of the HLS data.</p></td>
      </tr>
      <tr>
        <td><code>ndvi</code></td>
        <td><code>xarray.DataArray</code></td>
        <td><p>Normalized Difference Vegetation Index (NDVI) calculated from the data.</p></td>
      </tr>
      <tr>
        <td><code>Methods</code></td>
        <td><code>None</code></td>
        <td></td>
      </tr>
      <tr>
        <td><code>-------</code></td>
        <td><code>None</code></td>
        <td></td>
      </tr>
      <tr>
        <td><code>search_data()</code></td>
        <td><code>None</code></td>
        <td><p>Searches for HLS data based on the specified parameters.</p></td>
      </tr>
      <tr>
        <td><code>get_data()</code></td>
        <td><code>None</code></td>
        <td><p>Retrieves the HLS data based on the search results.</p></td>
      </tr>
      <tr>
        <td><code>get_metadata()</code></td>
        <td><code>None</code></td>
        <td><p>Retrieves metadata for the HLS scenes.</p></td>
      </tr>
      <tr>
        <td><code>get_combined_metadata()</code></td>
        <td><code>None</code></td>
        <td><p>Retrieves and combines metadata for both Landsat and Sentinel-2 scenes.</p></td>
      </tr>
      <tr>
        <td><code>remove_nodata_inplace()</code></td>
        <td><code>None</code></td>
        <td><p>Removes no data values from the data.</p></td>
      </tr>
      <tr>
        <td><code>mask_data()</code></td>
        <td><code>None</code></td>
        <td><p>Masks the data based on the Fmask quality layer.</p></td>
      </tr>
      <tr>
        <td><code>scale_data_inplace()</code></td>
        <td><code>None</code></td>
        <td><p>Scales the data to reflectance values.</p></td>
      </tr>
      <tr>
        <td><code>add_platform_inplace()</code></td>
        <td><code>None</code></td>
        <td><p>Adds platform information to the data as coordinates.</p></td>
      </tr>
      <tr>
        <td><code>get_rgb()</code></td>
        <td><code>None</code></td>
        <td><p>Retrieves the RGB composite of the data.</p></td>
      </tr>
      <tr>
        <td><code>get_ndvi()</code></td>
        <td><code>None</code></td>
        <td><p>Calculates the Normalized Difference Vegetation Index (NDVI).</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">HLS</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to handle Harmonized Landsat Sentinel (HLS) satellite data.</span>

<span class="sd">    This class provides functionality to search, retrieve, and process HLS data, which combines</span>
<span class="sd">    data from Landsat and Sentinel-2 satellites. It supports various data operations including</span>
<span class="sd">    masking, scaling, and metadata retrieval.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bbox_input : geopandas.GeoDataFrame or tuple or Shapely Geometry</span>
<span class="sd">        GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">    start_date : str, optional</span>
<span class="sd">        The start date for the data in the format &#39;YYYY-MM-DD&#39;. Default is &#39;2014-01-01&#39;.</span>
<span class="sd">    end_date : str, optional</span>
<span class="sd">        The end date for the data in the format &#39;YYYY-MM-DD&#39;. Default is today&#39;s date.</span>
<span class="sd">    bands : list, optional</span>
<span class="sd">        The bands to be used. Default is all bands.</span>
<span class="sd">    resolution : str, optional</span>
<span class="sd">        The resolution of the data. Defaults to native resolution.</span>
<span class="sd">    crs : str, optional</span>
<span class="sd">        The coordinate reference system. Default is &#39;utm&#39;.</span>
<span class="sd">    remove_nodata : bool, optional</span>
<span class="sd">        Whether to remove no data values. Default is True.</span>
<span class="sd">    scale_data : bool, optional</span>
<span class="sd">        Whether to scale the data. Default is True.</span>
<span class="sd">    add_metadata : bool, optional</span>
<span class="sd">        Whether to add metadata to the data. Default is True.</span>
<span class="sd">    add_platform : bool, optional</span>
<span class="sd">        Whether to add platform information to the data. Default is True.</span>
<span class="sd">    groupby : str, optional</span>
<span class="sd">        The groupby parameter for the data. Default is &quot;solar_day&quot;.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    data : xarray.Dataset</span>
<span class="sd">        The loaded HLS data.</span>
<span class="sd">    metadata : geopandas.GeoDataFrame</span>
<span class="sd">        Metadata for the retrieved HLS scenes.</span>
<span class="sd">    rgb : xarray.DataArray</span>
<span class="sd">        RGB composite of the HLS data.</span>
<span class="sd">    ndvi : xarray.DataArray</span>
<span class="sd">        Normalized Difference Vegetation Index (NDVI) calculated from the data.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    search_data()</span>
<span class="sd">        Searches for HLS data based on the specified parameters.</span>
<span class="sd">    get_data()</span>
<span class="sd">        Retrieves the HLS data based on the search results.</span>
<span class="sd">    get_metadata()</span>
<span class="sd">        Retrieves metadata for the HLS scenes.</span>
<span class="sd">    get_combined_metadata()</span>
<span class="sd">        Retrieves and combines metadata for both Landsat and Sentinel-2 scenes.</span>
<span class="sd">    remove_nodata_inplace()</span>
<span class="sd">        Removes no data values from the data.</span>
<span class="sd">    mask_data()</span>
<span class="sd">        Masks the data based on the Fmask quality layer.</span>
<span class="sd">    scale_data_inplace()</span>
<span class="sd">        Scales the data to reflectance values.</span>
<span class="sd">    add_platform_inplace()</span>
<span class="sd">        Adds platform information to the data as coordinates.</span>
<span class="sd">    get_rgb()</span>
<span class="sd">        Retrieves the RGB composite of the data.</span>
<span class="sd">    get_ndvi()</span>
<span class="sd">        Calculates the Normalized Difference Vegetation Index (NDVI).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># https://lpdaac.usgs.gov/documents/1698/HLS_User_Guide_V2.pdf</span>
    <span class="c1"># https://lpdaac.usgs.gov/documents/842/HLS_Tutorial.html</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bbox_input</span><span class="p">,</span>
        <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2014-01-01&quot;</span><span class="p">,</span>
        <span class="n">end_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;utm&quot;</span><span class="p">,</span>
        <span class="n">remove_nodata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">scale_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">add_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">add_platform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">groupby</span><span class="o">=</span><span class="s2">&quot;solar_day&quot;</span><span class="p">,</span>
    <span class="p">):</span>  <span class="c1">#&#39;ProducerGranuleId&#39;</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The constructor for the HLS class.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            bbox_input (geopandas.GeoDataFrame or tuple or Shapely Geometry): GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">            start_date (str): The start date for the data in the format &#39;YYYY-MM-DD&#39;. Default is &#39;2014-01-01&#39;.</span>
<span class="sd">            end_date (str): The end date for the data in the format &#39;YYYY-MM-DD&#39;. Default is today&#39;s date.</span>
<span class="sd">            bands (list): The bands to be used. Default is all bands. Must include SCL for data masking. Each band should be a string like &#39;B01&#39;, &#39;B02&#39;, etc.</span>
<span class="sd">            resolution (str): The resolution of the data. Defaults to native resolution, 10m.</span>
<span class="sd">            crs (str): The coordinate reference system. This should be a string like &#39;EPSG:4326&#39;. Default CRS is UTM zone estimated from bounding box.</span>
<span class="sd">            groupby (str): The groupby parameter for the data. Default is &quot;solar_day&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize the attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span> <span class="o">=</span> <span class="n">bbox_input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_date</span> <span class="o">=</span> <span class="n">start_date</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span> <span class="o">=</span> <span class="n">end_date</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bands</span> <span class="o">=</span> <span class="n">bands</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">resolution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_nodata</span> <span class="o">=</span> <span class="n">remove_nodata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_data</span> <span class="o">=</span> <span class="n">scale_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_metadata</span> <span class="o">=</span> <span class="n">add_metadata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_platform</span> <span class="o">=</span> <span class="n">add_platform</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span> <span class="o">=</span> <span class="n">groupby</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span> <span class="o">=</span> <span class="n">convert_bbox_to_geodataframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">estimate_utm_crs</span><span class="p">()</span>

        <span class="c1"># Define the band information</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span> <span class="o">=</span> <span class="p">{</span> <span class="c1"># https://github.com/stac-extensions/eo#common-band-names</span>
            <span class="s2">&quot;coastal&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B01&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B01&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;430-450 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;blue&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B02&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B02&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;450-510 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;green&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B03&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B03&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;530-590 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;red&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B04&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B04&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;640-670 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;rededge071&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B05&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;690-710 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;rededge075&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B06&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;730-750 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;rededge078&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B07&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;770-790 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;nir&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B08&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;780-880 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;nir08&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B05&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B8A&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;850-880 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;swir16&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B06&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B11&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;1570-1650 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;swir22&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B07&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B12&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;2110-2290 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;water vapor&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B09&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;930-950 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;cirrus&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B09&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B10&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;1360-1380 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;lwir11&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B10&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;10600-11190 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;lwir12&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B11&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;11500-12510 nm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;Fmask&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;Fmask&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;Fmask&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;quality bits&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;uint8&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;255&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;SZA&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;SZA&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;SZA&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Sun zenith degrees&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;uint16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;40000&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.01&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;SAA&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;SAA&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;SAA&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Sun azimuth degrees&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;uint16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;40000&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.01&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;VZA&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;VZA&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;VZA&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;View zenith degrees&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;uint16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;40000&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.01&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;VAA&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;VAA&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;VAA&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;View azimuth degrees&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;uint16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;40000&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.01&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Fmask_mask_info</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cirrus&quot;</span><span class="p">,</span> <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">},</span>
            <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cloud&quot;</span><span class="p">,</span> <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">},</span>
            <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Adjacent to cloud / shadow&quot;</span><span class="p">,</span> <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">},</span>
            <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cloud shadows&quot;</span><span class="p">,</span> <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">},</span>
            <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Snow / ice&quot;</span><span class="p">,</span> <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;4&quot;</span><span class="p">},</span>
            <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Water&quot;</span><span class="p">,</span> <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;5&quot;</span><span class="p">},</span>
            <span class="mi">6</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Aerosol level (00:climatology aersol,01:low aerosol,10:moderate aerosol, 11:high aerosol)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;6-7&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>

        <span class="c1"># Initialize the data attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndvi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndsi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndwi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndbi</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">search_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_nodata</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_nodata_inplace</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale_data_inplace</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_metadata</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_combined_metadata</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_platform</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_platform_inplace</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">search_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to search the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">catalog</span> <span class="o">=</span> <span class="n">pystac_client</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="s2">&quot;https://cmr.earthdata.nasa.gov/stac/LPCLOUD&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Search for items within the specified bbox and date range</span>
        <span class="n">landsat_search</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
            <span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;HLSL30_2.0&quot;</span><span class="p">],</span>
            <span class="n">bbox</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
            <span class="n">datetime</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">sentinel_search</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
            <span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;HLSS30_2.0&quot;</span><span class="p">],</span>
            <span class="n">bbox</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
            <span class="n">datetime</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">search_landsat</span> <span class="o">=</span> <span class="n">landsat_search</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_sentinel</span> <span class="o">=</span> <span class="n">sentinel_search</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Data searched. Access the returned seach with the .search_landsat or .search_sentinel attribute.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to get the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Prepare the parameters for odc.stac.load</span>
        <span class="n">load_params_landsat</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_landsat</span><span class="o">.</span><span class="n">item_collection</span><span class="p">(),</span>
            <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
            <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">},</span>
            <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>  <span class="c1"># maybe put &#39;utm&#39;?</span>
            <span class="s2">&quot;groupby&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="p">,</span>
            <span class="s2">&quot;fail_on_error&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;stac_cfg&quot;</span><span class="p">:</span> <span class="n">get_stac_cfg</span><span class="p">(</span><span class="n">sensor</span><span class="o">=</span><span class="s2">&quot;HLSL30_2.0&quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span><span class="p">:</span>
            <span class="n">load_params_landsat</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">load_params_landsat</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">band</span>
                <span class="k">for</span> <span class="n">band</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;landsat_band&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;-&quot;</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="p">:</span>
            <span class="n">load_params_landsat</span><span class="p">[</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">load_params_landsat</span><span class="p">[</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>

        <span class="n">L30_ds</span> <span class="o">=</span> <span class="n">odc</span><span class="o">.</span><span class="n">stac</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="o">**</span><span class="n">load_params_landsat</span><span class="p">)</span>

        <span class="n">load_params_sentinel</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_sentinel</span><span class="o">.</span><span class="n">item_collection</span><span class="p">(),</span>
            <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
            <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">},</span>
            <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="s2">&quot;groupby&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="p">,</span>
            <span class="s2">&quot;fail_on_error&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;stac_cfg&quot;</span><span class="p">:</span> <span class="n">get_stac_cfg</span><span class="p">(</span><span class="n">sensor</span><span class="o">=</span><span class="s2">&quot;HLSS30_2.0&quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span><span class="p">:</span>
            <span class="n">load_params_sentinel</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">load_params_sentinel</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">band</span>
                <span class="k">for</span> <span class="n">band</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;sentinel_band&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;-&quot;</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="p">:</span>
            <span class="n">load_params_sentinel</span><span class="p">[</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">load_params_sentinel</span><span class="p">[</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>

        <span class="n">S30_ds</span> <span class="o">=</span> <span class="n">odc</span><span class="o">.</span><span class="n">stac</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="o">**</span><span class="n">load_params_sentinel</span><span class="p">)</span>

        <span class="c1"># Load the data lazily using odc.stac</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">L30_ds</span><span class="p">,</span> <span class="n">S30_ds</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=-</span><span class="mi">9999</span><span class="p">)</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span>
            <span class="s2">&quot;time&quot;</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;band_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span>
        <span class="c1"># self.data.attrs[&#39;scl_class_info&#39;] = self.scl_class_info</span>

        <span class="c1"># if &#39;scl&#39; in self.data.variables:</span>
        <span class="c1">#    self.data.scl.attrs[&#39;scl_class_info&#39;] = self.scl_class_info</span>

        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Data retrieved. Access with the .data attribute. Data CRS: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">estimate_utm_crs</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_nodata_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to remove no data values from the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_removed</span><span class="o">=</span><span class="kc">False</span>
        <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
            <span class="n">nodata_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodata&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nodata_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nodata_value</span><span class="p">)</span>
                <span class="n">data_removed</span><span class="o">=</span><span class="kc">True</span>
        <span class="k">if</span> <span class="n">data_removed</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nodata values removed from the data. In doing so, all bands converted to float32. To turn this behavior off, set remove_nodata=False.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tried to remove nodata values and set them to nans, but no nodata values found in the data.&quot;</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">mask_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">remove_cirrus</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">remove_cloud</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">remove_adj_to_cloud</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">remove_cloud_shadows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">remove_snow_ice</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">remove_water</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">remove_aerosol_low</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">remove_aerosol_moderate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">remove_aerosol_high</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">remove_aerosol_climatology</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to mask the data using Fmask.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            remove_cirrus (bool): Whether to remove cirrus pixels.</span>
<span class="sd">            remove_cloud (bool): Whether to remove cloud pixels.</span>
<span class="sd">            remove_adj_to_cloud (bool): Whether to remove pixels adjacent to clouds.</span>
<span class="sd">            remove_cloud_shadows (bool): Whether to remove cloud shadow pixels.</span>
<span class="sd">            remove_snow_ice (bool): Whether to remove snow and ice pixels.</span>
<span class="sd">            remove_water (bool): Whether to remove water pixels.</span>
<span class="sd">            remove_aerosol_low (bool): Whether to remove low aerosol pixels.</span>
<span class="sd">            remove_aerosol_moderate (bool): Whether to remove moderate aerosol pixels.</span>
<span class="sd">            remove_aerosol_high (bool): Whether to remove high aerosol pixels.</span>
<span class="sd">            remove_aerosol_climatology (bool): Whether to remove climatology aerosol pixels.</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get value of QC bit based on location</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">get_qc_bit</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">bit</span><span class="p">):</span>
            <span class="c1"># taken from Helen&#39;s fantastic repo https://github.com/UW-GDA/mekong-water-quality/blob/main/02_pull_hls.ipynb</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">ar</span> <span class="o">//</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">bit</span><span class="p">))</span> <span class="o">-</span> <span class="p">((</span><span class="n">ar</span> <span class="o">//</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">bit</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">()</span>
        <span class="c1"># Mask the data based on the Fmask values</span>
        <span class="n">mask_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">remove_cirrus</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_cloud</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_adj_to_cloud</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_cloud_shadows</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_snow_ice</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_water</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">remove_aerosol_climatology</span>
            <span class="o">|</span> <span class="n">remove_aerosol_low</span>
            <span class="o">|</span> <span class="n">remove_aerosol_moderate</span>
            <span class="o">|</span> <span class="n">remove_aerosol_high</span>
        <span class="p">):</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
            <span class="n">aerosol_mask</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">get_qc_bit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Fmask&quot;</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span>
                <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
                <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">get_qc_bit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Fmask&quot;</span><span class="p">],</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">remove_aerosol_climatology</span><span class="p">:</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mask</span><span class="p">,</span> <span class="n">aerosol_mask</span> <span class="o">==</span> <span class="s2">&quot;00&quot;</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;masks&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">remove_aerosol_low</span><span class="p">:</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mask</span><span class="p">,</span> <span class="n">aerosol_mask</span> <span class="o">==</span> <span class="s2">&quot;01&quot;</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;masks&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">remove_aerosol_moderate</span><span class="p">:</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mask</span><span class="p">,</span> <span class="n">aerosol_mask</span> <span class="o">==</span> <span class="s2">&quot;10&quot;</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;masks&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">remove_aerosol_high</span><span class="p">:</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mask</span><span class="p">,</span> <span class="n">aerosol_mask</span> <span class="o">==</span> <span class="s2">&quot;11&quot;</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;masks&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">mask_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="mi">6</span><span class="p">:</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="n">get_qc_bit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Fmask&quot;</span><span class="p">],</span> <span class="n">val</span><span class="p">)],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;masks&quot;</span>
                <span class="p">)</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;masks&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;WARNING: The cloud masking is pretty bad over snow and ice. Use with caution.&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data masked. Using Fmask, removed pixels classified as:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">mask_list</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fmask_mask_info</span><span class="p">[</span><span class="n">val</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_collection</span><span class="p">):</span>

        <span class="n">HLS_metadata</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_features</span><span class="p">(</span>
            <span class="n">item_collection</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">transform_hrefs</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="s2">&quot;EPSG:4326&quot;</span>
        <span class="p">)</span>
        <span class="n">HLS_metadata</span> <span class="o">=</span> <span class="n">HLS_metadata</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;start_datetime&quot;</span><span class="p">,</span> <span class="s2">&quot;end_datetime&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">HLS_metadata</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">HLS_metadata</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">],</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">series_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">item_collection</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">href</span>
            <span class="n">series</span> <span class="o">=</span> <span class="n">HLS_xml_url_to_metadata_df</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="n">series_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

        <span class="n">extra_attributes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">series_list</span><span class="p">)</span>
        <span class="n">extra_attributes</span><span class="p">[</span><span class="s2">&quot;Temporal&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">extra_attributes</span><span class="p">[</span><span class="s2">&quot;Temporal&quot;</span><span class="p">])</span>
        <span class="n">extra_attributes</span><span class="p">[</span><span class="s2">&quot;Platform&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">extra_attributes</span><span class="p">[</span><span class="s2">&quot;Platform&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>

        <span class="n">metadata_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">merge_asof</span><span class="p">(</span>
                <span class="n">HLS_metadata</span><span class="p">,</span>
                <span class="n">extra_attributes</span><span class="p">,</span>
                <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;datetime&quot;</span><span class="p">,</span>
                <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;Temporal&quot;</span><span class="p">,</span>
                <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">,</span>
                <span class="n">tolerance</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;100ms&quot;</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Temporal&quot;</span><span class="p">)</span>
        <span class="n">metadata_gdf</span> <span class="o">=</span> <span class="n">metadata_gdf</span><span class="p">[</span>
            <span class="p">[</span>
                <span class="s2">&quot;datetime&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ProducerGranuleId&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Platform&quot;</span><span class="p">,</span>
                <span class="s2">&quot;eo:cloud_cover&quot;</span><span class="p">,</span>
                <span class="s2">&quot;AssociatedBrowseImageUrls&quot;</span><span class="p">,</span>
                <span class="s2">&quot;geometry&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="n">metadata_gdf</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_combined_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">L30_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_landsat</span><span class="o">.</span><span class="n">item_collection</span><span class="p">())</span>
        <span class="n">S30_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_sentinel</span><span class="o">.</span><span class="n">item_collection</span><span class="p">())</span>
        <span class="n">combined_metadata_gdf</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">L30_metadata</span><span class="p">,</span> <span class="n">S30_metadata</span><span class="p">])</span>
            <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">combined_metadata_gdf</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Metadata retrieved. Access with the .metadata attribute. To turn this behavior off, set add_metadata=False.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_platform_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">temp_grouped_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
        <span class="n">temp_grouped_metadata</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">temp_grouped_metadata</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">grouped_metadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">grouped_metadata</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_grouped_metadata</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;cluster&quot;</span><span class="p">)[</span>
            <span class="s2">&quot;datetime&quot;</span>
        <span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
        <span class="n">grouped_metadata</span><span class="p">[</span><span class="s2">&quot;Platforms&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_grouped_metadata</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;cluster&quot;</span><span class="p">)[</span>
            <span class="s2">&quot;Platform&quot;</span>
        <span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">)</span>
        <span class="n">grouped_metadata</span><span class="p">[</span><span class="s2">&quot;eo:cloud_cover_avg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">temp_grouped_metadata</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;cluster&quot;</span><span class="p">)[</span><span class="s2">&quot;eo:cloud_cover&quot;</span><span class="p">]</span>
            <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">grouped_metadata</span><span class="p">[</span><span class="s2">&quot;BrowseUrls&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;cluster&quot;</span><span class="p">)[</span>
            <span class="s2">&quot;AssociatedBrowseImageUrls&quot;</span>
        <span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="n">grouped_metadata</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">temp_grouped_metadata</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;cluster&quot;</span><span class="p">)[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span>
            <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
            <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">MultiPolygon</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">grouped_metadata_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">grouped_metadata</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="s2">&quot;datetime&quot;</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;platform&quot;</span><span class="p">:</span> <span class="p">(</span>
                    <span class="s2">&quot;time&quot;</span><span class="p">,</span>
                    <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">grouped_metadata_gdf</span><span class="p">[</span><span class="s2">&quot;Platforms&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;eo:cloud_cover_avg&quot;</span><span class="p">:</span> <span class="p">(</span>
                    <span class="s2">&quot;time&quot;</span><span class="p">,</span>
                    <span class="n">grouped_metadata_gdf</span><span class="p">[</span><span class="s2">&quot;eo:cloud_cover_avg&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;AssociatedBrowseImageUrls&quot;</span><span class="p">:</span> <span class="p">(</span>
                    <span class="s2">&quot;time&quot;</span><span class="p">,</span>
                    <span class="n">grouped_metadata_gdf</span><span class="p">[</span><span class="s2">&quot;BrowseUrls&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">grouped_metadata_gdf</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)}</span>
        <span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Platform, geometry, cloud cover, browse URLs added to data as coordinates. Access with the .data attribute. To turn this behavior off, set add_platform=False.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">scale_data_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to scale the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Define a function to scale a data variable</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">scale_var</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">band</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span>
            <span class="k">if</span> <span class="n">band</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">band_info</span><span class="p">:</span>
                <span class="n">scale_factor_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">band_info</span><span class="p">[</span><span class="n">band</span><span class="p">]</span>
                <span class="c1"># Extract the actual scale factor from the dictionary and convert it to a float</span>
                <span class="n">scale_factor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale_factor_dict</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">scale_factor</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span>

        <span class="c1"># Apply the function to each data variable in the Dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">scale_var</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Data scaled to reflectance. Access with the .data attribute. To turn this behavior off, set scale_data=False.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># def get_rgb(self):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     The method to get the RGB data.</span>

    <span class="c1">#     Returns:</span>
    <span class="c1">#         xarray.DataArray: The RGB data.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     # Convert the red, green, and blue bands to an RGB DataArray</span>
    <span class="c1">#     rgb_da = self.data[[&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;]].to_dataarray(dim=&quot;band&quot;)</span>
    <span class="c1">#     self.rgb = rgb_da</span>

    <span class="c1">#     print(f&quot;RGB data retrieved. Access with the .rgb attribute.&quot;)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">get_rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percentile_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lower&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span> <span class="mi">98</span><span class="p">},</span> <span class="n">clahe_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;clip_limit&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;nbins&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span> <span class="s1">&#39;kernel_size&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve RGB data with optional percentile-based contrast stretching and CLAHE enhancement.</span>

<span class="sd">        This method calculates and stores three versions of RGB data: raw, percentile-stretched, and CLAHE-enhanced.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        percentile_kwargs : dict, optional</span>
<span class="sd">            Parameters for percentile-based contrast stretching. Keys are:</span>
<span class="sd">            - &#39;lower&#39;: Lower percentile for contrast stretching (default: 2)</span>
<span class="sd">            - &#39;upper&#39;: Upper percentile for contrast stretching (default: 98)</span>
<span class="sd">        clahe_kwargs : dict, optional</span>
<span class="sd">            Parameters for CLAHE enhancement. Keys are:</span>
<span class="sd">            - &#39;clip_limit&#39;: Clipping limit for CLAHE (default: 0.03)</span>
<span class="sd">            - &#39;nbins&#39;: Number of bins for CLAHE histogram (default: 256)</span>
<span class="sd">            - &#39;kernel_size&#39;: Size of kernel for CLAHE (default: None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            The method stores results in instance attributes.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Results are stored in the following attributes:</span>
<span class="sd">        - .rgb: Raw RGB data</span>
<span class="sd">        - .rgb_percentile: Percentile-stretched RGB data</span>
<span class="sd">        - .rgb_clahe: CLAHE-enhanced RGB data</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rgba_da</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">odc</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">bands</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">),</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.35</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rgba</span> <span class="o">=</span> <span class="n">rgba_da</span>

        <span class="n">rgb_da</span> <span class="o">=</span> <span class="n">rgba_da</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">band</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="c1"># .where(self.data.scl&gt;=0, other=255) if we want to make no data white</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">rgb_da</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rgb_percentile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rgb_percentile</span><span class="p">(</span><span class="o">**</span><span class="n">percentile_kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rgb_clahe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rgb_clahe</span><span class="p">(</span><span class="o">**</span><span class="n">clahe_kwargs</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RGB data retrieved.</span><span class="se">\n</span><span class="s2">Access with the following attributes:</span><span class="se">\n</span><span class="s2">.rgb for raw RGB,</span><span class="se">\n</span><span class="s2">.rgba for RGBA,</span><span class="se">\n</span><span class="s2">.rgb_percentile for percentile RGB,</span><span class="se">\n</span><span class="s2">.rgb_clahe for CLAHE RGB.</span><span class="se">\n</span><span class="s2">You can pass in percentile_kwargs and clahe_kwargs to adjust RGB calculations, check documentation for options.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_rgb_percentile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">percentile_kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply percentile-based contrast stretching to the RGB bands of the Sentinel-2 data.</span>

<span class="sd">        This function creates a new DataArray with the contrast-stretched RGB bands.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments for percentile calculation. Supported keys:</span>
<span class="sd">            - &#39;lower&#39;: Lower percentile for contrast stretching (default: 2)</span>
<span class="sd">            - &#39;upper&#39;: Upper percentile for contrast stretching (default: 98)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        xarray.DataArray</span>
<span class="sd">            RGB data with percentile-based contrast stretching applied.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The function clips values to the range [0, 1] and masks areas where SCL &lt; 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lower_percentile</span> <span class="o">=</span> <span class="n">percentile_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">upper_percentile</span> <span class="o">=</span> <span class="n">percentile_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="mi">98</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">stretch_percentile</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
            <span class="n">p_low</span><span class="p">,</span> <span class="n">p_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="p">[</span><span class="n">lower_percentile</span><span class="p">,</span> <span class="n">upper_percentile</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">da</span> <span class="o">-</span> <span class="n">p_low</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p_high</span> <span class="o">-</span> <span class="n">p_low</span><span class="p">)</span>

        <span class="n">rgb_da</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rgba</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">band</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">255</span><span class="p">)</span>

        <span class="n">template</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">rgb_da</span><span class="p">)</span>
        <span class="n">rgb_percentile_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">map_blocks</span><span class="p">(</span><span class="n">stretch_percentile</span><span class="p">,</span> <span class="n">rgb_da</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">)</span>
        <span class="n">rgb_percentile_da</span> <span class="o">=</span> <span class="n">rgb_percentile_da</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="c1">#.where(self.data.scl&gt;=0)</span>

        <span class="k">return</span> <span class="n">rgb_percentile_da</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_rgb_clahe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply Contrast Limited Adaptive Histogram Equalization (CLAHE) to RGB bands.</span>

<span class="sd">        This function creates a new DataArray with CLAHE applied to the RGB bands.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments for CLAHE. Supported keys:</span>
<span class="sd">            - &#39;clip_limit&#39;: Clipping limit for CLAHE (default: 0.03)</span>
<span class="sd">            - &#39;nbins&#39;: Number of bins for CLAHE histogram (default: 256)</span>
<span class="sd">            - &#39;kernel_size&#39;: Size of kernel for CLAHE (default: None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        xarray.DataArray</span>
<span class="sd">            RGB data with CLAHE enhancement applied.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The function applies CLAHE to each band separately and masks areas where SCL &lt; 0.</span>
<span class="sd">        https://scikit-image.org/docs/stable/api/skimage.exposure.html#skimage.exposure.equalize_adapthist</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Custom wrapper to preserve xarray metadata</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">equalize_adapthist_da</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="c1"># Apply the CLAHE function from skimage</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">exposure</span><span class="o">.</span><span class="n">equalize_adapthist</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1">#new_coords = {k: v for k, v in da.coords.items() if k != &#39;band&#39; or len(v) == 3}</span>

            <span class="c1"># Convert the result back to a DataArray, preserving the original metadata</span>
            <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>

        <span class="n">rgb_da</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span>

        <span class="c1">#template = rgb_da.copy(data=np.empty_like(rgb_da).data)</span>
        <span class="n">template</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">rgb_da</span><span class="p">)</span>
        <span class="n">rgb_clahe_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">map_blocks</span><span class="p">(</span><span class="n">equalize_adapthist_da</span><span class="p">,</span> <span class="n">rgb_da</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">rgb_clahe_da</span> <span class="o">=</span> <span class="n">rgb_clahe_da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rgba</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">band</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">255</span><span class="p">)</span><span class="c1">#.where(self.data.scl&gt;=0)</span>

        <span class="k">return</span> <span class="n">rgb_clahe_da</span>

    <span class="c1"># Indicies</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ndvi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to get the NDVI data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ndvi_da (xarray.DataArray): The NDVI data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">red</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">red</span>
        <span class="n">nir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">nir</span>
        <span class="n">ndvi_da</span> <span class="o">=</span> <span class="p">(</span><span class="n">nir</span> <span class="o">-</span> <span class="n">red</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nir</span> <span class="o">+</span> <span class="n">red</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ndvi</span> <span class="o">=</span> <span class="n">ndvi_da</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NDVI data calculated. Access with the .ndvi attribute.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.HLS.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bbox_input</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2014-01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2025-03-03&#39;</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;utm&#39;</span><span class="p">,</span> <span class="n">remove_nodata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_platform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s1">&#39;solar_day&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#easysnowdata.remote_sensing.HLS.__init__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The constructor for the HLS class.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox_input</code></td>
        <td><code>geopandas.GeoDataFrame or tuple or Shapely Geometry</code></td>
        <td><p>GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date for the data in the format 'YYYY-MM-DD'. Default is '2014-01-01'.</p></td>
        <td><code>&#39;2014-01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date for the data in the format 'YYYY-MM-DD'. Default is today's date.</p></td>
        <td><code>&#39;2025-03-03&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>The bands to be used. Default is all bands. Must include SCL for data masking. Each band should be a string like 'B01', 'B02', etc.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>resolution</code></td>
        <td><code>str</code></td>
        <td><p>The resolution of the data. Defaults to native resolution, 10m.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system. This should be a string like 'EPSG:4326'. Default CRS is UTM zone estimated from bounding box.</p></td>
        <td><code>&#39;utm&#39;</code></td>
      </tr>
      <tr>
        <td><code>groupby</code></td>
        <td><code>str</code></td>
        <td><p>The groupby parameter for the data. Default is "solar_day".</p></td>
        <td><code>&#39;solar_day&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">bbox_input</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2014-01-01&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">),</span>
    <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;utm&quot;</span><span class="p">,</span>
    <span class="n">remove_nodata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">scale_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">add_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">add_platform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">groupby</span><span class="o">=</span><span class="s2">&quot;solar_day&quot;</span><span class="p">,</span>
<span class="p">):</span>  <span class="c1">#&#39;ProducerGranuleId&#39;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The constructor for the HLS class.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        bbox_input (geopandas.GeoDataFrame or tuple or Shapely Geometry): GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">        start_date (str): The start date for the data in the format &#39;YYYY-MM-DD&#39;. Default is &#39;2014-01-01&#39;.</span>
<span class="sd">        end_date (str): The end date for the data in the format &#39;YYYY-MM-DD&#39;. Default is today&#39;s date.</span>
<span class="sd">        bands (list): The bands to be used. Default is all bands. Must include SCL for data masking. Each band should be a string like &#39;B01&#39;, &#39;B02&#39;, etc.</span>
<span class="sd">        resolution (str): The resolution of the data. Defaults to native resolution, 10m.</span>
<span class="sd">        crs (str): The coordinate reference system. This should be a string like &#39;EPSG:4326&#39;. Default CRS is UTM zone estimated from bounding box.</span>
<span class="sd">        groupby (str): The groupby parameter for the data. Default is &quot;solar_day&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize the attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span> <span class="o">=</span> <span class="n">bbox_input</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_date</span> <span class="o">=</span> <span class="n">start_date</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span> <span class="o">=</span> <span class="n">end_date</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bands</span> <span class="o">=</span> <span class="n">bands</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">resolution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">remove_nodata</span> <span class="o">=</span> <span class="n">remove_nodata</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scale_data</span> <span class="o">=</span> <span class="n">scale_data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_metadata</span> <span class="o">=</span> <span class="n">add_metadata</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_platform</span> <span class="o">=</span> <span class="n">add_platform</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span> <span class="o">=</span> <span class="n">groupby</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span> <span class="o">=</span> <span class="n">convert_bbox_to_geodataframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">estimate_utm_crs</span><span class="p">()</span>

    <span class="c1"># Define the band information</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span> <span class="o">=</span> <span class="p">{</span> <span class="c1"># https://github.com/stac-extensions/eo#common-band-names</span>
        <span class="s2">&quot;coastal&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;430-450 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;blue&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B02&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B02&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;450-510 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;green&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B03&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B03&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;530-590 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;red&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B04&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B04&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;640-670 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;rededge071&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B05&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;690-710 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;rededge075&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B06&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;730-750 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;rededge078&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B07&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;770-790 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;nir&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B08&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;780-880 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;nir08&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B05&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B8A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;850-880 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;swir16&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B06&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B11&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;1570-1650 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;swir22&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B07&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B12&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;2110-2290 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;water vapor&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B09&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;930-950 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;cirrus&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B09&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B10&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;1360-1380 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;lwir11&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B10&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;10600-11190 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;lwir12&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;B11&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;11500-12510 nm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;int16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;-9999&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;Fmask&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;Fmask&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;Fmask&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;quality bits&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;uint8&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;255&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;SZA&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;SZA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;SZA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Sun zenith degrees&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;uint16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;40000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.01&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;SAA&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;SAA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;SAA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Sun azimuth degrees&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;uint16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;40000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.01&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;VZA&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;VZA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;VZA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;View zenith degrees&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;uint16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;40000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.01&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;VAA&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;landsat_band&quot;</span><span class="p">:</span> <span class="s2">&quot;VAA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sentinel_band&quot;</span><span class="p">:</span> <span class="s2">&quot;VAA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;View azimuth degrees&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;uint16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="s2">&quot;40000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.01&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">Fmask_mask_info</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cirrus&quot;</span><span class="p">,</span> <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">},</span>
        <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cloud&quot;</span><span class="p">,</span> <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">},</span>
        <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Adjacent to cloud / shadow&quot;</span><span class="p">,</span> <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">},</span>
        <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cloud shadows&quot;</span><span class="p">,</span> <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">},</span>
        <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Snow / ice&quot;</span><span class="p">,</span> <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;4&quot;</span><span class="p">},</span>
        <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Water&quot;</span><span class="p">,</span> <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;5&quot;</span><span class="p">},</span>
        <span class="mi">6</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Aerosol level (00:climatology aersol,01:low aerosol,10:moderate aerosol, 11:high aerosol)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bit number&quot;</span><span class="p">:</span> <span class="s2">&quot;6-7&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>

    <span class="c1"># Initialize the data attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ndvi</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ndsi</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ndwi</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">evi</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ndbi</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">search_data</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_nodata</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_nodata_inplace</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_data</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_data_inplace</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_metadata</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_combined_metadata</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_platform</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_platform_inplace</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.HLS.get_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.HLS.get_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to get the data.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to get the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Prepare the parameters for odc.stac.load</span>
    <span class="n">load_params_landsat</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_landsat</span><span class="o">.</span><span class="n">item_collection</span><span class="p">(),</span>
        <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
        <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">},</span>
        <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>  <span class="c1"># maybe put &#39;utm&#39;?</span>
        <span class="s2">&quot;groupby&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="p">,</span>
        <span class="s2">&quot;fail_on_error&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;stac_cfg&quot;</span><span class="p">:</span> <span class="n">get_stac_cfg</span><span class="p">(</span><span class="n">sensor</span><span class="o">=</span><span class="s2">&quot;HLSL30_2.0&quot;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span><span class="p">:</span>
        <span class="n">load_params_landsat</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">load_params_landsat</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">band</span>
            <span class="k">for</span> <span class="n">band</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;landsat_band&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;-&quot;</span>
        <span class="p">]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="p">:</span>
        <span class="n">load_params_landsat</span><span class="p">[</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">load_params_landsat</span><span class="p">[</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>

    <span class="n">L30_ds</span> <span class="o">=</span> <span class="n">odc</span><span class="o">.</span><span class="n">stac</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="o">**</span><span class="n">load_params_landsat</span><span class="p">)</span>

    <span class="n">load_params_sentinel</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_sentinel</span><span class="o">.</span><span class="n">item_collection</span><span class="p">(),</span>
        <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
        <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">},</span>
        <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="s2">&quot;groupby&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="p">,</span>
        <span class="s2">&quot;fail_on_error&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;stac_cfg&quot;</span><span class="p">:</span> <span class="n">get_stac_cfg</span><span class="p">(</span><span class="n">sensor</span><span class="o">=</span><span class="s2">&quot;HLSS30_2.0&quot;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span><span class="p">:</span>
        <span class="n">load_params_sentinel</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">load_params_sentinel</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">band</span>
            <span class="k">for</span> <span class="n">band</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;sentinel_band&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;-&quot;</span>
        <span class="p">]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="p">:</span>
        <span class="n">load_params_sentinel</span><span class="p">[</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">load_params_sentinel</span><span class="p">[</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>

    <span class="n">S30_ds</span> <span class="o">=</span> <span class="n">odc</span><span class="o">.</span><span class="n">stac</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="o">**</span><span class="n">load_params_sentinel</span><span class="p">)</span>

    <span class="c1"># Load the data lazily using odc.stac</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">L30_ds</span><span class="p">,</span> <span class="n">S30_ds</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=-</span><span class="mi">9999</span><span class="p">)</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span>
        <span class="s2">&quot;time&quot;</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;band_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span>
    <span class="c1"># self.data.attrs[&#39;scl_class_info&#39;] = self.scl_class_info</span>

    <span class="c1"># if &#39;scl&#39; in self.data.variables:</span>
    <span class="c1">#    self.data.scl.attrs[&#39;scl_class_info&#39;] = self.scl_class_info</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Data retrieved. Access with the .data attribute. Data CRS: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">estimate_utm_crs</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.HLS.get_ndvi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_ndvi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.HLS.get_ndvi" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to get the NDVI data.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>ndvi_da (xarray.DataArray): The NDVI data.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_ndvi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to get the NDVI data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ndvi_da (xarray.DataArray): The NDVI data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">red</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">red</span>
    <span class="n">nir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">nir</span>
    <span class="n">ndvi_da</span> <span class="o">=</span> <span class="p">(</span><span class="n">nir</span> <span class="o">-</span> <span class="n">red</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nir</span> <span class="o">+</span> <span class="n">red</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ndvi</span> <span class="o">=</span> <span class="n">ndvi_da</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NDVI data calculated. Access with the .ndvi attribute.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.HLS.get_rgb" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percentile_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lower&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span> <span class="mi">98</span><span class="p">},</span> <span class="n">clahe_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;clip_limit&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;nbins&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span> <span class="s1">&#39;kernel_size&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span></code>


<a href="#easysnowdata.remote_sensing.HLS.get_rgb" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Retrieve RGB data with optional percentile-based contrast stretching and CLAHE enhancement.</p>
<p>This method calculates and stores three versions of RGB data: raw, percentile-stretched, and CLAHE-enhanced.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>percentile_kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Parameters for percentile-based contrast stretching. Keys are:
- 'lower': Lower percentile for contrast stretching (default: 2)
- 'upper': Upper percentile for contrast stretching (default: 98)</p></td>
        <td><code>{&#39;lower&#39;: 2, &#39;upper&#39;: 98}</code></td>
      </tr>
      <tr>
        <td><code>clahe_kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Parameters for CLAHE enhancement. Keys are:
- 'clip_limit': Clipping limit for CLAHE (default: 0.03)
- 'nbins': Number of bins for CLAHE histogram (default: 256)
- 'kernel_size': Size of kernel for CLAHE (default: None)</p></td>
        <td><code>{&#39;clip_limit&#39;: 0.03, &#39;nbins&#39;: 256, &#39;kernel_size&#39;: None}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>None</code></td>
      <td><p>The method stores results in instance attributes.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percentile_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lower&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span> <span class="mi">98</span><span class="p">},</span> <span class="n">clahe_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;clip_limit&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;nbins&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span> <span class="s1">&#39;kernel_size&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve RGB data with optional percentile-based contrast stretching and CLAHE enhancement.</span>

<span class="sd">    This method calculates and stores three versions of RGB data: raw, percentile-stretched, and CLAHE-enhanced.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    percentile_kwargs : dict, optional</span>
<span class="sd">        Parameters for percentile-based contrast stretching. Keys are:</span>
<span class="sd">        - &#39;lower&#39;: Lower percentile for contrast stretching (default: 2)</span>
<span class="sd">        - &#39;upper&#39;: Upper percentile for contrast stretching (default: 98)</span>
<span class="sd">    clahe_kwargs : dict, optional</span>
<span class="sd">        Parameters for CLAHE enhancement. Keys are:</span>
<span class="sd">        - &#39;clip_limit&#39;: Clipping limit for CLAHE (default: 0.03)</span>
<span class="sd">        - &#39;nbins&#39;: Number of bins for CLAHE histogram (default: 256)</span>
<span class="sd">        - &#39;kernel_size&#39;: Size of kernel for CLAHE (default: None)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">        The method stores results in instance attributes.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Results are stored in the following attributes:</span>
<span class="sd">    - .rgb: Raw RGB data</span>
<span class="sd">    - .rgb_percentile: Percentile-stretched RGB data</span>
<span class="sd">    - .rgb_clahe: CLAHE-enhanced RGB data</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rgba_da</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">odc</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">bands</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">),</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.35</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rgba</span> <span class="o">=</span> <span class="n">rgba_da</span>

    <span class="n">rgb_da</span> <span class="o">=</span> <span class="n">rgba_da</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">band</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="c1"># .where(self.data.scl&gt;=0, other=255) if we want to make no data white</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">rgb_da</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">rgb_percentile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rgb_percentile</span><span class="p">(</span><span class="o">**</span><span class="n">percentile_kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rgb_clahe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rgb_clahe</span><span class="p">(</span><span class="o">**</span><span class="n">clahe_kwargs</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RGB data retrieved.</span><span class="se">\n</span><span class="s2">Access with the following attributes:</span><span class="se">\n</span><span class="s2">.rgb for raw RGB,</span><span class="se">\n</span><span class="s2">.rgba for RGBA,</span><span class="se">\n</span><span class="s2">.rgb_percentile for percentile RGB,</span><span class="se">\n</span><span class="s2">.rgb_clahe for CLAHE RGB.</span><span class="se">\n</span><span class="s2">You can pass in percentile_kwargs and clahe_kwargs to adjust RGB calculations, check documentation for options.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.HLS.get_rgb_clahe" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_rgb_clahe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.HLS.get_rgb_clahe" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Apply Contrast Limited Adaptive Histogram Equalization (CLAHE) to RGB bands.</p>
<p>This function creates a new DataArray with CLAHE applied to the RGB bands.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword arguments for CLAHE. Supported keys:
- 'clip_limit': Clipping limit for CLAHE (default: 0.03)
- 'nbins': Number of bins for CLAHE histogram (default: 256)
- 'kernel_size': Size of kernel for CLAHE (default: None)</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>xarray.DataArray</code></td>
      <td><p>RGB data with CLAHE enhancement applied.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_rgb_clahe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply Contrast Limited Adaptive Histogram Equalization (CLAHE) to RGB bands.</span>

<span class="sd">    This function creates a new DataArray with CLAHE applied to the RGB bands.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Keyword arguments for CLAHE. Supported keys:</span>
<span class="sd">        - &#39;clip_limit&#39;: Clipping limit for CLAHE (default: 0.03)</span>
<span class="sd">        - &#39;nbins&#39;: Number of bins for CLAHE histogram (default: 256)</span>
<span class="sd">        - &#39;kernel_size&#39;: Size of kernel for CLAHE (default: None)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xarray.DataArray</span>
<span class="sd">        RGB data with CLAHE enhancement applied.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The function applies CLAHE to each band separately and masks areas where SCL &lt; 0.</span>
<span class="sd">    https://scikit-image.org/docs/stable/api/skimage.exposure.html#skimage.exposure.equalize_adapthist</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Custom wrapper to preserve xarray metadata</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">equalize_adapthist_da</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Apply the CLAHE function from skimage</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">exposure</span><span class="o">.</span><span class="n">equalize_adapthist</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1">#new_coords = {k: v for k, v in da.coords.items() if k != &#39;band&#39; or len(v) == 3}</span>

        <span class="c1"># Convert the result back to a DataArray, preserving the original metadata</span>
        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>

    <span class="n">rgb_da</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span>

    <span class="c1">#template = rgb_da.copy(data=np.empty_like(rgb_da).data)</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">rgb_da</span><span class="p">)</span>
    <span class="n">rgb_clahe_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">map_blocks</span><span class="p">(</span><span class="n">equalize_adapthist_da</span><span class="p">,</span> <span class="n">rgb_da</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">rgb_clahe_da</span> <span class="o">=</span> <span class="n">rgb_clahe_da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rgba</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">band</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">255</span><span class="p">)</span><span class="c1">#.where(self.data.scl&gt;=0)</span>

    <span class="k">return</span> <span class="n">rgb_clahe_da</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.HLS.get_rgb_percentile" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_rgb_percentile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">percentile_kwargs</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.HLS.get_rgb_percentile" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Apply percentile-based contrast stretching to the RGB bands of the Sentinel-2 data.</p>
<p>This function creates a new DataArray with the contrast-stretched RGB bands.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword arguments for percentile calculation. Supported keys:
- 'lower': Lower percentile for contrast stretching (default: 2)
- 'upper': Upper percentile for contrast stretching (default: 98)</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>xarray.DataArray</code></td>
      <td><p>RGB data with percentile-based contrast stretching applied.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_rgb_percentile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">percentile_kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply percentile-based contrast stretching to the RGB bands of the Sentinel-2 data.</span>

<span class="sd">    This function creates a new DataArray with the contrast-stretched RGB bands.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Keyword arguments for percentile calculation. Supported keys:</span>
<span class="sd">        - &#39;lower&#39;: Lower percentile for contrast stretching (default: 2)</span>
<span class="sd">        - &#39;upper&#39;: Upper percentile for contrast stretching (default: 98)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xarray.DataArray</span>
<span class="sd">        RGB data with percentile-based contrast stretching applied.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The function clips values to the range [0, 1] and masks areas where SCL &lt; 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lower_percentile</span> <span class="o">=</span> <span class="n">percentile_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">upper_percentile</span> <span class="o">=</span> <span class="n">percentile_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="mi">98</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stretch_percentile</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
        <span class="n">p_low</span><span class="p">,</span> <span class="n">p_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="p">[</span><span class="n">lower_percentile</span><span class="p">,</span> <span class="n">upper_percentile</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">da</span> <span class="o">-</span> <span class="n">p_low</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p_high</span> <span class="o">-</span> <span class="n">p_low</span><span class="p">)</span>

    <span class="n">rgb_da</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rgba</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">band</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">255</span><span class="p">)</span>

    <span class="n">template</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">rgb_da</span><span class="p">)</span>
    <span class="n">rgb_percentile_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">map_blocks</span><span class="p">(</span><span class="n">stretch_percentile</span><span class="p">,</span> <span class="n">rgb_da</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">)</span>
    <span class="n">rgb_percentile_da</span> <span class="o">=</span> <span class="n">rgb_percentile_da</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="c1">#.where(self.data.scl&gt;=0)</span>

    <span class="k">return</span> <span class="n">rgb_percentile_da</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.HLS.mask_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mask_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remove_cirrus</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_cloud</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_adj_to_cloud</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_cloud_shadows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_snow_ice</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_water</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_aerosol_low</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_aerosol_moderate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_aerosol_high</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_aerosol_climatology</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.HLS.mask_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to mask the data using Fmask.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>remove_cirrus</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove cirrus pixels.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>remove_cloud</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove cloud pixels.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>remove_adj_to_cloud</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove pixels adjacent to clouds.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>remove_cloud_shadows</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove cloud shadow pixels.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>remove_snow_ice</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove snow and ice pixels.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>remove_water</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove water pixels.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>remove_aerosol_low</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove low aerosol pixels.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>remove_aerosol_moderate</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove moderate aerosol pixels.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>remove_aerosol_high</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove high aerosol pixels.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>remove_aerosol_climatology</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove climatology aerosol pixels.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mask_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">remove_cirrus</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_cloud</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_adj_to_cloud</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_cloud_shadows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_snow_ice</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">remove_water</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">remove_aerosol_low</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">remove_aerosol_moderate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">remove_aerosol_high</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">remove_aerosol_climatology</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to mask the data using Fmask.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        remove_cirrus (bool): Whether to remove cirrus pixels.</span>
<span class="sd">        remove_cloud (bool): Whether to remove cloud pixels.</span>
<span class="sd">        remove_adj_to_cloud (bool): Whether to remove pixels adjacent to clouds.</span>
<span class="sd">        remove_cloud_shadows (bool): Whether to remove cloud shadow pixels.</span>
<span class="sd">        remove_snow_ice (bool): Whether to remove snow and ice pixels.</span>
<span class="sd">        remove_water (bool): Whether to remove water pixels.</span>
<span class="sd">        remove_aerosol_low (bool): Whether to remove low aerosol pixels.</span>
<span class="sd">        remove_aerosol_moderate (bool): Whether to remove moderate aerosol pixels.</span>
<span class="sd">        remove_aerosol_high (bool): Whether to remove high aerosol pixels.</span>
<span class="sd">        remove_aerosol_climatology (bool): Whether to remove climatology aerosol pixels.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get value of QC bit based on location</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_qc_bit</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">bit</span><span class="p">):</span>
        <span class="c1"># taken from Helen&#39;s fantastic repo https://github.com/UW-GDA/mekong-water-quality/blob/main/02_pull_hls.ipynb</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ar</span> <span class="o">//</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">bit</span><span class="p">))</span> <span class="o">-</span> <span class="p">((</span><span class="n">ar</span> <span class="o">//</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">bit</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">()</span>
    <span class="c1"># Mask the data based on the Fmask values</span>
    <span class="n">mask_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">remove_cirrus</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_cloud</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_adj_to_cloud</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_cloud_shadows</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_snow_ice</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_water</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">remove_aerosol_climatology</span>
        <span class="o">|</span> <span class="n">remove_aerosol_low</span>
        <span class="o">|</span> <span class="n">remove_aerosol_moderate</span>
        <span class="o">|</span> <span class="n">remove_aerosol_high</span>
    <span class="p">):</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">aerosol_mask</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">get_qc_bit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Fmask&quot;</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span>
            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">get_qc_bit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Fmask&quot;</span><span class="p">],</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_aerosol_climatology</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mask</span><span class="p">,</span> <span class="n">aerosol_mask</span> <span class="o">==</span> <span class="s2">&quot;00&quot;</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;masks&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_aerosol_low</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mask</span><span class="p">,</span> <span class="n">aerosol_mask</span> <span class="o">==</span> <span class="s2">&quot;01&quot;</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;masks&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_aerosol_moderate</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mask</span><span class="p">,</span> <span class="n">aerosol_mask</span> <span class="o">==</span> <span class="s2">&quot;10&quot;</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;masks&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_aerosol_high</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mask</span><span class="p">,</span> <span class="n">aerosol_mask</span> <span class="o">==</span> <span class="s2">&quot;11&quot;</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;masks&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">mask_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                <span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="n">get_qc_bit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Fmask&quot;</span><span class="p">],</span> <span class="n">val</span><span class="p">)],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;masks&quot;</span>
            <span class="p">)</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;masks&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;WARNING: The cloud masking is pretty bad over snow and ice. Use with caution.&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data masked. Using Fmask, removed pixels classified as:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">mask_list</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fmask_mask_info</span><span class="p">[</span><span class="n">val</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.HLS.remove_nodata_inplace" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_nodata_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.HLS.remove_nodata_inplace" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to remove no data values from the data.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_nodata_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to remove no data values from the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_removed</span><span class="o">=</span><span class="kc">False</span>
    <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
        <span class="n">nodata_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodata&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nodata_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nodata_value</span><span class="p">)</span>
            <span class="n">data_removed</span><span class="o">=</span><span class="kc">True</span>
    <span class="k">if</span> <span class="n">data_removed</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nodata values removed from the data. In doing so, all bands converted to float32. To turn this behavior off, set remove_nodata=False.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tried to remove nodata values and set them to nans, but no nodata values found in the data.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.HLS.scale_data_inplace" class="doc doc-heading">
<code class="highlight language-python"><span class="n">scale_data_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.HLS.scale_data_inplace" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to scale the data.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scale_data_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to scale the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Define a function to scale a data variable</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">scale_var</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">band</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="n">band</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">band_info</span><span class="p">:</span>
            <span class="n">scale_factor_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">band_info</span><span class="p">[</span><span class="n">band</span><span class="p">]</span>
            <span class="c1"># Extract the actual scale factor from the dictionary and convert it to a float</span>
            <span class="n">scale_factor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale_factor_dict</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">scale_factor</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>

    <span class="c1"># Apply the function to each data variable in the Dataset</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">scale_var</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Data scaled to reflectance. Access with the .data attribute. To turn this behavior off, set scale_data=False.&quot;</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.HLS.search_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">search_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.HLS.search_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to search the data.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">search_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to search the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">catalog</span> <span class="o">=</span> <span class="n">pystac_client</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
        <span class="s2">&quot;https://cmr.earthdata.nasa.gov/stac/LPCLOUD&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Search for items within the specified bbox and date range</span>
    <span class="n">landsat_search</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
        <span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;HLSL30_2.0&quot;</span><span class="p">],</span>
        <span class="n">bbox</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
        <span class="n">datetime</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">sentinel_search</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
        <span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;HLSS30_2.0&quot;</span><span class="p">],</span>
        <span class="n">bbox</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
        <span class="n">datetime</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">search_landsat</span> <span class="o">=</span> <span class="n">landsat_search</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">search_sentinel</span> <span class="o">=</span> <span class="n">sentinel_search</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Data searched. Access the returned seach with the .search_landsat or .search_sentinel attribute.&quot;</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="easysnowdata.remote_sensing.MODIS_snow" class="doc doc-heading">
        <code>
MODIS_snow        </code>



<a href="#easysnowdata.remote_sensing.MODIS_snow" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>A class to handle MODIS snow data.</p>
<p>This class provides functionality to search, retrieve, and process MODIS snow cover data.
It supports various MODIS snow products and allows for spatial and temporal subsetting.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox_input</code></td>
        <td><code>geopandas.GeoDataFrame or tuple or Shapely Geometry</code></td>
        <td><p>GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>clip_to_bbox</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to clip the data to the bounding box. Default is True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date for the data in the format 'YYYY-MM-DD'. Default is '2000-01-01'.</p></td>
        <td><code>&#39;2000-01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date for the data in the format 'YYYY-MM-DD'. Default is today's date.</p></td>
        <td><code>&#39;2025-03-03&#39;</code></td>
      </tr>
      <tr>
        <td><code>data_product</code></td>
        <td><code>str</code></td>
        <td><p>The MODIS data product to retrieve. Can choose between 'MOD10A1F', 'MOD10A1', or 'MOD10A2'. Default is 'MOD10A2'.</p></td>
        <td><code>&#39;MOD10A2&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>The bands to be used. Default is all bands.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>resolution</code></td>
        <td><code>str</code></td>
        <td><p>The resolution of the data. Defaults to native resolution.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system. Default is None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vertical_tile</code></td>
        <td><code>int</code></td>
        <td><p>The vertical tile number for MODIS data. Default is None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>horizontal_tile</code></td>
        <td><code>int</code></td>
        <td><p>The horizontal tile number for MODIS data. Default is None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>mute</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to mute print outputs. Default is False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>xarray.Dataset</code></td>
        <td><p>The loaded MODIS snow data.</p></td>
      </tr>
      <tr>
        <td><code>binary_snow</code></td>
        <td><code>xarray.DataArray</code></td>
        <td><p>Binary snow cover map derived from the data (only for MOD10A2 product).</p></td>
      </tr>
      <tr>
        <td><code>Methods</code></td>
        <td><code>None</code></td>
        <td></td>
      </tr>
      <tr>
        <td><code>-------</code></td>
        <td><code>None</code></td>
        <td></td>
      </tr>
      <tr>
        <td><code>search_data()</code></td>
        <td><code>None</code></td>
        <td><p>Searches for MODIS snow data based on the specified parameters.</p></td>
      </tr>
      <tr>
        <td><code>get_data()</code></td>
        <td><code>None</code></td>
        <td><p>Retrieves the MODIS snow data based on the search results.</p></td>
      </tr>
      <tr>
        <td><code>get_binary_snow()</code></td>
        <td><code>None</code></td>
        <td><p>Calculates a binary snow cover map from the data (only for MOD10A2 product).</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MODIS_snow</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to handle MODIS snow data.</span>

<span class="sd">    This class provides functionality to search, retrieve, and process MODIS snow cover data.</span>
<span class="sd">    It supports various MODIS snow products and allows for spatial and temporal subsetting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bbox_input : geopandas.GeoDataFrame or tuple or Shapely Geometry, optional</span>
<span class="sd">        GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">    clip_to_bbox : bool, optional</span>
<span class="sd">        Whether to clip the data to the bounding box. Default is True.</span>
<span class="sd">    start_date : str, optional</span>
<span class="sd">        The start date for the data in the format &#39;YYYY-MM-DD&#39;. Default is &#39;2000-01-01&#39;.</span>
<span class="sd">    end_date : str, optional</span>
<span class="sd">        The end date for the data in the format &#39;YYYY-MM-DD&#39;. Default is today&#39;s date.</span>
<span class="sd">    data_product : str, optional</span>
<span class="sd">        The MODIS data product to retrieve. Can choose between &#39;MOD10A1F&#39;, &#39;MOD10A1&#39;, or &#39;MOD10A2&#39;. Default is &#39;MOD10A2&#39;.</span>
<span class="sd">    bands : list, optional</span>
<span class="sd">        The bands to be used. Default is all bands.</span>
<span class="sd">    resolution : str, optional</span>
<span class="sd">        The resolution of the data. Defaults to native resolution.</span>
<span class="sd">    crs : str, optional</span>
<span class="sd">        The coordinate reference system. Default is None.</span>
<span class="sd">    vertical_tile : int, optional</span>
<span class="sd">        The vertical tile number for MODIS data. Default is None.</span>
<span class="sd">    horizontal_tile : int, optional</span>
<span class="sd">        The horizontal tile number for MODIS data. Default is None.</span>
<span class="sd">    mute : bool, optional</span>
<span class="sd">        Whether to mute print outputs. Default is False.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    data : xarray.Dataset</span>
<span class="sd">        The loaded MODIS snow data.</span>
<span class="sd">    binary_snow : xarray.DataArray</span>
<span class="sd">        Binary snow cover map derived from the data (only for MOD10A2 product).</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    search_data()</span>
<span class="sd">        Searches for MODIS snow data based on the specified parameters.</span>
<span class="sd">    get_data()</span>
<span class="sd">        Retrieves the MODIS snow data based on the search results.</span>
<span class="sd">    get_binary_snow()</span>
<span class="sd">        Calculates a binary snow cover map from the data (only for MOD10A2 product).</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Available data products:</span>
<span class="sd">    MOD10A1: Daily snow cover, 500m resolution</span>
<span class="sd">    MOD10A2: 8-day maximum snow cover, 500m resolution</span>
<span class="sd">    MOD10A1F: Daily cloud-free snow cover (gap-filled), 500m resolution</span>

<span class="sd">    Data citations:</span>
<span class="sd">    MOD10A1F: Hall, D. K. and G. A. Riggs. (2020). MODIS/Terra CGF Snow Cover Daily L3 Global 500m SIN Grid, Version 61 [Data Set]. Boulder, Colorado USA. NASA National Snow and Ice Data Center Distributed Active Archive Center. https://doi.org/10.5067/MODIS/MOD10A1F.061. Date Accessed 03-19-2024.</span>
<span class="sd">    MOD10A1: Hall, D. K. and G. A. Riggs. (2021). MODIS/Terra Snow Cover Daily L3 Global 500m SIN Grid, Version 61 [Data Set]. Boulder, Colorado USA. NASA National Snow and Ice Data Center Distributed Active Archive Center. https://doi.org/10.5067/MODIS/MOD10A1.061. Date Accessed 03-28-2024.</span>
<span class="sd">    MOD10A2: Hall, D. K. and G. A. Riggs. (2021). MODIS/Terra Snow Cover 8-Day L3 Global 500m SIN Grid, Version 61 [Data Set]. Boulder, Colorado USA. NASA National Snow and Ice Data Center Distributed Active Archive Center. https://doi.org/10.5067/MODIS/MOD10A2.061. Date Accessed 03-28-2024.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bbox_input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">clip_to_bbox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">,</span>
        <span class="n">end_date</span><span class="o">=</span><span class="n">today</span><span class="p">,</span>
        <span class="n">data_product</span><span class="o">=</span><span class="s2">&quot;MOD10A2&quot;</span><span class="p">,</span>
        <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vertical_tile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">horizontal_tile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mute</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="k">if</span> <span class="n">mute</span><span class="p">:</span>
            <span class="n">blockPrint</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span> <span class="o">=</span> <span class="n">bbox_input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span> <span class="o">=</span> <span class="n">convert_bbox_to_geodataframe</span><span class="p">(</span><span class="n">bbox_input</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clip_to_bbox</span> <span class="o">=</span> <span class="n">clip_to_bbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_date</span> <span class="o">=</span> <span class="n">start_date</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span> <span class="o">=</span> <span class="n">end_date</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_product</span> <span class="o">=</span> <span class="n">data_product</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bands</span> <span class="o">=</span> <span class="n">bands</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">resolution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertical_tile</span> <span class="o">=</span> <span class="n">vertical_tile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_tile</span> <span class="o">=</span> <span class="n">horizontal_tile</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">search_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">mute</span><span class="p">:</span>
            <span class="n">enablePrint</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">search_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_product</span> <span class="o">==</span> <span class="s2">&quot;MOD10A1&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_product</span> <span class="o">==</span> <span class="s2">&quot;MOD10A2&quot;</span><span class="p">:</span>
            <span class="n">catalog</span> <span class="o">=</span> <span class="n">pystac_client</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                <span class="s2">&quot;https://planetarycomputer.microsoft.com/api/stac/v1&quot;</span><span class="p">,</span>
                <span class="n">modifier</span><span class="o">=</span><span class="n">planetary_computer</span><span class="o">.</span><span class="n">sign_inplace</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">search</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                    <span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;modis-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data_product</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">-061&quot;</span><span class="p">],</span>
                    <span class="n">bbox</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
                    <span class="n">datetime</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">),</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">search</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                    <span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;modis-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data_product</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">-061&quot;</span><span class="p">],</span>
                    <span class="n">datetime</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">),</span>
                    <span class="n">query</span><span class="o">=</span><span class="p">{</span>
                        <span class="s2">&quot;modis:vertical-tile&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;eq&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertical_tile</span><span class="p">},</span>
                        <span class="s2">&quot;modis:horizontal-tile&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;eq&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_tile</span><span class="p">},</span>
                    <span class="p">},</span>
                <span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_product</span> <span class="o">==</span> <span class="s2">&quot;MOD10A1F&quot;</span><span class="p">:</span>
            <span class="n">search</span> <span class="o">=</span> <span class="n">earthaccess</span><span class="o">.</span><span class="n">search_data</span><span class="p">(</span>
                <span class="n">short_name</span><span class="o">=</span><span class="s2">&quot;MOD10A1F&quot;</span><span class="p">,</span>
                <span class="n">cloud_hosted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">bounding_box</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">),</span>
                <span class="n">temporal</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Data product not recognized. Please choose &#39;MOD10A1&#39;, &#39;MOD10A2&#39;, or &#39;MOD10A1F&#39;.&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="n">search</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_product</span> <span class="o">==</span> <span class="s2">&quot;MOD10A1&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_product</span> <span class="o">==</span> <span class="s2">&quot;MOD10A2&quot;</span><span class="p">:</span>

            <span class="n">load_params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">item_collection</span><span class="p">(),</span>
                <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">},</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clip_to_bbox</span><span class="p">:</span>
                <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span><span class="p">:</span>
                <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">:</span>
                <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="p">:</span>
                <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span>

            <span class="n">modis_snow</span> <span class="o">=</span> <span class="n">odc</span><span class="o">.</span><span class="n">stac</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="o">**</span><span class="n">load_params</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_product</span> <span class="o">==</span> <span class="s2">&quot;MOD10A1F&quot;</span><span class="p">:</span>
            <span class="c1"># files = earthaccess.open(results) # doesn&#39;t seem to work for .hdf files...</span>
            <span class="c1"># https://github.com/nsidc/earthaccess/blob/main/docs/tutorials/file-access.ipynb</span>
            <span class="c1"># https://github.com/nsidc/earthaccess/tree/main</span>
            <span class="c1"># https://earthaccess.readthedocs.io/en/latest/tutorials/emit-earthaccess/</span>
            <span class="c1"># https://nbviewer.org/urls/gist.githubusercontent.com/scottyhq/790bf19c7811b5c6243ce37aae252ca1/raw/e2632e928647fd91c797e4a23116d2ac3ff62372/0-load-hdf5.ipynb</span>
            <span class="c1"># https://docs.dask.org/en/latest/array-creation.html#concatenation-and-stacking</span>
            <span class="c1"># https://matthewrocklin.com/blog/work/2018/02/06/hdf-in-the-cloud</span>

            <span class="c1"># guess we&#39;ll download instead</span>
            <span class="n">temp_download_fp</span> <span class="o">=</span> <span class="s2">&quot;/tmp/local_folder&quot;</span>  <span class="c1"># do these auto delete, or should i delete when opened explicitly? shutil.rmtree(temp_download_fp)</span>

            <span class="n">files</span> <span class="o">=</span> <span class="n">earthaccess</span><span class="o">.</span><span class="n">download</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">,</span> <span class="n">temp_download_fp</span>
            <span class="p">)</span>  <span class="c1"># can i suppress the print output? https://earthaccess.readthedocs.io/en/latest/user-reference/api/api/</span>


            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clip_to_bbox</span><span class="p">:</span>
                <span class="n">modis_snow</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">rxr</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span>
                            <span class="n">file</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;CGF_NDSI_Snow_Cover&quot;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{}</span>
                        <span class="p">)[</span><span class="s2">&quot;CGF_NDSI_Snow_Cover&quot;</span><span class="p">]</span>
                        <span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
                        <span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip_box</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span><span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
                            <span class="n">time</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span>
                                <span class="n">rxr</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span>
                                    <span class="n">file</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;CGF_NDSI_Snow_Cover&quot;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{}</span>
                                <span class="p">)</span>
                                <span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
                                <span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;RANGEBEGINNINGDATE&quot;</span><span class="p">]</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                        <span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="s2">&quot;band&quot;</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span>
                    <span class="p">],</span>
                    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">modis_snow</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">rxr</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span>
                            <span class="n">file</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;CGF_NDSI_Snow_Cover&quot;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{}</span>
                        <span class="p">)[</span><span class="s2">&quot;CGF_NDSI_Snow_Cover&quot;</span><span class="p">]</span>
                        <span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
                        <span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
                            <span class="n">time</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span>
                                <span class="n">rxr</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span>
                                    <span class="n">file</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;CGF_NDSI_Snow_Cover&quot;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{}</span>
                                <span class="p">)</span>
                                <span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
                                <span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;RANGEBEGINNINGDATE&quot;</span><span class="p">]</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                        <span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="s2">&quot;band&quot;</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span>
                    <span class="p">],</span>
                    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Data product not recognized. Please choose &#39;MOD10A1&#39;, &#39;MOD10A2&#39;, or &#39;MOD10A1F&#39;.&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">modis_snow</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_product</span> <span class="o">==</span> <span class="s2">&quot;MOD10A2&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;missing data&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#006400&quot;</span><span class="p">},</span>
                <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;no decision&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#FFBB22&quot;</span><span class="p">},</span>
                <span class="mi">11</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;night&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#FFFF4C&quot;</span><span class="p">},</span>
                <span class="mi">25</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;no snow&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#F096FF&quot;</span><span class="p">},</span>
                <span class="mi">37</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;lake&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#FA0000&quot;</span><span class="p">},</span>
                <span class="mi">39</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ocean / sparse vegetation&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#B4B4B4&quot;</span><span class="p">},</span>
                <span class="mi">50</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;cloud&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#F0F0F0&quot;</span><span class="p">},</span>
                <span class="mi">100</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;lake ice&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#0064C8&quot;</span><span class="p">},</span>
                <span class="mi">200</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;snow&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#0096A0&quot;</span><span class="p">},</span>
                <span class="mi">254</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;detector saturated&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#00CF75&quot;</span><span class="p">},</span>
                <span class="mi">255</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#FAE6A0&quot;</span><span class="p">},</span>
            <span class="p">}</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data retrieved. Access with the .data attribute.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_binary_snow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_product</span> <span class="o">==</span> <span class="s2">&quot;MOD10A2&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binary_snow</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Maximum_Snow_Extent&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Binary snow map calculated. Access with the .binary_snow attribute.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This method is only available for the MOD10A2 product.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="easysnowdata.remote_sensing.Sentinel1" class="doc doc-heading">
        <code>
Sentinel1        </code>



<a href="#easysnowdata.remote_sensing.Sentinel1" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>A class to handle Sentinel-1 RTC satellite data.</p>
<p>This class provides functionality to search, retrieve, and process Sentinel-1 Radiometric Terrain Corrected (RTC) data.
It supports various data operations including border noise removal and unit conversion.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox_input</code></td>
        <td><code>geopandas.GeoDataFrame or tuple or Shapely Geometry</code></td>
        <td><p>GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date for the data in the format 'YYYY-MM-DD'. Default is '2014-01-01'.</p></td>
        <td><code>&#39;2014-01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date for the data in the format 'YYYY-MM-DD'. Default is today's date.</p></td>
        <td><code>&#39;2025-03-03&#39;</code></td>
      </tr>
      <tr>
        <td><code>catalog_choice</code></td>
        <td><code>str</code></td>
        <td><p>The catalog choice for the data. Default is 'planetarycomputer'.</p></td>
        <td><code>&#39;planetarycomputer&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>The bands to be used. Default is all bands.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>units</code></td>
        <td><code>str</code></td>
        <td><p>The units of the data. Can be 'dB' or 'linear power'. Default is 'dB'.</p></td>
        <td><code>&#39;dB&#39;</code></td>
      </tr>
      <tr>
        <td><code>resolution</code></td>
        <td><code>str</code></td>
        <td><p>The resolution of the data. Defaults to native resolution.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system. Default is None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>groupby</code></td>
        <td><code>str</code></td>
        <td><p>The groupby parameter for the data. Default is "sat:absolute_orbit".</p></td>
        <td><code>&#39;sat:absolute_orbit&#39;</code></td>
      </tr>
      <tr>
        <td><code>chunks</code></td>
        <td><code>dict</code></td>
        <td><p>The chunk size for dask arrays. Default is {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>remove_border_noise</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove border noise from the data. Default is True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>xarray.Dataset</code></td>
        <td><p>The loaded Sentinel-1 data.</p></td>
      </tr>
      <tr>
        <td><code>metadata</code></td>
        <td><code>geopandas.GeoDataFrame</code></td>
        <td><p>Metadata for the retrieved Sentinel-1 scenes.</p></td>
      </tr>
      <tr>
        <td><code>Methods</code></td>
        <td><code>None</code></td>
        <td></td>
      </tr>
      <tr>
        <td><code>-------</code></td>
        <td><code>None</code></td>
        <td></td>
      </tr>
      <tr>
        <td><code>search_data()</code></td>
        <td><code>None</code></td>
        <td><p>Searches for Sentinel-1 data based on the specified parameters.</p></td>
      </tr>
      <tr>
        <td><code>get_data()</code></td>
        <td><code>None</code></td>
        <td><p>Retrieves the Sentinel-1 data based on the search results.</p></td>
      </tr>
      <tr>
        <td><code>get_metadata()</code></td>
        <td><code>None</code></td>
        <td><p>Retrieves metadata for the Sentinel-1 scenes.</p></td>
      </tr>
      <tr>
        <td><code>remove_border_noise()</code></td>
        <td><code>None</code></td>
        <td><p>Removes border noise from the data.</p></td>
      </tr>
      <tr>
        <td><code>linear_to_db()</code></td>
        <td><code>None</code></td>
        <td><p>Converts linear power units to decibels (dB).</p></td>
      </tr>
      <tr>
        <td><code>db_to_linear()</code></td>
        <td><code>None</code></td>
        <td><p>Converts decibels (dB) to linear power units.</p></td>
      </tr>
      <tr>
        <td><code>add_orbit_info()</code></td>
        <td><code>None</code></td>
        <td><p>Adds orbit information to the data as coordinates.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Sentinel1</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to handle Sentinel-1 RTC satellite data.</span>

<span class="sd">    This class provides functionality to search, retrieve, and process Sentinel-1 Radiometric Terrain Corrected (RTC) data.</span>
<span class="sd">    It supports various data operations including border noise removal and unit conversion.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bbox_input : geopandas.GeoDataFrame or tuple or Shapely Geometry</span>
<span class="sd">        GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">    start_date : str, optional</span>
<span class="sd">        The start date for the data in the format &#39;YYYY-MM-DD&#39;. Default is &#39;2014-01-01&#39;.</span>
<span class="sd">    end_date : str, optional</span>
<span class="sd">        The end date for the data in the format &#39;YYYY-MM-DD&#39;. Default is today&#39;s date.</span>
<span class="sd">    catalog_choice : str, optional</span>
<span class="sd">        The catalog choice for the data. Default is &#39;planetarycomputer&#39;.</span>
<span class="sd">    bands : list, optional</span>
<span class="sd">        The bands to be used. Default is all bands.</span>
<span class="sd">    units : str, optional</span>
<span class="sd">        The units of the data. Can be &#39;dB&#39; or &#39;linear power&#39;. Default is &#39;dB&#39;.</span>
<span class="sd">    resolution : str, optional</span>
<span class="sd">        The resolution of the data. Defaults to native resolution.</span>
<span class="sd">    crs : str, optional</span>
<span class="sd">        The coordinate reference system. Default is None.</span>
<span class="sd">    groupby : str, optional</span>
<span class="sd">        The groupby parameter for the data. Default is &quot;sat:absolute_orbit&quot;.</span>
<span class="sd">    chunks : dict, optional</span>
<span class="sd">        The chunk size for dask arrays. Default is {}.</span>
<span class="sd">    remove_border_noise : bool, optional</span>
<span class="sd">        Whether to remove border noise from the data. Default is True.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    data : xarray.Dataset</span>
<span class="sd">        The loaded Sentinel-1 data.</span>
<span class="sd">    metadata : geopandas.GeoDataFrame</span>
<span class="sd">        Metadata for the retrieved Sentinel-1 scenes.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    search_data()</span>
<span class="sd">        Searches for Sentinel-1 data based on the specified parameters.</span>
<span class="sd">    get_data()</span>
<span class="sd">        Retrieves the Sentinel-1 data based on the search results.</span>
<span class="sd">    get_metadata()</span>
<span class="sd">        Retrieves metadata for the Sentinel-1 scenes.</span>
<span class="sd">    remove_border_noise()</span>
<span class="sd">        Removes border noise from the data.</span>
<span class="sd">    linear_to_db()</span>
<span class="sd">        Converts linear power units to decibels (dB).</span>
<span class="sd">    db_to_linear()</span>
<span class="sd">        Converts decibels (dB) to linear power units.</span>
<span class="sd">    add_orbit_info()</span>
<span class="sd">        Adds orbit information to the data as coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bbox_input</span><span class="p">,</span>
        <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2014-01-01&quot;</span><span class="p">,</span>
        <span class="n">end_date</span><span class="o">=</span><span class="n">today</span><span class="p">,</span>
        <span class="n">catalog_choice</span><span class="o">=</span><span class="s2">&quot;planetarycomputer&quot;</span><span class="p">,</span>
        <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">units</span><span class="o">=</span><span class="s1">&#39;dB&#39;</span><span class="p">,</span> <span class="c1"># linear power or dB</span>
        <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">groupby</span><span class="o">=</span><span class="s2">&quot;sat:absolute_orbit&quot;</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="p">{},</span> <span class="c1"># {&quot;x&quot;: 512, &quot;y&quot;: 512} or # {&quot;x&quot;: 512, &quot;y&quot;: 512, &quot;time&quot;: -1}</span>
        <span class="n">remove_border_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The constructor for the Sentinel1 class.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            bbox_input (geopandas.GeoDataFrame or tuple or shapely.Geometry): GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">            start_date (str): The start date for the data in the format &#39;YYYY-MM-DD&#39;. Default is &#39;2014-01-01&#39;.</span>
<span class="sd">            end_date (str): The end date for the data in the format &#39;YYYY-MM-DD&#39;. Default is today&#39;s date.</span>
<span class="sd">            catalog_choice (str): The catalog choice for the data. Can choose between &#39;planetarycomputer&#39; and &lt;unimplemented&gt;, default is &#39;planetarycomputer&#39;.</span>
<span class="sd">            bands (list): The bands to be used. Default is all bands.</span>
<span class="sd">            resolution (str): The resolution of the data. Defaults to native resolution, 10m.</span>
<span class="sd">            crs (str): The coordinate reference system. This should be a string like &#39;EPSG:4326&#39;. Default CRS is UTM zone estimated from bounding box.</span>
<span class="sd">            groupby (str): The groupby parameter for the data. Default is &quot;sat:absolute_orbit&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize the attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span> <span class="o">=</span> <span class="n">bbox_input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_date</span> <span class="o">=</span> <span class="n">start_date</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span> <span class="o">=</span> <span class="n">end_date</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">=</span> <span class="n">catalog_choice</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bands</span> <span class="o">=</span> <span class="n">bands</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">resolution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span> <span class="o">=</span> <span class="n">chunks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span> <span class="o">=</span> <span class="n">groupby</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_border_noise</span> <span class="o">=</span> <span class="n">remove_border_noise</span>

        <span class="c1">#if not self.geobox:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span> <span class="o">=</span> <span class="n">convert_bbox_to_geodataframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">estimate_utm_crs</span><span class="p">()</span>

        <span class="c1"># if resolution == None:</span>
        <span class="c1">#     self.resolution = 10</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">search_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_border_noise</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_bad_scenes_and_border_noise</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_orbit_info</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;dB&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linear_to_db</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Units remain in linear power. Convert to dB using the .linear_to_db() method.&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">search_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to search the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Choose the catalog URL based on catalog_choice</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">==</span> <span class="s2">&quot;planetarycomputer&quot;</span><span class="p">:</span>
            <span class="n">catalog_url</span> <span class="o">=</span> <span class="s2">&quot;https://planetarycomputer.microsoft.com/api/stac/v1&quot;</span>
            <span class="n">catalog</span> <span class="o">=</span> <span class="n">pystac_client</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                <span class="n">catalog_url</span><span class="p">,</span> <span class="n">modifier</span><span class="o">=</span><span class="n">planetary_computer</span><span class="o">.</span><span class="n">sign_inplace</span>
            <span class="p">)</span>
        <span class="c1"># elif self.catalog_choice == &quot;aws&quot;:</span>
        <span class="c1">#     catalog_url = indigo</span>
        <span class="c1">#     catalog = pystac_client.Client.open(catalog_url)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Invalid catalog_choice. Choose either &#39;planetarycomputer&#39; or &lt;unimplemented&gt;.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Search for items within the specified bbox and date range</span>
        <span class="n">search</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
            <span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sentinel-1-rtc&quot;</span><span class="p">],</span>
            <span class="n">bbox</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
            <span class="n">datetime</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="c1"># elif self.geobox:</span>
        <span class="c1">#     search = catalog.search(</span>
        <span class="c1">#         collections=[&quot;sentinel-1-rtc&quot;],</span>
        <span class="c1">#         bbox=np.array(self.geobox.extent.boundingbox.to_crs(&#39;epsg:4326&#39;)),</span>
        <span class="c1">#         datetime=(self.start_date, self.end_date),</span>
        <span class="c1">#     )</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="n">search</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data searched. Access the returned seach with the .search attribute.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to get the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Prepare the parameters for odc.stac.load</span>
        <span class="n">load_params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">32768</span><span class="p">,</span>
            <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">,</span>
            <span class="s2">&quot;groupby&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span><span class="p">:</span>
            <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span>
        <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span>
        <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span>
        <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span>

        <span class="c1"># Load the data lazily using odc.stac</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">odc</span><span class="o">.</span><span class="n">stac</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="o">**</span><span class="n">load_params</span><span class="p">)</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span>
            <span class="s2">&quot;time&quot;</span>
        <span class="p">)</span>  <span class="c1"># sorting by time because of known issue in s1 mpc stac catalog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;linear power&quot;</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Data retrieved. Access with the .data attribute. Data CRS: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">estimate_utm_crs</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to get the metadata.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">stac_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">item_collection_as_dict</span><span class="p">()</span>
        <span class="n">metadata_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_features</span><span class="p">(</span><span class="n">stac_json</span><span class="p">,</span> <span class="s2">&quot;epsg:4326&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata_gdf</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Metadata retrieved. Access with the .metadata attribute.&quot;</span><span class="p">)</span>

    <span class="c1"># def remove_border_noise(self,threshold=0.001):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     The method to remove border noise from the data.</span>
    <span class="c1">#     https://forum.step.esa.int/t/grd-border-noise-and-thermal-noise-removal-are-not-working-anymore-since-march-13-2018/9332</span>
    <span class="c1">#     https://www.mdpi.com/2072-4292/8/4/348</span>
    <span class="c1">#     https://forum.step.esa.int/t/nan-appears-at-the-edge-of-the-scene-after-applying-border-noise-removal-sentinel-1-grd/40627/2</span>
    <span class="c1">#     https://sentiwiki.copernicus.eu/__attachments/1673968/OI-MPC-OTH-MPC-0243%20-%20Sentinel-1%20masking%20no%20value%20pixels%20grd%20products%20note%202023%20-%202.2.pdf?inst-v=534578f3-fc04-48e9-bd69-3a45a681fe67#page=12.58</span>
    <span class="c1">#     https://ieeexplore.ieee.org/document/8255846</span>
    <span class="c1">#     https://www.mdpi.com/2504-3900/2/7/330</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     self.data.loc[dict(time=slice(&#39;2014-01-01&#39;,&#39;2018-03-14&#39;))] = self.data.sel(time=slice(&#39;2014-01-01&#39;,&#39;2018-03-14&#39;)).where(lambda x: x &gt; threshold)</span>
    <span class="c1">#     print(f&quot;Border noise removed from the data.&quot;)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_bad_scenes_and_border_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
        <span class="n">cutoff_date</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2018-03-14&#39;</span><span class="p">)</span>

        <span class="n">original_crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;</span> <span class="n">cutoff_date</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">result</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="n">original_crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">result</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Falsely low scenes and border noise removed from the data.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">linear_to_db</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to convert the linear power data to dB.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;dB&quot;</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Linear power units converted to dB. Convert back to linear power units using the .db_to_linear() method.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">db_to_linear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to convert the dB data to linear power.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;linear power&quot;</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;dB converted to linear power units. Convert back to dB using the .linear_to_db() method.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_orbit_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to add the relative orbit number to the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">metadata_groupby_gdf</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;sat:orbit_state&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">metadata_groupby_gdf</span><span class="p">[</span><span class="s2">&quot;sat:orbit_state&quot;</span><span class="p">])}</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;sat:relative_orbit&quot;</span><span class="p">:</span> <span class="p">(</span>
                    <span class="s2">&quot;time&quot;</span><span class="p">,</span>
                    <span class="n">metadata_groupby_gdf</span><span class="p">[</span><span class="s2">&quot;sat:relative_orbit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int16&quot;</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Added relative orbit number and orbit state as coordinates to the data.&quot;</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel1.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bbox_input</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2014-01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2025-03-03&#39;</span><span class="p">,</span> <span class="n">catalog_choice</span><span class="o">=</span><span class="s1">&#39;planetarycomputer&#39;</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;dB&#39;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s1">&#39;sat:absolute_orbit&#39;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{},</span> <span class="n">remove_border_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#easysnowdata.remote_sensing.Sentinel1.__init__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The constructor for the Sentinel1 class.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox_input</code></td>
        <td><code>geopandas.GeoDataFrame or tuple or shapely.Geometry</code></td>
        <td><p>GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date for the data in the format 'YYYY-MM-DD'. Default is '2014-01-01'.</p></td>
        <td><code>&#39;2014-01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date for the data in the format 'YYYY-MM-DD'. Default is today's date.</p></td>
        <td><code>&#39;2025-03-03&#39;</code></td>
      </tr>
      <tr>
        <td><code>catalog_choice</code></td>
        <td><code>str</code></td>
        <td><p>The catalog choice for the data. Can choose between 'planetarycomputer' and <unimplemented>, default is 'planetarycomputer'.</p></td>
        <td><code>&#39;planetarycomputer&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>The bands to be used. Default is all bands.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>resolution</code></td>
        <td><code>str</code></td>
        <td><p>The resolution of the data. Defaults to native resolution, 10m.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system. This should be a string like 'EPSG:4326'. Default CRS is UTM zone estimated from bounding box.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>groupby</code></td>
        <td><code>str</code></td>
        <td><p>The groupby parameter for the data. Default is "sat:absolute_orbit".</p></td>
        <td><code>&#39;sat:absolute_orbit&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">bbox_input</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2014-01-01&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="n">today</span><span class="p">,</span>
    <span class="n">catalog_choice</span><span class="o">=</span><span class="s2">&quot;planetarycomputer&quot;</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">units</span><span class="o">=</span><span class="s1">&#39;dB&#39;</span><span class="p">,</span> <span class="c1"># linear power or dB</span>
    <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">groupby</span><span class="o">=</span><span class="s2">&quot;sat:absolute_orbit&quot;</span><span class="p">,</span>
    <span class="n">chunks</span><span class="o">=</span><span class="p">{},</span> <span class="c1"># {&quot;x&quot;: 512, &quot;y&quot;: 512} or # {&quot;x&quot;: 512, &quot;y&quot;: 512, &quot;time&quot;: -1}</span>
    <span class="n">remove_border_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The constructor for the Sentinel1 class.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        bbox_input (geopandas.GeoDataFrame or tuple or shapely.Geometry): GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">        start_date (str): The start date for the data in the format &#39;YYYY-MM-DD&#39;. Default is &#39;2014-01-01&#39;.</span>
<span class="sd">        end_date (str): The end date for the data in the format &#39;YYYY-MM-DD&#39;. Default is today&#39;s date.</span>
<span class="sd">        catalog_choice (str): The catalog choice for the data. Can choose between &#39;planetarycomputer&#39; and &lt;unimplemented&gt;, default is &#39;planetarycomputer&#39;.</span>
<span class="sd">        bands (list): The bands to be used. Default is all bands.</span>
<span class="sd">        resolution (str): The resolution of the data. Defaults to native resolution, 10m.</span>
<span class="sd">        crs (str): The coordinate reference system. This should be a string like &#39;EPSG:4326&#39;. Default CRS is UTM zone estimated from bounding box.</span>
<span class="sd">        groupby (str): The groupby parameter for the data. Default is &quot;sat:absolute_orbit&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize the attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span> <span class="o">=</span> <span class="n">bbox_input</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_date</span> <span class="o">=</span> <span class="n">start_date</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span> <span class="o">=</span> <span class="n">end_date</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">=</span> <span class="n">catalog_choice</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bands</span> <span class="o">=</span> <span class="n">bands</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">resolution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span> <span class="o">=</span> <span class="n">chunks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span> <span class="o">=</span> <span class="n">groupby</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">remove_border_noise</span> <span class="o">=</span> <span class="n">remove_border_noise</span>

    <span class="c1">#if not self.geobox:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span> <span class="o">=</span> <span class="n">convert_bbox_to_geodataframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">estimate_utm_crs</span><span class="p">()</span>

    <span class="c1"># if resolution == None:</span>
    <span class="c1">#     self.resolution = 10</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">search_data</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_border_noise</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_bad_scenes_and_border_noise</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_orbit_info</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;dB&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear_to_db</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Units remain in linear power. Convert to dB using the .linear_to_db() method.&#39;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel1.add_orbit_info" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_orbit_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel1.add_orbit_info" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to add the relative orbit number to the data.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_orbit_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to add the relative orbit number to the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">metadata_groupby_gdf</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;sat:orbit_state&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">metadata_groupby_gdf</span><span class="p">[</span><span class="s2">&quot;sat:orbit_state&quot;</span><span class="p">])}</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;sat:relative_orbit&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="s2">&quot;time&quot;</span><span class="p">,</span>
                <span class="n">metadata_groupby_gdf</span><span class="p">[</span><span class="s2">&quot;sat:relative_orbit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int16&quot;</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Added relative orbit number and orbit state as coordinates to the data.&quot;</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel1.db_to_linear" class="doc doc-heading">
<code class="highlight language-python"><span class="n">db_to_linear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel1.db_to_linear" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to convert the dB data to linear power.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">db_to_linear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to convert the dB data to linear power.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;linear power&quot;</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;dB converted to linear power units. Convert back to dB using the .linear_to_db() method.&quot;</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel1.get_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel1.get_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to get the data.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to get the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Prepare the parameters for odc.stac.load</span>
    <span class="n">load_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
        <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">32768</span><span class="p">,</span>
        <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">,</span>
        <span class="s2">&quot;groupby&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span><span class="p">:</span>
        <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span>
    <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span>
    <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span>
    <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span>

    <span class="c1"># Load the data lazily using odc.stac</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">odc</span><span class="o">.</span><span class="n">stac</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="o">**</span><span class="n">load_params</span><span class="p">)</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span>
        <span class="s2">&quot;time&quot;</span>
    <span class="p">)</span>  <span class="c1"># sorting by time because of known issue in s1 mpc stac catalog</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;linear power&quot;</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Data retrieved. Access with the .data attribute. Data CRS: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">estimate_utm_crs</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel1.get_metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel1.get_metadata" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to get the metadata.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to get the metadata.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stac_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">item_collection_as_dict</span><span class="p">()</span>
    <span class="n">metadata_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_features</span><span class="p">(</span><span class="n">stac_json</span><span class="p">,</span> <span class="s2">&quot;epsg:4326&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata_gdf</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Metadata retrieved. Access with the .metadata attribute.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel1.linear_to_db" class="doc doc-heading">
<code class="highlight language-python"><span class="n">linear_to_db</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel1.linear_to_db" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to convert the linear power data to dB.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">linear_to_db</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to convert the linear power data to dB.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;dB&quot;</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Linear power units converted to dB. Convert back to linear power units using the .db_to_linear() method.&quot;</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel1.search_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">search_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel1.search_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to search the data.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">search_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to search the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Choose the catalog URL based on catalog_choice</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">==</span> <span class="s2">&quot;planetarycomputer&quot;</span><span class="p">:</span>
        <span class="n">catalog_url</span> <span class="o">=</span> <span class="s2">&quot;https://planetarycomputer.microsoft.com/api/stac/v1&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="n">pystac_client</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="n">catalog_url</span><span class="p">,</span> <span class="n">modifier</span><span class="o">=</span><span class="n">planetary_computer</span><span class="o">.</span><span class="n">sign_inplace</span>
        <span class="p">)</span>
    <span class="c1"># elif self.catalog_choice == &quot;aws&quot;:</span>
    <span class="c1">#     catalog_url = indigo</span>
    <span class="c1">#     catalog = pystac_client.Client.open(catalog_url)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid catalog_choice. Choose either &#39;planetarycomputer&#39; or &lt;unimplemented&gt;.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Search for items within the specified bbox and date range</span>
    <span class="n">search</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
        <span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sentinel-1-rtc&quot;</span><span class="p">],</span>
        <span class="n">bbox</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
        <span class="n">datetime</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="c1"># elif self.geobox:</span>
    <span class="c1">#     search = catalog.search(</span>
    <span class="c1">#         collections=[&quot;sentinel-1-rtc&quot;],</span>
    <span class="c1">#         bbox=np.array(self.geobox.extent.boundingbox.to_crs(&#39;epsg:4326&#39;)),</span>
    <span class="c1">#         datetime=(self.start_date, self.end_date),</span>
    <span class="c1">#     )</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="n">search</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data searched. Access the returned seach with the .search attribute.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="easysnowdata.remote_sensing.Sentinel2" class="doc doc-heading">
        <code>
Sentinel2        </code>



<a href="#easysnowdata.remote_sensing.Sentinel2" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>A class to handle Sentinel-2 satellite data.</p>
<p>This class provides functionality to search, retrieve, and process Sentinel-2 satellite imagery.
It supports various data operations including masking, scaling, and calculation of spectral indices.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox_input</code></td>
        <td><code>geopandas.GeoDataFrame or tuple or Shapely Geometry</code></td>
        <td><p>GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date for the data in the format 'YYYY-MM-DD'. Default is '2014-01-01'.</p></td>
        <td><code>&#39;2014-01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date for the data in the format 'YYYY-MM-DD'. Default is today's date.</p></td>
        <td><code>&#39;2025-03-03&#39;</code></td>
      </tr>
      <tr>
        <td><code>catalog_choice</code></td>
        <td><code>str</code></td>
        <td><p>The catalog choice for the data. Can choose between 'planetarycomputer' and 'earthsearch'. Default is 'planetarycomputer'.</p></td>
        <td><code>&#39;planetarycomputer&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>The bands to be used. Default is all bands. Must include SCL for data masking.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>resolution</code></td>
        <td><code>str</code></td>
        <td><p>The resolution of the data. Defaults to native resolution, 10m.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system. This should be a string like 'EPSG:4326'. Default CRS is UTM zone estimated from bounding box.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>remove_nodata</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove no data values. Default is True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>harmonize_to_old</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to harmonize new data to the old baseline. Default is True.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>scale_data</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to scale the data. Default is True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>groupby</code></td>
        <td><code>str</code></td>
        <td><p>The groupby parameter for the data. Default is "solar_day".</p></td>
        <td><code>&#39;solar_day&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>xarray.Dataset</code></td>
        <td><p>The loaded Sentinel-2 data.</p></td>
      </tr>
      <tr>
        <td><code>metadata</code></td>
        <td><code>geopandas.GeoDataFrame</code></td>
        <td><p>Metadata for the retrieved Sentinel-2 scenes.</p></td>
      </tr>
      <tr>
        <td><code>rgb</code></td>
        <td><code>xarray.DataArray</code></td>
        <td><p>RGB composite of the Sentinel-2 data.</p></td>
      </tr>
      <tr>
        <td><code>ndvi</code></td>
        <td><code>xarray.DataArray</code></td>
        <td><p>Normalized Difference Vegetation Index (NDVI) calculated from the data.</p></td>
      </tr>
      <tr>
        <td><code>ndsi</code></td>
        <td><code>xarray.DataArray</code></td>
        <td><p>Normalized Difference Snow Index (NDSI) calculated from the data.</p></td>
      </tr>
      <tr>
        <td><code>ndwi</code></td>
        <td><code>xarray.DataArray</code></td>
        <td><p>Normalized Difference Water Index (NDWI) calculated from the data.</p></td>
      </tr>
      <tr>
        <td><code>evi</code></td>
        <td><code>xarray.DataArray</code></td>
        <td><p>Enhanced Vegetation Index (EVI) calculated from the data.</p></td>
      </tr>
      <tr>
        <td><code>ndbi</code></td>
        <td><code>xarray.DataArray</code></td>
        <td><p>Normalized Difference Built-up Index (NDBI) calculated from the data.</p></td>
      </tr>
      <tr>
        <td><code>Methods</code></td>
        <td><code>None</code></td>
        <td></td>
      </tr>
      <tr>
        <td><code>-------</code></td>
        <td><code>None</code></td>
        <td></td>
      </tr>
      <tr>
        <td><code>search_data()</code></td>
        <td><code>None</code></td>
        <td><p>Searches for Sentinel-2 data based on the specified parameters.</p></td>
      </tr>
      <tr>
        <td><code>get_data()</code></td>
        <td><code>None</code></td>
        <td><p>Retrieves the Sentinel-2 data based on the search results.</p></td>
      </tr>
      <tr>
        <td><code>get_metadata()</code></td>
        <td><code>None</code></td>
        <td><p>Retrieves metadata for the Sentinel-2 scenes.</p></td>
      </tr>
      <tr>
        <td><code>remove_nodata_inplace()</code></td>
        <td><code>None</code></td>
        <td><p>Removes no data values from the data.</p></td>
      </tr>
      <tr>
        <td><code>mask_data()</code></td>
        <td><code>None</code></td>
        <td><p>Masks the data based on the Scene Classification Layer (SCL).</p></td>
      </tr>
      <tr>
        <td><code>harmonize_to_old_inplace()</code></td>
        <td><code>None</code></td>
        <td><p>Harmonizes new Sentinel-2 data to the old baseline.</p></td>
      </tr>
      <tr>
        <td><code>scale_data_inplace()</code></td>
        <td><code>None</code></td>
        <td><p>Scales the data to reflectance values.</p></td>
      </tr>
      <tr>
        <td><code>get_rgb()</code></td>
        <td><code>None</code></td>
        <td><p>Retrieves the RGB composite of the data.</p></td>
      </tr>
      <tr>
        <td><code>get_ndvi()</code></td>
        <td><code>None</code></td>
        <td><p>Calculates the Normalized Difference Vegetation Index (NDVI).</p></td>
      </tr>
      <tr>
        <td><code>get_ndsi()</code></td>
        <td><code>None</code></td>
        <td><p>Calculates the Normalized Difference Snow Index (NDSI).</p></td>
      </tr>
      <tr>
        <td><code>get_ndwi()</code></td>
        <td><code>None</code></td>
        <td><p>Calculates the Normalized Difference Water Index (NDWI).</p></td>
      </tr>
      <tr>
        <td><code>get_evi()</code></td>
        <td><code>None</code></td>
        <td><p>Calculates the Enhanced Vegetation Index (EVI).</p></td>
      </tr>
      <tr>
        <td><code>get_ndbi()</code></td>
        <td><code>None</code></td>
        <td><p>Calculates the Normalized Difference Built-up Index (NDBI).</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Sentinel2</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to handle Sentinel-2 satellite data.</span>

<span class="sd">    This class provides functionality to search, retrieve, and process Sentinel-2 satellite imagery.</span>
<span class="sd">    It supports various data operations including masking, scaling, and calculation of spectral indices.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bbox_input : geopandas.GeoDataFrame or tuple or Shapely Geometry</span>
<span class="sd">        GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">    start_date : str, optional</span>
<span class="sd">        The start date for the data in the format &#39;YYYY-MM-DD&#39;. Default is &#39;2014-01-01&#39;.</span>
<span class="sd">    end_date : str, optional</span>
<span class="sd">        The end date for the data in the format &#39;YYYY-MM-DD&#39;. Default is today&#39;s date.</span>
<span class="sd">    catalog_choice : str, optional</span>
<span class="sd">        The catalog choice for the data. Can choose between &#39;planetarycomputer&#39; and &#39;earthsearch&#39;. Default is &#39;planetarycomputer&#39;.</span>
<span class="sd">    bands : list, optional</span>
<span class="sd">        The bands to be used. Default is all bands. Must include SCL for data masking.</span>
<span class="sd">    resolution : str, optional</span>
<span class="sd">        The resolution of the data. Defaults to native resolution, 10m.</span>
<span class="sd">    crs : str, optional</span>
<span class="sd">        The coordinate reference system. This should be a string like &#39;EPSG:4326&#39;. Default CRS is UTM zone estimated from bounding box.</span>
<span class="sd">    remove_nodata : bool, optional</span>
<span class="sd">        Whether to remove no data values. Default is True.</span>
<span class="sd">    harmonize_to_old : bool, optional</span>
<span class="sd">        Whether to harmonize new data to the old baseline. Default is True.</span>
<span class="sd">    scale_data : bool, optional</span>
<span class="sd">        Whether to scale the data. Default is True.</span>
<span class="sd">    groupby : str, optional</span>
<span class="sd">        The groupby parameter for the data. Default is &quot;solar_day&quot;.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    data : xarray.Dataset</span>
<span class="sd">        The loaded Sentinel-2 data.</span>
<span class="sd">    metadata : geopandas.GeoDataFrame</span>
<span class="sd">        Metadata for the retrieved Sentinel-2 scenes.</span>
<span class="sd">    rgb : xarray.DataArray</span>
<span class="sd">        RGB composite of the Sentinel-2 data.</span>
<span class="sd">    ndvi : xarray.DataArray</span>
<span class="sd">        Normalized Difference Vegetation Index (NDVI) calculated from the data.</span>
<span class="sd">    ndsi : xarray.DataArray</span>
<span class="sd">        Normalized Difference Snow Index (NDSI) calculated from the data.</span>
<span class="sd">    ndwi : xarray.DataArray</span>
<span class="sd">        Normalized Difference Water Index (NDWI) calculated from the data.</span>
<span class="sd">    evi : xarray.DataArray</span>
<span class="sd">        Enhanced Vegetation Index (EVI) calculated from the data.</span>
<span class="sd">    ndbi : xarray.DataArray</span>
<span class="sd">        Normalized Difference Built-up Index (NDBI) calculated from the data.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    search_data()</span>
<span class="sd">        Searches for Sentinel-2 data based on the specified parameters.</span>
<span class="sd">    get_data()</span>
<span class="sd">        Retrieves the Sentinel-2 data based on the search results.</span>
<span class="sd">    get_metadata()</span>
<span class="sd">        Retrieves metadata for the Sentinel-2 scenes.</span>
<span class="sd">    remove_nodata_inplace()</span>
<span class="sd">        Removes no data values from the data.</span>
<span class="sd">    mask_data()</span>
<span class="sd">        Masks the data based on the Scene Classification Layer (SCL).</span>
<span class="sd">    harmonize_to_old_inplace()</span>
<span class="sd">        Harmonizes new Sentinel-2 data to the old baseline.</span>
<span class="sd">    scale_data_inplace()</span>
<span class="sd">        Scales the data to reflectance values.</span>
<span class="sd">    get_rgb()</span>
<span class="sd">        Retrieves the RGB composite of the data.</span>
<span class="sd">    get_ndvi()</span>
<span class="sd">        Calculates the Normalized Difference Vegetation Index (NDVI).</span>
<span class="sd">    get_ndsi()</span>
<span class="sd">        Calculates the Normalized Difference Snow Index (NDSI).</span>
<span class="sd">    get_ndwi()</span>
<span class="sd">        Calculates the Normalized Difference Water Index (NDWI).</span>
<span class="sd">    get_evi()</span>
<span class="sd">        Calculates the Enhanced Vegetation Index (EVI).</span>
<span class="sd">    get_ndbi()</span>
<span class="sd">        Calculates the Normalized Difference Built-up Index (NDBI).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bbox_input</span><span class="p">,</span>
        <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2014-01-01&quot;</span><span class="p">,</span>
        <span class="n">end_date</span><span class="o">=</span><span class="n">today</span><span class="p">,</span>
        <span class="n">catalog_choice</span><span class="o">=</span><span class="s2">&quot;planetarycomputer&quot;</span><span class="p">,</span>
        <span class="n">collection</span><span class="o">=</span> <span class="s2">&quot;sentinel-2-l2a&quot;</span><span class="p">,</span> <span class="c1"># could also choose &quot;sentinel-2-c1-l2a&quot; once published to https://github.com/Element84/earth-search</span>
        <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">remove_nodata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">harmonize_to_old</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">scale_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">groupby</span><span class="o">=</span><span class="s2">&quot;solar_day&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The constructor for the Sentinel2 class.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            bbox_input (geopandas.GeoDataFrame or tuple or Shapely Geometry): GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">            start_date (str): The start date for the data in the format &#39;YYYY-MM-DD&#39;. Default is &#39;2014-01-01&#39;.</span>
<span class="sd">            end_date (str): The end date for the data in the format &#39;YYYY-MM-DD&#39;. Default is today&#39;s date.</span>
<span class="sd">            catalog_choice (str): The catalog choice for the data. Can choose between &#39;planetarycomputer&#39; and &#39;earthsearch&#39;, default is &#39;planetarycomputer&#39;.</span>
<span class="sd">            bands (list): The bands to be used. Default is all bands. Must include SCL for data masking. Each band should be a string like &#39;B01&#39;, &#39;B02&#39;, etc.</span>
<span class="sd">            resolution (str): The resolution of the data. Defaults to native resolution, 10m.</span>
<span class="sd">            crs (str): The coordinate reference system. This should be a string like &#39;EPSG:4326&#39;. Default CRS is UTM zone estimated from bounding box.</span>
<span class="sd">            groupby (str): The groupby parameter for the data. Default is &quot;solar_day&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize the attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span> <span class="o">=</span> <span class="n">bbox_input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_date</span> <span class="o">=</span> <span class="n">start_date</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span> <span class="o">=</span> <span class="n">end_date</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">=</span> <span class="n">catalog_choice</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">collection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bands</span> <span class="o">=</span> <span class="n">bands</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">resolution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_nodata</span> <span class="o">=</span> <span class="n">remove_nodata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old</span> <span class="o">=</span> <span class="n">harmonize_to_old</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_data</span> <span class="o">=</span> <span class="n">scale_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span> <span class="o">=</span> <span class="n">groupby</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span> <span class="o">=</span> <span class="n">convert_bbox_to_geodataframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">estimate_utm_crs</span><span class="p">()</span>

        <span class="c1"># Define the band information</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;B01&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;coastal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Coastal aerosol, 442.7 nm (S2A), 442.3 nm (S2B)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;60m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;B02&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Blue, 492.4 nm (S2A), 492.1 nm (S2B)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;B03&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Green, 559.8 nm (S2A), 559.0 nm (S2B)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;B04&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Red, 664.6 nm (S2A), 665.0 nm (S2B)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;B05&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;rededge&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Vegetation red edge, 704.1 nm (S2A), 703.8 nm (S2B)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;B06&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;rededge2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Vegetation red edge, 740.5 nm (S2A), 739.1 nm (S2B)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;B07&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;rededge3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Vegetation red edge, 782.8 nm (S2A), 779.7 nm (S2B)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;B08&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;nir&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;NIR, 832.8 nm (S2A), 833.0 nm (S2B)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;B8A&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;nir08&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Narrow NIR, 864.7 nm (S2A), 864.0 nm (S2B)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;B09&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;nir09&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Water vapour, 945.1 nm (S2A), 943.2 nm (S2B)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;60m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;B11&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;swir16&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;SWIR, 1613.7 nm (S2A), 1610.4 nm (S2B)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;B12&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;swir22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;SWIR, 2202.4 nm (S2A), 2185.7 nm (S2B)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;AOT&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;aot&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Aerosol Optical Thickness map, based on Sen2Cor processor&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;SCL&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;scl&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Scene classification data, based on Sen2Cor processor&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;WVP&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;wvp&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Water Vapour map&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;visual&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;visual&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;True color image&quot;</span><span class="p">,</span>
                <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>

        <span class="c1"># Define the scene classification information, classes here: https://custom-scripts.sentinel-hub.com/custom-scripts/sentinel-2/scene-classification/</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;No Data (Missing data)&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">},</span>
            <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Saturated or defective pixel&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ff0000&quot;</span><span class="p">},</span>
            <span class="mi">2</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Topographic casted shadows&quot;</span><span class="p">,</span>
                <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#2f2f2f&quot;</span><span class="p">,</span>
            <span class="p">},</span>  <span class="c1"># (called &#39;Dark features/Shadows&#39; for data before 2022-01-25)</span>
            <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cloud shadows&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#643200&quot;</span><span class="p">},</span>
            <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Vegetation&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#00a000&quot;</span><span class="p">},</span>
            <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Not-vegetated&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ffe65a&quot;</span><span class="p">},</span>
            <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Water&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#0000ff&quot;</span><span class="p">},</span>
            <span class="mi">7</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Unclassified&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#808080&quot;</span><span class="p">},</span>
            <span class="mi">8</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cloud medium probability&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#c0c0c0&quot;</span><span class="p">},</span>
            <span class="mi">9</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cloud high probability&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">},</span>
            <span class="mi">10</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Thin cirrus&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#64c8ff&quot;</span><span class="p">},</span>
            <span class="mi">11</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Snow or ice&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ff96ff&quot;</span><span class="p">},</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scl_cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span>
            <span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="p">)</span>

        <span class="c1"># Initialize the data attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rgba</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rgb_clahe</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rgb_percentile</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndvi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndsi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndwi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndbi</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">search_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_nodata</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_nodata_inplace</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">==</span> <span class="s2">&quot;planetarycomputer&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">==</span> <span class="s2">&quot;sentinel-2-c1-l2a&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">==</span> <span class="s2">&quot;sentinel-2-l2a&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Since </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span><span class="si">}</span><span class="s2"> is used, harmonization step is not needed.&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown collection: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old_inplace</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale_data_inplace</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>



        <span class="c1"># Add the plot_scl method as an attribute to the SCL data variable</span>
        <span class="k">if</span> <span class="s1">&#39;scl&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;example_plot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_scl</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;class_info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scl_cmap</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_scl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scl_data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">legend_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="n">scl_data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="n">class_values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">class_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">class_values</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">class_values</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">class_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">]</span> <span class="o">+</span> <span class="n">bounds</span> <span class="o">+</span> <span class="p">[</span><span class="n">class_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">]</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scl_cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">scl_data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Single image plot</span>
            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>

            <span class="n">im</span> <span class="o">=</span> <span class="n">scl_data</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scl_cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>

            <span class="n">local_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">scl_data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="s1">&#39;America/Los_Angeles&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sentinel-2 Scene Classification Layer (SCL)</span><span class="se">\n</span><span class="si">{</span><span class="n">local_time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%B </span><span class="si">%d</span><span class="s1">, %Y&#39;</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">local_time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%I:%M%p&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Multiple images plot</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">scl_data</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
                <span class="n">col</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
                <span class="n">col_wrap</span><span class="o">=</span><span class="n">col_wrap</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scl_cmap</span><span class="p">,</span>
                <span class="n">norm</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scl_cmap</span><span class="o">.</span><span class="n">N</span><span class="p">),</span>
                <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="c1">#figsize=figsize</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">scl_data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                <span class="n">local_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">time</span><span class="p">)</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="s1">&#39;America/Los_Angeles&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">local_time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%B </span><span class="si">%d</span><span class="s2">, %Y&quot;</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">local_time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%I:%M%p&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

            <span class="n">f</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Sentinel-2 SCL time series&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>

        <span class="c1"># Add legend</span>
        <span class="n">legend_handles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">class_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">class_value</span><span class="p">,</span> <span class="n">class_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">legend_handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">class_info</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">class_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

        <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="n">legend_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">scl_data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">default_legend_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">),</span>
                <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ncol&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_names</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span>
                <span class="s2">&quot;frameon&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;handlelength&quot;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">,</span>
                <span class="s2">&quot;handleheight&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">default_legend_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">),</span>
                <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ncol&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_names</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span>
                <span class="s2">&quot;frameon&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;handlelength&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="s2">&quot;handleheight&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                <span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
            <span class="p">}</span>

        <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">default_legend_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">scl_data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_handles</span><span class="p">,</span> <span class="n">class_names</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_handles</span><span class="p">,</span> <span class="n">class_names</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span>

        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="k">if</span> <span class="n">scl_data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">f</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">search_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to search the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Choose the catalog URL based on catalog_choice</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">==</span> <span class="s2">&quot;planetarycomputer&quot;</span><span class="p">:</span>
            <span class="n">catalog_url</span> <span class="o">=</span> <span class="s2">&quot;https://planetarycomputer.microsoft.com/api/stac/v1&quot;</span>
            <span class="n">catalog</span> <span class="o">=</span> <span class="n">pystac_client</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                <span class="n">catalog_url</span><span class="p">,</span> <span class="n">modifier</span><span class="o">=</span><span class="n">planetary_computer</span><span class="o">.</span><span class="n">sign_inplace</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">==</span> <span class="s2">&quot;earthsearch&quot;</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AWS_REGION&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;us-west-2&quot;</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;GDAL_DISABLE_READDIR_ON_OPEN&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;EMPTY_DIR&quot;</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AWS_NO_SIGN_REQUEST&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;YES&quot;</span>
            <span class="n">catalog_url</span> <span class="o">=</span> <span class="s2">&quot;https://earth-search.aws.element84.com/v1&quot;</span>
            <span class="n">catalog</span> <span class="o">=</span> <span class="n">pystac_client</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">catalog_url</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Invalid catalog_choice. Choose either &#39;planetarycomputer&#39; or &#39;earthsearch&#39;.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Search for items within the specified bbox and date range</span>
        <span class="n">search</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
            <span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="p">],</span>
            <span class="n">bbox</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
            <span class="n">datetime</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="n">search</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data searched. Access the returned seach with the .search attribute.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to get the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Prepare the parameters for odc.stac.load</span>
        <span class="n">load_params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
            <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
            <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="s2">&quot;groupby&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="p">,</span>
            <span class="s2">&quot;stac_cfg&quot;</span><span class="p">:</span> <span class="n">get_stac_cfg</span><span class="p">(</span><span class="n">sensor</span><span class="o">=</span><span class="s2">&quot;sentinel-2-l2a&quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span><span class="p">:</span>
            <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="p">:</span>
            <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span>

        <span class="c1"># Load the data lazily using odc.stac</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">odc</span><span class="o">.</span><span class="n">stac</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="o">**</span><span class="n">load_params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;band_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;scl_class_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span>

        <span class="k">if</span> <span class="s2">&quot;scl&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;scl_class_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span>

        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Data retrieved. Access with the .data attribute. Data CRS: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">estimate_utm_crs</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to get the metadata.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">stac_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">item_collection_as_dict</span><span class="p">()</span>
        <span class="n">metadata_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_features</span><span class="p">(</span><span class="n">stac_json</span><span class="p">,</span> <span class="s2">&quot;epsg:4326&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">==</span> <span class="s2">&quot;earthsearch&quot;</span><span class="p">:</span>
            <span class="n">metadata_gdf</span><span class="p">[</span><span class="s2">&quot;s2:mgrs_tile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">metadata_gdf</span><span class="p">[</span><span class="s2">&quot;mgrs:utm_zone&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">metadata_gdf</span><span class="p">[</span><span class="s2">&quot;mgrs:latitude_band&quot;</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">metadata_gdf</span><span class="p">[</span><span class="s2">&quot;mgrs:grid_square&quot;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata_gdf</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Metadata retrieved. Access with the .metadata attribute.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_nodata_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to remove no data values from the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_removed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
            <span class="n">nodata_value</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">nodata_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodata&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nodata_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1">#print(f&quot;Removing nodata {nodata_value} values for band {band}...&quot;)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nodata_value</span><span class="p">)</span>
                <span class="n">data_removed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">data_removed</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nodata values removed from the data. In doing so, all bands converted to float32. To turn this behavior off, set remove_nodata=False.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tried to remove nodata values and set them to nans, but no nodata values found in the data.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">mask_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">remove_nodata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">remove_saturated_defective</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">remove_topo_shadows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">remove_cloud_shadows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">remove_vegetation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">remove_not_vegetated</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">remove_water</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">remove_unclassified</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">remove_medium_prob_clouds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">remove_high_prob_clouds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">remove_thin_cirrus_clouds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">remove_snow_ice</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to mask the data.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            remove_nodata (bool): Whether to remove no data pixels.</span>
<span class="sd">            remove_saturated_defective (bool): Whether to remove saturated or defective pixels.</span>
<span class="sd">            remove_topo_shadows (bool): Whether to remove topographic shadow pixels.</span>
<span class="sd">            remove_cloud_shadows (bool): Whether to remove cloud shadow pixels.</span>
<span class="sd">            remove_vegetation (bool): Whether to remove vegetation pixels.</span>
<span class="sd">            remove_not_vegetated (bool): Whether to remove not vegetated pixels.</span>
<span class="sd">            remove_water (bool): Whether to remove water pixels.</span>
<span class="sd">            remove_unclassified (bool): Whether to remove unclassified pixels.</span>
<span class="sd">            remove_medium_prob_clouds (bool): Whether to remove medium probability cloud pixels.</span>
<span class="sd">            remove_high_prob_clouds (bool): Whether to remove high probability cloud pixels.</span>
<span class="sd">            remove_thin_cirrus_clouds (bool): Whether to remove thin cirrus cloud pixels.</span>
<span class="sd">            remove_snow_ice (bool): Whether to remove snow or ice pixels.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Mask the data based on the Scene Classification (SCL) band (see definitions above)</span>
        <span class="n">mask_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">remove_nodata</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_saturated_defective</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_topo_shadows</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_cloud_shadows</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_vegetation</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_not_vegetated</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_water</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_unclassified</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_medium_prob_clouds</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_high_prob_clouds</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_thin_cirrus_clouds</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_snow_ice</span><span class="p">:</span>
            <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removed pixels with the following scene classification values:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">mask_list</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span><span class="p">[</span><span class="n">val</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

        <span class="n">scl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">scl</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">scl</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">mask_list</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">harmonize_to_old_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Harmonize new Sentinel-2 data to the old baseline.</span>
<span class="sd">        Adapted from: https://planetarycomputer.microsoft.com/dataset/sentinel-2-l2a#Baseline-Change</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        harmonized: xarray.Dataset</span>
<span class="sd">            A Dataset with all values harmonized to the old</span>
<span class="sd">            processing baseline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cutoff</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">1000</span>
        <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;B01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;B02&quot;</span><span class="p">,</span>
            <span class="s2">&quot;B03&quot;</span><span class="p">,</span>
            <span class="s2">&quot;B04&quot;</span><span class="p">,</span>
            <span class="s2">&quot;B05&quot;</span><span class="p">,</span>
            <span class="s2">&quot;B06&quot;</span><span class="p">,</span>
            <span class="s2">&quot;B07&quot;</span><span class="p">,</span>
            <span class="s2">&quot;B08&quot;</span><span class="p">,</span>
            <span class="s2">&quot;B8A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;B09&quot;</span><span class="p">,</span>
            <span class="s2">&quot;B11&quot;</span><span class="p">,</span>
            <span class="s2">&quot;B12&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">band_info</span><span class="p">[</span><span class="n">band</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">bands</span><span class="p">]</span>
        <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">))</span>

        <span class="n">to_process</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_vars</span><span class="p">))</span>
        <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">cutoff</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">to_process</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">new</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
                <span class="n">new</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span><span class="p">[</span><span class="n">band</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Data acquired after January 25th, 2022 harmonized to old baseline. To override this behavior, set harmonize_to_old=False.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">scale_data_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to scale the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
            <span class="n">scale_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scale&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">scale_factor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">scale_factor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">band</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>

            <span class="n">scale_factor</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">scale_factor</span><span class="p">)</span> <span class="k">if</span> <span class="n">scale_factor</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale_factor</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">*</span> <span class="n">scale_factor</span>

        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Data scaled to float reflectance. To turn this behavior off, set scale_data=False.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percentile_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lower&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span> <span class="mi">98</span><span class="p">},</span> <span class="n">clahe_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;clip_limit&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;nbins&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span> <span class="s1">&#39;kernel_size&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve RGB data with optional percentile-based contrast stretching and CLAHE enhancement.</span>

<span class="sd">        This method calculates and stores three versions of RGB data: raw, percentile-stretched, and CLAHE-enhanced.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        percentile_kwargs : dict, optional</span>
<span class="sd">            Parameters for percentile-based contrast stretching. Keys are:</span>
<span class="sd">            - &#39;lower&#39;: Lower percentile for contrast stretching (default: 2)</span>
<span class="sd">            - &#39;upper&#39;: Upper percentile for contrast stretching (default: 98)</span>
<span class="sd">        clahe_kwargs : dict, optional</span>
<span class="sd">            Parameters for CLAHE enhancement. Keys are:</span>
<span class="sd">            - &#39;clip_limit&#39;: Clipping limit for CLAHE (default: 0.03)</span>
<span class="sd">            - &#39;nbins&#39;: Number of bins for CLAHE histogram (default: 256)</span>
<span class="sd">            - &#39;kernel_size&#39;: Size of kernel for CLAHE (default: None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            The method stores results in instance attributes.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Results are stored in the following attributes:</span>
<span class="sd">        - .rgb: Raw RGB data</span>
<span class="sd">        - .rgb_percentile: Percentile-stretched RGB data</span>
<span class="sd">        - .rgb_clahe: CLAHE-enhanced RGB data</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rgba_da</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">odc</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">bands</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">),</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rgba</span> <span class="o">=</span> <span class="n">rgba_da</span>

        <span class="n">rgb_da</span> <span class="o">=</span> <span class="n">rgba_da</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">band</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1">#.where(self.data.scl&gt;=0, other=255) if we want to make no data white</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">rgb_da</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rgb_percentile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rgb_percentile</span><span class="p">(</span><span class="o">**</span><span class="n">percentile_kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rgb_clahe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rgb_clahe</span><span class="p">(</span><span class="o">**</span><span class="n">clahe_kwargs</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RGB data retrieved.</span><span class="se">\n</span><span class="s2">Access with the following attributes:</span><span class="se">\n</span><span class="s2">.rgb for raw RGB,</span><span class="se">\n</span><span class="s2">.rgba for RGBA,</span><span class="se">\n</span><span class="s2">.rgb_percentile for percentile RGB,</span><span class="se">\n</span><span class="s2">.rgb_clahe for CLAHE RGB.</span><span class="se">\n</span><span class="s2">You can pass in percentile_kwargs and clahe_kwargs to adjust RGB calculations, check documentation for options.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_rgb_percentile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">percentile_kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply percentile-based contrast stretching to the RGB bands of the Sentinel-2 data.</span>

<span class="sd">        This function creates a new DataArray with the contrast-stretched RGB bands.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments for percentile calculation. Supported keys:</span>
<span class="sd">            - &#39;lower&#39;: Lower percentile for contrast stretching (default: 2)</span>
<span class="sd">            - &#39;upper&#39;: Upper percentile for contrast stretching (default: 98)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        xarray.DataArray</span>
<span class="sd">            RGB data with percentile-based contrast stretching applied.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The function clips values to the range [0, 1] and masks areas where SCL &lt; 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lower_percentile</span> <span class="o">=</span> <span class="n">percentile_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">upper_percentile</span> <span class="o">=</span> <span class="n">percentile_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="mi">98</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">stretch_percentile</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
            <span class="n">p_low</span><span class="p">,</span> <span class="n">p_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="p">[</span><span class="n">lower_percentile</span><span class="p">,</span> <span class="n">upper_percentile</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">da</span> <span class="o">-</span> <span class="n">p_low</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p_high</span> <span class="o">-</span> <span class="n">p_low</span><span class="p">)</span>

        <span class="n">rgb_da</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span>

        <span class="n">template</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">rgb_da</span><span class="p">)</span>
        <span class="n">rgb_percentile_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">map_blocks</span><span class="p">(</span><span class="n">stretch_percentile</span><span class="p">,</span> <span class="n">rgb_da</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">)</span>
        <span class="n">rgb_percentile_da</span> <span class="o">=</span> <span class="n">rgb_percentile_da</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rgb_percentile_da</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_rgb_clahe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply Contrast Limited Adaptive Histogram Equalization (CLAHE) to RGB bands.</span>

<span class="sd">        This function creates a new DataArray with CLAHE applied to the RGB bands.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments for CLAHE. Supported keys:</span>
<span class="sd">            - &#39;clip_limit&#39;: Clipping limit for CLAHE (default: 0.03)</span>
<span class="sd">            - &#39;nbins&#39;: Number of bins for CLAHE histogram (default: 256)</span>
<span class="sd">            - &#39;kernel_size&#39;: Size of kernel for CLAHE (default: None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        xarray.DataArray</span>
<span class="sd">            RGB data with CLAHE enhancement applied.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The function applies CLAHE to each band separately and masks areas where SCL &lt; 0.</span>
<span class="sd">        https://scikit-image.org/docs/stable/api/skimage.exposure.html#skimage.exposure.equalize_adapthist</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Custom wrapper to preserve xarray metadata</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">equalize_adapthist_da</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="c1"># Apply the CLAHE function from skimage</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">exposure</span><span class="o">.</span><span class="n">equalize_adapthist</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1">#new_coords = {k: v for k, v in da.coords.items() if k != &#39;band&#39; or len(v) == 3}</span>

            <span class="c1"># Convert the result back to a DataArray, preserving the original metadata</span>
            <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>

        <span class="n">rgb_da</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span>

        <span class="c1">#template = rgb_da.copy(data=np.empty_like(rgb_da).data)</span>
        <span class="n">template</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">rgb_da</span><span class="p">)</span>
        <span class="n">rgb_clahe_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">map_blocks</span><span class="p">(</span><span class="n">equalize_adapthist_da</span><span class="p">,</span> <span class="n">rgb_da</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">rgb_clahe_da</span> <span class="o">=</span> <span class="n">rgb_clahe_da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rgb_clahe_da</span>

    <span class="c1"># Indicies</span>
    <span class="c1"># find indicies Sentinel-2 indicies here: https://www.indexdatabase.de/db/is.php?sensor_id=96 and https://custom-scripts.sentinel-hub.com/custom-scripts/sentinel/sentinel-2/</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ndvi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to get the NDVI data.</span>
<span class="sd">        S2 NDVI definition: (B08 - B04) / (B08 + B04) [https://www.indexdatabase.de/db/i-single.php?id=58]</span>

<span class="sd">        Returns:</span>
<span class="sd">            ndvi_da (xarray.DataArray): The NDVI data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">red</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">red</span>
        <span class="n">nir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">nir</span>
        <span class="n">ndvi_da</span> <span class="o">=</span> <span class="p">(</span><span class="n">nir</span> <span class="o">-</span> <span class="n">red</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nir</span> <span class="o">+</span> <span class="n">red</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ndvi</span> <span class="o">=</span> <span class="n">ndvi_da</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NDVI data calculated. Access with the .ndvi attribute.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ndsi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to get the NDSI data.</span>
<span class="sd">        S2 NDSI definition: (B03 - B11) / (B03 + B11)</span>

<span class="sd">        Returns:</span>
<span class="sd">            ndsi_da (xarray.DataArray): The NDSI data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">green</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">green</span>
        <span class="n">swir16</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">swir16</span>
        <span class="n">ndsi_da</span> <span class="o">=</span> <span class="p">(</span><span class="n">green</span> <span class="o">-</span> <span class="n">swir16</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">green</span> <span class="o">+</span> <span class="n">swir16</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ndsi</span> <span class="o">=</span> <span class="n">ndsi_da</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NDSI data calculated. Access with the .ndsi attribute.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ndwi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to get the NDWI data.</span>
<span class="sd">        S2 NDWI definition: (B03 - B08) / (B03 + B08)</span>

<span class="sd">        Returns:</span>
<span class="sd">            ndwi_da (xarray.DataArray): The NDWI data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">green</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">green</span>
        <span class="n">nir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">nir</span>
        <span class="n">ndwi_da</span> <span class="o">=</span> <span class="p">(</span><span class="n">green</span> <span class="o">-</span> <span class="n">nir</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">green</span> <span class="o">+</span> <span class="n">nir</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ndwi</span> <span class="o">=</span> <span class="n">ndwi_da</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NDWI data calculated. Access with the .ndwi attribute.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_evi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to get the EVI data.</span>
<span class="sd">        S2 EVI definition: 2.5 * (B08 - B04) / (B08 + 6 * B04 - 7.5 * B02 + 1) [https://www.indexdatabase.de/db/si-single.php?sensor_id=96&amp;rsindex_id=16]</span>

<span class="sd">        Returns:</span>
<span class="sd">            xarray.DataArray: The EVI data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">red</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">red</span>
        <span class="n">nir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">nir</span>
        <span class="n">blue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">blue</span>

        <span class="n">evi_da</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">nir</span> <span class="o">-</span> <span class="n">red</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nir</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">red</span> <span class="o">-</span> <span class="mf">7.5</span> <span class="o">*</span> <span class="n">blue</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">evi</span> <span class="o">=</span> <span class="n">evi_da</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EVI data calculated. Access with the .evi attribute.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ndbi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method to get the NDBI data.</span>
<span class="sd">        S2 NDBI definition: (B08 - B12) / (B08 + B12)</span>

<span class="sd">        Returns:</span>
<span class="sd">            xarray.DataArray: The NDBI data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">nir</span>
        <span class="n">swir22</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">swir22</span>
        <span class="n">ndbi_da</span> <span class="o">=</span> <span class="p">(</span><span class="n">nir</span> <span class="o">-</span> <span class="n">swir22</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nir</span> <span class="o">+</span> <span class="n">swir22</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ndbi</span> <span class="o">=</span> <span class="n">ndbi_da</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NDBI data calculated. Access with the .ndbi attribute.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bbox_input</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2014-01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2025-03-03&#39;</span><span class="p">,</span> <span class="n">catalog_choice</span><span class="o">=</span><span class="s1">&#39;planetarycomputer&#39;</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s1">&#39;sentinel-2-l2a&#39;</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_nodata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">harmonize_to_old</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s1">&#39;solar_day&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#easysnowdata.remote_sensing.Sentinel2.__init__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The constructor for the Sentinel2 class.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox_input</code></td>
        <td><code>geopandas.GeoDataFrame or tuple or Shapely Geometry</code></td>
        <td><p>GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date for the data in the format 'YYYY-MM-DD'. Default is '2014-01-01'.</p></td>
        <td><code>&#39;2014-01-01&#39;</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date for the data in the format 'YYYY-MM-DD'. Default is today's date.</p></td>
        <td><code>&#39;2025-03-03&#39;</code></td>
      </tr>
      <tr>
        <td><code>catalog_choice</code></td>
        <td><code>str</code></td>
        <td><p>The catalog choice for the data. Can choose between 'planetarycomputer' and 'earthsearch', default is 'planetarycomputer'.</p></td>
        <td><code>&#39;planetarycomputer&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>The bands to be used. Default is all bands. Must include SCL for data masking. Each band should be a string like 'B01', 'B02', etc.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>resolution</code></td>
        <td><code>str</code></td>
        <td><p>The resolution of the data. Defaults to native resolution, 10m.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system. This should be a string like 'EPSG:4326'. Default CRS is UTM zone estimated from bounding box.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>groupby</code></td>
        <td><code>str</code></td>
        <td><p>The groupby parameter for the data. Default is "solar_day".</p></td>
        <td><code>&#39;solar_day&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">bbox_input</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2014-01-01&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="n">today</span><span class="p">,</span>
    <span class="n">catalog_choice</span><span class="o">=</span><span class="s2">&quot;planetarycomputer&quot;</span><span class="p">,</span>
    <span class="n">collection</span><span class="o">=</span> <span class="s2">&quot;sentinel-2-l2a&quot;</span><span class="p">,</span> <span class="c1"># could also choose &quot;sentinel-2-c1-l2a&quot; once published to https://github.com/Element84/earth-search</span>
    <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">remove_nodata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">harmonize_to_old</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">scale_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">groupby</span><span class="o">=</span><span class="s2">&quot;solar_day&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The constructor for the Sentinel2 class.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        bbox_input (geopandas.GeoDataFrame or tuple or Shapely Geometry): GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">        start_date (str): The start date for the data in the format &#39;YYYY-MM-DD&#39;. Default is &#39;2014-01-01&#39;.</span>
<span class="sd">        end_date (str): The end date for the data in the format &#39;YYYY-MM-DD&#39;. Default is today&#39;s date.</span>
<span class="sd">        catalog_choice (str): The catalog choice for the data. Can choose between &#39;planetarycomputer&#39; and &#39;earthsearch&#39;, default is &#39;planetarycomputer&#39;.</span>
<span class="sd">        bands (list): The bands to be used. Default is all bands. Must include SCL for data masking. Each band should be a string like &#39;B01&#39;, &#39;B02&#39;, etc.</span>
<span class="sd">        resolution (str): The resolution of the data. Defaults to native resolution, 10m.</span>
<span class="sd">        crs (str): The coordinate reference system. This should be a string like &#39;EPSG:4326&#39;. Default CRS is UTM zone estimated from bounding box.</span>
<span class="sd">        groupby (str): The groupby parameter for the data. Default is &quot;solar_day&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize the attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span> <span class="o">=</span> <span class="n">bbox_input</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_date</span> <span class="o">=</span> <span class="n">start_date</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span> <span class="o">=</span> <span class="n">end_date</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">=</span> <span class="n">catalog_choice</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">collection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bands</span> <span class="o">=</span> <span class="n">bands</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">resolution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">remove_nodata</span> <span class="o">=</span> <span class="n">remove_nodata</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old</span> <span class="o">=</span> <span class="n">harmonize_to_old</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scale_data</span> <span class="o">=</span> <span class="n">scale_data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span> <span class="o">=</span> <span class="n">groupby</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span> <span class="o">=</span> <span class="n">convert_bbox_to_geodataframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_input</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">estimate_utm_crs</span><span class="p">()</span>

    <span class="c1"># Define the band information</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;B01&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;coastal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Coastal aerosol, 442.7 nm (S2A), 442.3 nm (S2B)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;60m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;B02&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Blue, 492.4 nm (S2A), 492.1 nm (S2B)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;B03&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Green, 559.8 nm (S2A), 559.0 nm (S2B)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;B04&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Red, 664.6 nm (S2A), 665.0 nm (S2B)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;B05&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;rededge&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Vegetation red edge, 704.1 nm (S2A), 703.8 nm (S2B)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;B06&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;rededge2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Vegetation red edge, 740.5 nm (S2A), 739.1 nm (S2B)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;B07&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;rededge3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Vegetation red edge, 782.8 nm (S2A), 779.7 nm (S2B)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;B08&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;nir&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;NIR, 832.8 nm (S2A), 833.0 nm (S2B)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;B8A&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;nir08&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Narrow NIR, 864.7 nm (S2A), 864.0 nm (S2B)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;B09&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;nir09&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Water vapour, 945.1 nm (S2A), 943.2 nm (S2B)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;60m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;B11&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;swir16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;SWIR, 1613.7 nm (S2A), 1610.4 nm (S2B)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;B12&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;swir22&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;SWIR, 2202.4 nm (S2A), 2185.7 nm (S2B)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;AOT&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;aot&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Aerosol Optical Thickness map, based on Sen2Cor processor&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;SCL&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;scl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Scene classification data, based on Sen2Cor processor&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;WVP&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;wvp&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Water Vapour map&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;visual&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;visual&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;True color image&quot;</span><span class="p">,</span>
            <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0001&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>

    <span class="c1"># Define the scene classification information, classes here: https://custom-scripts.sentinel-hub.com/custom-scripts/sentinel-2/scene-classification/</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;No Data (Missing data)&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">},</span>
        <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Saturated or defective pixel&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ff0000&quot;</span><span class="p">},</span>
        <span class="mi">2</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Topographic casted shadows&quot;</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#2f2f2f&quot;</span><span class="p">,</span>
        <span class="p">},</span>  <span class="c1"># (called &#39;Dark features/Shadows&#39; for data before 2022-01-25)</span>
        <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cloud shadows&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#643200&quot;</span><span class="p">},</span>
        <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Vegetation&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#00a000&quot;</span><span class="p">},</span>
        <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Not-vegetated&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ffe65a&quot;</span><span class="p">},</span>
        <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Water&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#0000ff&quot;</span><span class="p">},</span>
        <span class="mi">7</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Unclassified&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#808080&quot;</span><span class="p">},</span>
        <span class="mi">8</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cloud medium probability&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#c0c0c0&quot;</span><span class="p">},</span>
        <span class="mi">9</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cloud high probability&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">},</span>
        <span class="mi">10</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Thin cirrus&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#64c8ff&quot;</span><span class="p">},</span>
        <span class="mi">11</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Snow or ice&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ff96ff&quot;</span><span class="p">},</span>
    <span class="p">}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">scl_cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span>
        <span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
    <span class="p">)</span>

    <span class="c1"># Initialize the data attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rgba</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rgb_clahe</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rgb_percentile</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ndvi</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ndsi</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ndwi</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">evi</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ndbi</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">search_data</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_nodata</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_nodata_inplace</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">==</span> <span class="s2">&quot;planetarycomputer&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">==</span> <span class="s2">&quot;sentinel-2-c1-l2a&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">==</span> <span class="s2">&quot;sentinel-2-l2a&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Since </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span><span class="si">}</span><span class="s2"> is used, harmonization step is not needed.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown collection: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">harmonize_to_old_inplace</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_data</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_data_inplace</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>



    <span class="c1"># Add the plot_scl method as an attribute to the SCL data variable</span>
    <span class="k">if</span> <span class="s1">&#39;scl&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;example_plot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_scl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;class_info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scl_cmap</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.get_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.get_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to get the data.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to get the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Prepare the parameters for odc.stac.load</span>
    <span class="n">load_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
        <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
        <span class="s2">&quot;nodata&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="s2">&quot;groupby&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="p">,</span>
        <span class="s2">&quot;stac_cfg&quot;</span><span class="p">:</span> <span class="n">get_stac_cfg</span><span class="p">(</span><span class="n">sensor</span><span class="o">=</span><span class="s2">&quot;sentinel-2-l2a&quot;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span><span class="p">:</span>
        <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bands</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;bands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="p">:</span>
        <span class="n">load_params</span><span class="p">[</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span>

    <span class="c1"># Load the data lazily using odc.stac</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">odc</span><span class="o">.</span><span class="n">stac</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="o">**</span><span class="n">load_params</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;band_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;scl_class_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span>

    <span class="k">if</span> <span class="s2">&quot;scl&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;scl_class_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Data retrieved. Access with the .data attribute. Data CRS: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">estimate_utm_crs</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.get_evi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_evi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.get_evi" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to get the EVI data.</p>
<p>S2 EVI definition: 2.5 * (B08 - B04) / (B08 + 6 * B04 - 7.5 * B02 + 1) [https://www.indexdatabase.de/db/si-single.php?sensor_id=96&amp;rsindex_id=16]</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>xarray.DataArray</code></td>
      <td><p>The EVI data.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_evi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to get the EVI data.</span>
<span class="sd">    S2 EVI definition: 2.5 * (B08 - B04) / (B08 + 6 * B04 - 7.5 * B02 + 1) [https://www.indexdatabase.de/db/si-single.php?sensor_id=96&amp;rsindex_id=16]</span>

<span class="sd">    Returns:</span>
<span class="sd">        xarray.DataArray: The EVI data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">red</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">red</span>
    <span class="n">nir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">nir</span>
    <span class="n">blue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">blue</span>

    <span class="n">evi_da</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">nir</span> <span class="o">-</span> <span class="n">red</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nir</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">red</span> <span class="o">-</span> <span class="mf">7.5</span> <span class="o">*</span> <span class="n">blue</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">evi</span> <span class="o">=</span> <span class="n">evi_da</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EVI data calculated. Access with the .evi attribute.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.get_metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.get_metadata" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to get the metadata.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to get the metadata.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">stac_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">item_collection_as_dict</span><span class="p">()</span>
    <span class="n">metadata_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_features</span><span class="p">(</span><span class="n">stac_json</span><span class="p">,</span> <span class="s2">&quot;epsg:4326&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">==</span> <span class="s2">&quot;earthsearch&quot;</span><span class="p">:</span>
        <span class="n">metadata_gdf</span><span class="p">[</span><span class="s2">&quot;s2:mgrs_tile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">metadata_gdf</span><span class="p">[</span><span class="s2">&quot;mgrs:utm_zone&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">metadata_gdf</span><span class="p">[</span><span class="s2">&quot;mgrs:latitude_band&quot;</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">metadata_gdf</span><span class="p">[</span><span class="s2">&quot;mgrs:grid_square&quot;</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata_gdf</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Metadata retrieved. Access with the .metadata attribute.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.get_ndbi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_ndbi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.get_ndbi" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to get the NDBI data.</p>
<p>S2 NDBI definition: (B08 - B12) / (B08 + B12)</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>xarray.DataArray</code></td>
      <td><p>The NDBI data.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_ndbi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to get the NDBI data.</span>
<span class="sd">    S2 NDBI definition: (B08 - B12) / (B08 + B12)</span>

<span class="sd">    Returns:</span>
<span class="sd">        xarray.DataArray: The NDBI data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">nir</span>
    <span class="n">swir22</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">swir22</span>
    <span class="n">ndbi_da</span> <span class="o">=</span> <span class="p">(</span><span class="n">nir</span> <span class="o">-</span> <span class="n">swir22</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nir</span> <span class="o">+</span> <span class="n">swir22</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ndbi</span> <span class="o">=</span> <span class="n">ndbi_da</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NDBI data calculated. Access with the .ndbi attribute.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.get_ndsi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_ndsi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.get_ndsi" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to get the NDSI data.</p>
<p>S2 NDSI definition: (B03 - B11) / (B03 + B11)</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>ndsi_da (xarray.DataArray): The NDSI data.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_ndsi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to get the NDSI data.</span>
<span class="sd">    S2 NDSI definition: (B03 - B11) / (B03 + B11)</span>

<span class="sd">    Returns:</span>
<span class="sd">        ndsi_da (xarray.DataArray): The NDSI data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">green</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">green</span>
    <span class="n">swir16</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">swir16</span>
    <span class="n">ndsi_da</span> <span class="o">=</span> <span class="p">(</span><span class="n">green</span> <span class="o">-</span> <span class="n">swir16</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">green</span> <span class="o">+</span> <span class="n">swir16</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ndsi</span> <span class="o">=</span> <span class="n">ndsi_da</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NDSI data calculated. Access with the .ndsi attribute.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.get_ndvi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_ndvi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.get_ndvi" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to get the NDVI data.</p>
<p>S2 NDVI definition: (B08 - B04) / (B08 + B04) [https://www.indexdatabase.de/db/i-single.php?id=58]</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>ndvi_da (xarray.DataArray): The NDVI data.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_ndvi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to get the NDVI data.</span>
<span class="sd">    S2 NDVI definition: (B08 - B04) / (B08 + B04) [https://www.indexdatabase.de/db/i-single.php?id=58]</span>

<span class="sd">    Returns:</span>
<span class="sd">        ndvi_da (xarray.DataArray): The NDVI data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">red</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">red</span>
    <span class="n">nir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">nir</span>
    <span class="n">ndvi_da</span> <span class="o">=</span> <span class="p">(</span><span class="n">nir</span> <span class="o">-</span> <span class="n">red</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nir</span> <span class="o">+</span> <span class="n">red</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ndvi</span> <span class="o">=</span> <span class="n">ndvi_da</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NDVI data calculated. Access with the .ndvi attribute.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.get_ndwi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_ndwi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.get_ndwi" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to get the NDWI data.</p>
<p>S2 NDWI definition: (B03 - B08) / (B03 + B08)</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>ndwi_da (xarray.DataArray): The NDWI data.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_ndwi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to get the NDWI data.</span>
<span class="sd">    S2 NDWI definition: (B03 - B08) / (B03 + B08)</span>

<span class="sd">    Returns:</span>
<span class="sd">        ndwi_da (xarray.DataArray): The NDWI data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">green</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">green</span>
    <span class="n">nir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">nir</span>
    <span class="n">ndwi_da</span> <span class="o">=</span> <span class="p">(</span><span class="n">green</span> <span class="o">-</span> <span class="n">nir</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">green</span> <span class="o">+</span> <span class="n">nir</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ndwi</span> <span class="o">=</span> <span class="n">ndwi_da</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NDWI data calculated. Access with the .ndwi attribute.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.get_rgb" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percentile_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lower&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span> <span class="mi">98</span><span class="p">},</span> <span class="n">clahe_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;clip_limit&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;nbins&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span> <span class="s1">&#39;kernel_size&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.get_rgb" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Retrieve RGB data with optional percentile-based contrast stretching and CLAHE enhancement.</p>
<p>This method calculates and stores three versions of RGB data: raw, percentile-stretched, and CLAHE-enhanced.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>percentile_kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Parameters for percentile-based contrast stretching. Keys are:
- 'lower': Lower percentile for contrast stretching (default: 2)
- 'upper': Upper percentile for contrast stretching (default: 98)</p></td>
        <td><code>{&#39;lower&#39;: 2, &#39;upper&#39;: 98}</code></td>
      </tr>
      <tr>
        <td><code>clahe_kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Parameters for CLAHE enhancement. Keys are:
- 'clip_limit': Clipping limit for CLAHE (default: 0.03)
- 'nbins': Number of bins for CLAHE histogram (default: 256)
- 'kernel_size': Size of kernel for CLAHE (default: None)</p></td>
        <td><code>{&#39;clip_limit&#39;: 0.03, &#39;nbins&#39;: 256, &#39;kernel_size&#39;: None}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>None</code></td>
      <td><p>The method stores results in instance attributes.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percentile_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lower&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span> <span class="mi">98</span><span class="p">},</span> <span class="n">clahe_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;clip_limit&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;nbins&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span> <span class="s1">&#39;kernel_size&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve RGB data with optional percentile-based contrast stretching and CLAHE enhancement.</span>

<span class="sd">    This method calculates and stores three versions of RGB data: raw, percentile-stretched, and CLAHE-enhanced.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    percentile_kwargs : dict, optional</span>
<span class="sd">        Parameters for percentile-based contrast stretching. Keys are:</span>
<span class="sd">        - &#39;lower&#39;: Lower percentile for contrast stretching (default: 2)</span>
<span class="sd">        - &#39;upper&#39;: Upper percentile for contrast stretching (default: 98)</span>
<span class="sd">    clahe_kwargs : dict, optional</span>
<span class="sd">        Parameters for CLAHE enhancement. Keys are:</span>
<span class="sd">        - &#39;clip_limit&#39;: Clipping limit for CLAHE (default: 0.03)</span>
<span class="sd">        - &#39;nbins&#39;: Number of bins for CLAHE histogram (default: 256)</span>
<span class="sd">        - &#39;kernel_size&#39;: Size of kernel for CLAHE (default: None)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">        The method stores results in instance attributes.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Results are stored in the following attributes:</span>
<span class="sd">    - .rgb: Raw RGB data</span>
<span class="sd">    - .rgb_percentile: Percentile-stretched RGB data</span>
<span class="sd">    - .rgb_clahe: CLAHE-enhanced RGB data</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rgba_da</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">odc</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">bands</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">),</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.7</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rgba</span> <span class="o">=</span> <span class="n">rgba_da</span>

    <span class="n">rgb_da</span> <span class="o">=</span> <span class="n">rgba_da</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">band</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1">#.where(self.data.scl&gt;=0, other=255) if we want to make no data white</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">rgb_da</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">rgb_percentile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rgb_percentile</span><span class="p">(</span><span class="o">**</span><span class="n">percentile_kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rgb_clahe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rgb_clahe</span><span class="p">(</span><span class="o">**</span><span class="n">clahe_kwargs</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RGB data retrieved.</span><span class="se">\n</span><span class="s2">Access with the following attributes:</span><span class="se">\n</span><span class="s2">.rgb for raw RGB,</span><span class="se">\n</span><span class="s2">.rgba for RGBA,</span><span class="se">\n</span><span class="s2">.rgb_percentile for percentile RGB,</span><span class="se">\n</span><span class="s2">.rgb_clahe for CLAHE RGB.</span><span class="se">\n</span><span class="s2">You can pass in percentile_kwargs and clahe_kwargs to adjust RGB calculations, check documentation for options.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.get_rgb_clahe" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_rgb_clahe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.get_rgb_clahe" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Apply Contrast Limited Adaptive Histogram Equalization (CLAHE) to RGB bands.</p>
<p>This function creates a new DataArray with CLAHE applied to the RGB bands.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword arguments for CLAHE. Supported keys:
- 'clip_limit': Clipping limit for CLAHE (default: 0.03)
- 'nbins': Number of bins for CLAHE histogram (default: 256)
- 'kernel_size': Size of kernel for CLAHE (default: None)</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>xarray.DataArray</code></td>
      <td><p>RGB data with CLAHE enhancement applied.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_rgb_clahe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply Contrast Limited Adaptive Histogram Equalization (CLAHE) to RGB bands.</span>

<span class="sd">    This function creates a new DataArray with CLAHE applied to the RGB bands.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Keyword arguments for CLAHE. Supported keys:</span>
<span class="sd">        - &#39;clip_limit&#39;: Clipping limit for CLAHE (default: 0.03)</span>
<span class="sd">        - &#39;nbins&#39;: Number of bins for CLAHE histogram (default: 256)</span>
<span class="sd">        - &#39;kernel_size&#39;: Size of kernel for CLAHE (default: None)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xarray.DataArray</span>
<span class="sd">        RGB data with CLAHE enhancement applied.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The function applies CLAHE to each band separately and masks areas where SCL &lt; 0.</span>
<span class="sd">    https://scikit-image.org/docs/stable/api/skimage.exposure.html#skimage.exposure.equalize_adapthist</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Custom wrapper to preserve xarray metadata</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">equalize_adapthist_da</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Apply the CLAHE function from skimage</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">exposure</span><span class="o">.</span><span class="n">equalize_adapthist</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1">#new_coords = {k: v for k, v in da.coords.items() if k != &#39;band&#39; or len(v) == 3}</span>

        <span class="c1"># Convert the result back to a DataArray, preserving the original metadata</span>
        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>

    <span class="n">rgb_da</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span>

    <span class="c1">#template = rgb_da.copy(data=np.empty_like(rgb_da).data)</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">rgb_da</span><span class="p">)</span>
    <span class="n">rgb_clahe_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">map_blocks</span><span class="p">(</span><span class="n">equalize_adapthist_da</span><span class="p">,</span> <span class="n">rgb_da</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">rgb_clahe_da</span> <span class="o">=</span> <span class="n">rgb_clahe_da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rgb_clahe_da</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.get_rgb_percentile" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_rgb_percentile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">percentile_kwargs</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.get_rgb_percentile" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Apply percentile-based contrast stretching to the RGB bands of the Sentinel-2 data.</p>
<p>This function creates a new DataArray with the contrast-stretched RGB bands.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword arguments for percentile calculation. Supported keys:
- 'lower': Lower percentile for contrast stretching (default: 2)
- 'upper': Upper percentile for contrast stretching (default: 98)</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>xarray.DataArray</code></td>
      <td><p>RGB data with percentile-based contrast stretching applied.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_rgb_percentile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">percentile_kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply percentile-based contrast stretching to the RGB bands of the Sentinel-2 data.</span>

<span class="sd">    This function creates a new DataArray with the contrast-stretched RGB bands.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Keyword arguments for percentile calculation. Supported keys:</span>
<span class="sd">        - &#39;lower&#39;: Lower percentile for contrast stretching (default: 2)</span>
<span class="sd">        - &#39;upper&#39;: Upper percentile for contrast stretching (default: 98)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xarray.DataArray</span>
<span class="sd">        RGB data with percentile-based contrast stretching applied.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The function clips values to the range [0, 1] and masks areas where SCL &lt; 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lower_percentile</span> <span class="o">=</span> <span class="n">percentile_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">upper_percentile</span> <span class="o">=</span> <span class="n">percentile_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="mi">98</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stretch_percentile</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
        <span class="n">p_low</span><span class="p">,</span> <span class="n">p_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="p">[</span><span class="n">lower_percentile</span><span class="p">,</span> <span class="n">upper_percentile</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">da</span> <span class="o">-</span> <span class="n">p_low</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p_high</span> <span class="o">-</span> <span class="n">p_low</span><span class="p">)</span>

    <span class="n">rgb_da</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span>

    <span class="n">template</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">rgb_da</span><span class="p">)</span>
    <span class="n">rgb_percentile_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">map_blocks</span><span class="p">(</span><span class="n">stretch_percentile</span><span class="p">,</span> <span class="n">rgb_da</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">)</span>
    <span class="n">rgb_percentile_da</span> <span class="o">=</span> <span class="n">rgb_percentile_da</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rgb_percentile_da</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.harmonize_to_old_inplace" class="doc doc-heading">
<code class="highlight language-python"><span class="n">harmonize_to_old_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.harmonize_to_old_inplace" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Harmonize new Sentinel-2 data to the old baseline.</p>
<p>Adapted from: https://planetarycomputer.microsoft.com/dataset/sentinel-2-l2a#Baseline-Change</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>xarray.Dataset</code></td>
      <td><p>A Dataset with all values harmonized to the old
processing baseline.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">harmonize_to_old_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Harmonize new Sentinel-2 data to the old baseline.</span>
<span class="sd">    Adapted from: https://planetarycomputer.microsoft.com/dataset/sentinel-2-l2a#Baseline-Change</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    harmonized: xarray.Dataset</span>
<span class="sd">        A Dataset with all values harmonized to the old</span>
<span class="sd">        processing baseline.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cutoff</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;B01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;B02&quot;</span><span class="p">,</span>
        <span class="s2">&quot;B03&quot;</span><span class="p">,</span>
        <span class="s2">&quot;B04&quot;</span><span class="p">,</span>
        <span class="s2">&quot;B05&quot;</span><span class="p">,</span>
        <span class="s2">&quot;B06&quot;</span><span class="p">,</span>
        <span class="s2">&quot;B07&quot;</span><span class="p">,</span>
        <span class="s2">&quot;B08&quot;</span><span class="p">,</span>
        <span class="s2">&quot;B8A&quot;</span><span class="p">,</span>
        <span class="s2">&quot;B09&quot;</span><span class="p">,</span>
        <span class="s2">&quot;B11&quot;</span><span class="p">,</span>
        <span class="s2">&quot;B12&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">band_info</span><span class="p">[</span><span class="n">band</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">bands</span><span class="p">]</span>
    <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">))</span>

    <span class="n">to_process</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_vars</span><span class="p">))</span>
    <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">cutoff</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">to_process</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">new</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
            <span class="n">new</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span><span class="p">[</span><span class="n">band</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Data acquired after January 25th, 2022 harmonized to old baseline. To override this behavior, set harmonize_to_old=False.&quot;</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.mask_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mask_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remove_nodata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_saturated_defective</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_topo_shadows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_cloud_shadows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_vegetation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_not_vegetated</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_water</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_unclassified</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_medium_prob_clouds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_high_prob_clouds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_thin_cirrus_clouds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_snow_ice</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.mask_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to mask the data.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>remove_nodata</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove no data pixels.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>remove_saturated_defective</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove saturated or defective pixels.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>remove_topo_shadows</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove topographic shadow pixels.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>remove_cloud_shadows</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove cloud shadow pixels.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>remove_vegetation</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove vegetation pixels.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>remove_not_vegetated</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove not vegetated pixels.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>remove_water</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove water pixels.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>remove_unclassified</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove unclassified pixels.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>remove_medium_prob_clouds</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove medium probability cloud pixels.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>remove_high_prob_clouds</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove high probability cloud pixels.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>remove_thin_cirrus_clouds</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove thin cirrus cloud pixels.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>remove_snow_ice</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove snow or ice pixels.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mask_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">remove_nodata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_saturated_defective</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_topo_shadows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_cloud_shadows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_vegetation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">remove_not_vegetated</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">remove_water</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">remove_unclassified</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">remove_medium_prob_clouds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_high_prob_clouds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_thin_cirrus_clouds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_snow_ice</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to mask the data.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        remove_nodata (bool): Whether to remove no data pixels.</span>
<span class="sd">        remove_saturated_defective (bool): Whether to remove saturated or defective pixels.</span>
<span class="sd">        remove_topo_shadows (bool): Whether to remove topographic shadow pixels.</span>
<span class="sd">        remove_cloud_shadows (bool): Whether to remove cloud shadow pixels.</span>
<span class="sd">        remove_vegetation (bool): Whether to remove vegetation pixels.</span>
<span class="sd">        remove_not_vegetated (bool): Whether to remove not vegetated pixels.</span>
<span class="sd">        remove_water (bool): Whether to remove water pixels.</span>
<span class="sd">        remove_unclassified (bool): Whether to remove unclassified pixels.</span>
<span class="sd">        remove_medium_prob_clouds (bool): Whether to remove medium probability cloud pixels.</span>
<span class="sd">        remove_high_prob_clouds (bool): Whether to remove high probability cloud pixels.</span>
<span class="sd">        remove_thin_cirrus_clouds (bool): Whether to remove thin cirrus cloud pixels.</span>
<span class="sd">        remove_snow_ice (bool): Whether to remove snow or ice pixels.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Mask the data based on the Scene Classification (SCL) band (see definitions above)</span>
    <span class="n">mask_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">remove_nodata</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_saturated_defective</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_topo_shadows</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_cloud_shadows</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_vegetation</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_not_vegetated</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_water</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_unclassified</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_medium_prob_clouds</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_high_prob_clouds</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_thin_cirrus_clouds</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_snow_ice</span><span class="p">:</span>
        <span class="n">mask_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removed pixels with the following scene classification values:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">mask_list</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scl_class_info</span><span class="p">[</span><span class="n">val</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

    <span class="n">scl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scl</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">scl</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">scl</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">mask_list</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.remove_nodata_inplace" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_nodata_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.remove_nodata_inplace" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to remove no data values from the data.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_nodata_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to remove no data values from the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_removed</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
        <span class="n">nodata_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">nodata_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodata&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nodata_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1">#print(f&quot;Removing nodata {nodata_value} values for band {band}...&quot;)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nodata_value</span><span class="p">)</span>
            <span class="n">data_removed</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">data_removed</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nodata values removed from the data. In doing so, all bands converted to float32. To turn this behavior off, set remove_nodata=False.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tried to remove nodata values and set them to nans, but no nodata values found in the data.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.scale_data_inplace" class="doc doc-heading">
<code class="highlight language-python"><span class="n">scale_data_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.scale_data_inplace" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to scale the data.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scale_data_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to scale the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
        <span class="n">scale_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scale&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">scale_factor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">scale_factor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">band_info</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">band</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">scale_factor</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">scale_factor</span><span class="p">)</span> <span class="k">if</span> <span class="n">scale_factor</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale_factor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">*</span> <span class="n">scale_factor</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Data scaled to float reflectance. To turn this behavior off, set scale_data=False.&quot;</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="easysnowdata.remote_sensing.Sentinel2.search_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">search_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.Sentinel2.search_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The method to search the data.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">search_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The method to search the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Choose the catalog URL based on catalog_choice</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">==</span> <span class="s2">&quot;planetarycomputer&quot;</span><span class="p">:</span>
        <span class="n">catalog_url</span> <span class="o">=</span> <span class="s2">&quot;https://planetarycomputer.microsoft.com/api/stac/v1&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="n">pystac_client</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="n">catalog_url</span><span class="p">,</span> <span class="n">modifier</span><span class="o">=</span><span class="n">planetary_computer</span><span class="o">.</span><span class="n">sign_inplace</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_choice</span> <span class="o">==</span> <span class="s2">&quot;earthsearch&quot;</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AWS_REGION&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;us-west-2&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;GDAL_DISABLE_READDIR_ON_OPEN&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;EMPTY_DIR&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AWS_NO_SIGN_REQUEST&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;YES&quot;</span>
        <span class="n">catalog_url</span> <span class="o">=</span> <span class="s2">&quot;https://earth-search.aws.element84.com/v1&quot;</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="n">pystac_client</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">catalog_url</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid catalog_choice. Choose either &#39;planetarycomputer&#39; or &#39;earthsearch&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Search for items within the specified bbox and date range</span>
    <span class="n">search</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
        <span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="p">],</span>
        <span class="n">bbox</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span>
        <span class="n">datetime</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="n">search</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data searched. Access the returned seach with the .search attribute.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="easysnowdata.remote_sensing.authenticate_all" class="doc doc-heading">
<code class="highlight language-python"><span class="n">authenticate_all</span><span class="p">()</span></code>


<a href="#easysnowdata.remote_sensing.authenticate_all" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Authenticates with all potential data providers.</p>
<p>This function authenticates with NASA EarthData, Planetary Computer, and Earth Engine.
It prints the authentication status for each provider.</p>

        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">authenticate_all</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Authenticates with all potential data providers.</span>

<span class="sd">    This function authenticates with NASA EarthData, Planetary Computer, and Earth Engine.</span>
<span class="sd">    It prints the authentication status for each provider.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Authenticating for all potential data providers...&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Authenticating for NASA EarthData...&quot;</span><span class="p">)</span>
    <span class="n">earthaccess</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">persist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># print(&quot;Authenticating for Planetary Computer...&quot;)</span>
    <span class="c1"># planetary_computer.set_subscription_key()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Authenticating for Earth Engine...&quot;</span><span class="p">)</span>
    <span class="n">ee</span><span class="o">.</span><span class="n">Authenticate</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="easysnowdata.remote_sensing.get_esa_worldcover" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_esa_worldcover</span><span class="p">(</span><span class="n">bbox_input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;v200&#39;</span><span class="p">,</span> <span class="n">mask_nodata</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.get_esa_worldcover" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Fetches 10m ESA WorldCover global land cover data (2020 v100 or 2021 v200) for a given bounding box.</p>
<p>Description:
The discrete classification maps provide 11 classes defined using the Land Cover Classification System (LCCS)
developed by the United Nations (UN) Food and Agriculture Organization (FAO).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox_input</code></td>
        <td><code>geopandas.geodataframe.GeoDataFrame | tuple | shapely.geometry.base.BaseGeometry | None</code></td>
        <td><p>GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>version</code></td>
        <td><code>str</code></td>
        <td><p>Version of the WorldCover data. The two versions are v100 (2020) and v200 (2021). Default is 'v200'.</p></td>
        <td><code>&#39;v200&#39;</code></td>
      </tr>
      <tr>
        <td><code>mask_nodata</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to mask no data values. Default is False.
If False: (dtype=uint8, rio.nodata=0, rio.encoded_nodata=None)
If True: (dtype=float32, rio.nodata=nan, rio.encoded_nodata=0)</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataArray</code></td>
      <td><p>WorldCover DataArray with class information in attributes.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_esa_worldcover</span><span class="p">(</span>
    <span class="n">bbox_input</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseGeometry</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;v200&quot;</span><span class="p">,</span> <span class="n">mask_nodata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetches 10m ESA WorldCover global land cover data (2020 v100 or 2021 v200) for a given bounding box.</span>

<span class="sd">    Description:</span>
<span class="sd">    The discrete classification maps provide 11 classes defined using the Land Cover Classification System (LCCS)</span>
<span class="sd">    developed by the United Nations (UN) Food and Agriculture Organization (FAO).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bbox_input : geopandas.GeoDataFrame or tuple or Shapely Geometry</span>
<span class="sd">        GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">    version : str, optional</span>
<span class="sd">        Version of the WorldCover data. The two versions are v100 (2020) and v200 (2021). Default is &#39;v200&#39;.</span>
<span class="sd">    mask_nodata : bool, optional</span>
<span class="sd">        Whether to mask no data values. Default is False.</span>
<span class="sd">        If False: (dtype=uint8, rio.nodata=0, rio.encoded_nodata=None)</span>
<span class="sd">        If True: (dtype=float32, rio.nodata=nan, rio.encoded_nodata=0)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xarray.DataArray</span>
<span class="sd">        WorldCover DataArray with class information in attributes.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; import easysnowdata</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Define a bounding box for Mount Rainier</span>
<span class="sd">    &gt;&gt;&gt; bbox = (-121.94, 46.72, -121.54, 46.99)</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Fetch WorldCover data for the area</span>
<span class="sd">    &gt;&gt;&gt; worldcover_da = easysnowdata.remote_sensing.get_esa_worldcover(bbox)</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Plot the data using the example plot function</span>
<span class="sd">    &gt;&gt;&gt; f, ax = worldcover_da.attrs[&#39;example_plot&#39;](worldcover_da)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Data citation:</span>
<span class="sd">    Zanaga, D., Van De Kerchove, R., De Keersmaecker, W., Souverijns, N., Brockmann, C., Quast, R., Wevers, J., Grosu, A.,</span>
<span class="sd">    Paccini, A., Vergnaud, S., Cartus, O., Santoro, M., Fritz, S., Georgieva, I., Lesiv, M., Carter, S., Herold, M., Li, Linlin,</span>
<span class="sd">    Tsendbazar, N.E., Ramoino, F., Arino, O. (2021). ESA WorldCover 10 m 2020 v100. doi:10.5281/zenodo.5571936.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_info</span><span class="p">():</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">10</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Tree cover&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#006400&quot;</span><span class="p">},</span>
            <span class="mi">20</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Shrubland&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#FFBB22&quot;</span><span class="p">},</span>
            <span class="mi">30</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Grassland&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#FFFF4C&quot;</span><span class="p">},</span>
            <span class="mi">40</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cropland&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#F096FF&quot;</span><span class="p">},</span>
            <span class="mi">50</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Built-up&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#FA0000&quot;</span><span class="p">},</span>
            <span class="mi">60</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Bare / sparse vegetation&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#B4B4B4&quot;</span><span class="p">},</span>
            <span class="mi">70</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Snow and ice&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#F0F0F0&quot;</span><span class="p">},</span>
            <span class="mi">80</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Permanent water bodies&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#0064C8&quot;</span><span class="p">},</span>
            <span class="mi">90</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Herbaceous wetland&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#0096A0&quot;</span><span class="p">},</span>
            <span class="mi">95</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Mangroves&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#00CF75&quot;</span><span class="p">},</span>
            <span class="mi">100</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Moss and lichen&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#FAE6A0&quot;</span><span class="p">},</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">classes</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_cmap</span><span class="p">(</span><span class="n">classes</span><span class="p">):</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span>
            <span class="p">[</span><span class="n">classes</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">classes</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">cmap</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">legend_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>

        <span class="n">class_values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">class_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">class_values</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">class_values</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">class_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">]</span> <span class="o">+</span> <span class="n">bounds</span> <span class="o">+</span> <span class="p">[</span><span class="n">class_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">]</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

        <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1">#ax.set_aspect(&quot;equal&quot;)</span>

        <span class="n">legend_handles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">class_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">class_value</span><span class="p">,</span> <span class="n">class_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">legend_handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">class_info</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">class_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

        <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="n">legend_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">default_legend_kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">),</span>
            <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ncol&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_names</span><span class="p">)</span> <span class="o">//</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;frameon&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;handlelength&quot;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">,</span>
            <span class="s2">&quot;handleheight&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">default_legend_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">}</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_handles</span><span class="p">,</span> <span class="n">class_names</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Longitude&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Latitude&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ESA WorldCover</span><span class="se">\n</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">version_year</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">5.5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">5.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span>

        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">ax</span>

    <span class="c1"># Convert the input to a GeoDataFrame if it&#39;s not already one</span>
    <span class="n">bbox_gdf</span> <span class="o">=</span> <span class="n">convert_bbox_to_geodataframe</span><span class="p">(</span><span class="n">bbox_input</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;v100&quot;</span><span class="p">:</span>
        <span class="n">version_year</span> <span class="o">=</span> <span class="s2">&quot;2020&quot;</span>
    <span class="k">elif</span> <span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;v200&quot;</span><span class="p">:</span>
        <span class="n">version_year</span> <span class="o">=</span> <span class="s2">&quot;2021&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Incorrect version number. Please provide &#39;v100&#39; or &#39;v200&#39;.&quot;</span><span class="p">)</span>

    <span class="n">catalog</span> <span class="o">=</span> <span class="n">pystac_client</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
        <span class="s2">&quot;https://planetarycomputer.microsoft.com/api/stac/v1&quot;</span><span class="p">,</span>
        <span class="n">modifier</span><span class="o">=</span><span class="n">planetary_computer</span><span class="o">.</span><span class="n">sign_inplace</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">search</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;esa-worldcover&quot;</span><span class="p">],</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">)</span>
    <span class="n">worldcover_da</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">odc</span><span class="o">.</span><span class="n">stac</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
            <span class="n">search</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="s2">&quot;map&quot;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{}</span>
        <span class="p">)[</span><span class="s2">&quot;map&quot;</span><span class="p">]</span>
        <span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">version_year</span><span class="p">)</span>
        <span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">mask_nodata</span><span class="p">:</span>
        <span class="n">worldcover_da</span> <span class="o">=</span> <span class="n">worldcover_da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">worldcover_da</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">worldcover_da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_nodata</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">worldcover_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_class_info</span><span class="p">()</span>
    <span class="n">worldcover_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_class_cmap</span><span class="p">(</span><span class="n">worldcover_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">])</span>
    <span class="n">worldcover_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;data_citation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Zanaga, D., Van De Kerchove, R., De Keersmaecker, W., Souverijns, N., Brockmann, C., Quast, R., Wevers, J., Grosu, A., Paccini, A., Vergnaud, S., Cartus, O., Santoro, M., Fritz, S., Georgieva, I., Lesiv, M., Carter, S., Herold, M., Li, Linlin, Tsendbazar, N.E., Ramoino, F., Arino, O. (2021). ESA WorldCover 10 m 2020 v100. doi:10.5281/zenodo.5571936.&quot;</span>

    <span class="n">worldcover_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;example_plot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_classes</span>

    <span class="k">return</span> <span class="n">worldcover_da</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="easysnowdata.remote_sensing.get_forest_cover_fraction" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_forest_cover_fraction</span><span class="p">(</span><span class="n">bbox_input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_nodata</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.get_forest_cover_fraction" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Fetches ~100m forest cover fraction data for a given bounding box.</p>
<p>Description:
The data is obtained from the Copernicus Global Land Service: Land Cover 100m: collection 3: epoch 2019: Globe dataset.
The specific layer used is the Tree-CoverFraction-layer, which provides the fractional cover (%) for the forest class.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox_input</code></td>
        <td><code>geopandas.geodataframe.GeoDataFrame | tuple | shapely.geometry.base.BaseGeometry | None</code></td>
        <td><p>GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>mask_nodata</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to mask no data values. Default is False.
If False: (dtype=uint8, rio.nodata=255, rio.encoded_nodata=None)
If True: (dtype=float32, rio.nodata=nan, rio.encoded_nodata=255)</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataArray</code></td>
      <td><p>Forest cover fraction DataArray.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_forest_cover_fraction</span><span class="p">(</span><span class="n">bbox_input</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseGeometry</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mask_nodata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetches ~100m forest cover fraction data for a given bounding box.</span>

<span class="sd">    Description:</span>
<span class="sd">    The data is obtained from the Copernicus Global Land Service: Land Cover 100m: collection 3: epoch 2019: Globe dataset.</span>
<span class="sd">    The specific layer used is the Tree-CoverFraction-layer, which provides the fractional cover (%) for the forest class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bbox_input : geopandas.GeoDataFrame or tuple or shapely.Geometry</span>
<span class="sd">        GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">    mask_nodata : bool, optional</span>
<span class="sd">        Whether to mask no data values. Default is False.</span>
<span class="sd">        If False: (dtype=uint8, rio.nodata=255, rio.encoded_nodata=None)</span>
<span class="sd">        If True: (dtype=float32, rio.nodata=nan, rio.encoded_nodata=255)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xarray.DataArray</span>
<span class="sd">        Forest cover fraction DataArray.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; from easysnowdata import remote_sensing</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Define a bounding box for an area of interest</span>
<span class="sd">    &gt;&gt;&gt; bbox = (-122.5, 47.0, -121.5, 48.0)</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Fetch forest cover fraction data</span>
<span class="sd">    &gt;&gt;&gt; forest_cover = remote_sensing.get_forest_cover_fraction(bbox)</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Plot the data using the example plot function</span>
<span class="sd">    &gt;&gt;&gt; f, ax = forest_cover.attrs[&#39;example_plot&#39;](forest_cover)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Data citation:</span>
<span class="sd">    Marcel Buchhorn, Bruno Smets, Luc Bertels, Bert De Roo, Myroslava Lesiv, Nandin-Erdene Tsendbazar, Martin Herold, &amp; Steffen Fritz. (2020).</span>
<span class="sd">    Copernicus Global Land Service: Land Cover 100m: collection 3: epoch 2019: Globe (V3.0.1) [Data set]. Zenodo. https://doi.org/10.5281/zenodo.3939050</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_forest_cover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">legend_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>

        <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colormaps</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;Greens&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">cmap</span><span class="o">.</span><span class="n">set_over</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>  <span class="c1"># Set values over 100 (i.e., 255) to white</span>

        <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Forest Cover Fraction (%)&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Longitude&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Latitude&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Copernicus Global Land Service Forest Cover Fraction</span><span class="se">\n</span><span class="s2">Land Cover 100m: collection 3: epoch 2019&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span>

        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">ax</span>

    <span class="c1"># Convert the input to a GeoDataFrame if it&#39;s not already one</span>
    <span class="n">bbox_gdf</span> <span class="o">=</span> <span class="n">convert_bbox_to_geodataframe</span><span class="p">(</span><span class="n">bbox_input</span><span class="p">)</span>

    <span class="n">fcf_da</span> <span class="o">=</span> <span class="n">rxr</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span>
        <span class="s2">&quot;https://zenodo.org/record/3939050/files/PROBAV_LC100_global_v3.0.1_2019-nrt_Tree-CoverFraction-layer_EPSG-4326.tif&quot;</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">mask_and_scale</span><span class="o">=</span><span class="n">mask_nodata</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">fcf_da</span> <span class="o">=</span> <span class="n">fcf_da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip_box</span><span class="p">(</span><span class="o">*</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span><span class="n">crs</span><span class="o">=</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>



    <span class="n">fcf_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;example_plot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_forest_cover</span>
    <span class="n">fcf_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;data_citation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Marcel Buchhorn, Bruno Smets, Luc Bertels, Bert De Roo, Myroslava Lesiv, Nandin-Erdene Tsendbazar, Martin Herold, &amp; Steffen Fritz. (2020). Copernicus Global Land Service: Land Cover 100m: collection 3: epoch 2019: Globe (V3.0.1) [Data set]. Zenodo. https://doi.org/10.5281/zenodo.3939050&quot;</span>

    <span class="k">return</span> <span class="n">fcf_da</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="easysnowdata.remote_sensing.get_nlcd_landcover" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_nlcd_landcover</span><span class="p">(</span><span class="n">bbox_input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="s1">&#39;landcover&#39;</span><span class="p">,</span> <span class="n">initialize_ee</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.get_nlcd_landcover" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Fetches National Land Cover Database (NLCD) data for a given bounding box.</p>
<p>Description:
The National Land Cover Database (NLCD) provides nationwide data on land cover and land cover change 
at a 30m resolution. The dataset includes various layers such as land cover classification, 
impervious surfaces, and urban intensity. Projection is an albers equal area conic projection.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox_input</code></td>
        <td><code>geopandas.geodataframe.GeoDataFrame | tuple | shapely.geometry.base.BaseGeometry | None</code></td>
        <td><p>GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer</code></td>
        <td><code>str</code></td>
        <td><p>The NLCD layer to retrieve. Options are:
- 'landcover'
- 'impervious'
- 'impervious_descriptor'
- 'science_products_land_cover_change_count'
- 'science_products_land_cover_change_first_disturbance_date'
- 'science_products_land_cover_change_index'
- 'science_products_land_cover_science_product'
- 'science_products_forest_disturbance_date'
Default is 'landcover'.</p></td>
        <td><code>&#39;landcover&#39;</code></td>
      </tr>
      <tr>
        <td><code>initialize_ee</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to initialize Earth Engine. Default is True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataArray</code></td>
      <td><p>NLCD DataArray for the specified region and layer.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_nlcd_landcover</span><span class="p">(</span><span class="n">bbox_input</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseGeometry</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
             <span class="n">layer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;landcover&#39;</span><span class="p">,</span>
             <span class="n">initialize_ee</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetches National Land Cover Database (NLCD) data for a given bounding box.</span>

<span class="sd">    Description:</span>
<span class="sd">    The National Land Cover Database (NLCD) provides nationwide data on land cover and land cover change </span>
<span class="sd">    at a 30m resolution. The dataset includes various layers such as land cover classification, </span>
<span class="sd">    impervious surfaces, and urban intensity. Projection is an albers equal area conic projection.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bbox_input : geopandas.GeoDataFrame or tuple or shapely.Geometry</span>
<span class="sd">        GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">    layer : str, optional</span>
<span class="sd">        The NLCD layer to retrieve. Options are:</span>
<span class="sd">        - &#39;landcover&#39;</span>
<span class="sd">        - &#39;impervious&#39;</span>
<span class="sd">        - &#39;impervious_descriptor&#39;</span>
<span class="sd">        - &#39;science_products_land_cover_change_count&#39;</span>
<span class="sd">        - &#39;science_products_land_cover_change_first_disturbance_date&#39;</span>
<span class="sd">        - &#39;science_products_land_cover_change_index&#39;</span>
<span class="sd">        - &#39;science_products_land_cover_science_product&#39;</span>
<span class="sd">        - &#39;science_products_forest_disturbance_date&#39;</span>
<span class="sd">        Default is &#39;landcover&#39;.</span>
<span class="sd">    initialize_ee : bool, optional</span>
<span class="sd">        Whether to initialize Earth Engine. Default is True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xarray.DataArray</span>
<span class="sd">        NLCD DataArray for the specified region and layer.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; import easysnowdata</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Define a bounding box for an area of interest</span>
<span class="sd">    &gt;&gt;&gt; bbox = (-122.5, 47.0, -121.5, 48.0)</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Fetch NLCD land cover data</span>
<span class="sd">    &gt;&gt;&gt; nlcd_landcover_da = easysnowdata.remote_sensing.get_nlcd_landcover(bbox, layer=&#39;landcover&#39;)</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Plot the data</span>
<span class="sd">    &gt;&gt;&gt; nlcd_landcover_da.attrs[&#39;example_plot&#39;](nlcd_landcover_da)</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - NLCD data is only available for the contiguous United States</span>
<span class="sd">    - The latest version (2021) includes data from 2001-2021</span>
<span class="sd">    - Resolution is 30 meters</span>

<span class="sd">    Data citation:</span>
<span class="sd">    Dewitz, J., 2023, National Land Cover Database (NLCD) 2021 Products: U.S. Geological Survey data release, doi:10.5066/P9JZ7AO3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize Earth Engine with high-volume endpoint</span>
    <span class="k">if</span> <span class="n">initialize_ee</span><span class="p">:</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">Initialize</span><span class="p">(</span><span class="n">opt_url</span><span class="o">=</span><span class="s1">&#39;https://earthengine-highvolume.googleapis.com&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initialization turned off. If you haven&#39;t already, please sign in to Google Earth Engine by running:</span><span class="se">\n\n</span><span class="s2">import ee</span><span class="se">\n</span><span class="s2">ee.Authenticate()</span><span class="se">\n</span><span class="s2">ee.Initialize()</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Convert the input to a GeoDataFrame if it&#39;s not already one</span>
    <span class="n">bbox_gdf</span> <span class="o">=</span> <span class="n">convert_bbox_to_geodataframe</span><span class="p">(</span><span class="n">bbox_input</span><span class="p">)</span>

    <span class="n">image_collection</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;USGS/NLCD_RELEASES/2021_REL/NLCD&#39;</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">image_collection</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>

    <span class="n">projection</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">projection</span><span class="p">()</span>

    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span>
        <span class="n">image_collection</span><span class="p">,</span> 
        <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;ee&#39;</span><span class="p">,</span> 
        <span class="n">geometry</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">),</span> 
        <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="p">{},</span>
    <span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">set_spatial_dims</span><span class="p">(</span><span class="n">x_dim</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y_dim</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>

    <span class="n">nlcd_da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span>

    <span class="c1"># would be nice for them to come in as ints</span>
    <span class="c1"># https://github.com/google/Xee/issues/86</span>
    <span class="c1"># https://github.com/google/Xee/issues/146</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_info</span><span class="p">():</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()[</span><span class="s1">&#39;properties&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">layer</span> <span class="o">==</span> <span class="s1">&#39;landcover&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="n">value</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;#</span><span class="si">{</span><span class="n">palette</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">}</span> <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">palette</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;landcover_class_values&#39;</span><span class="p">],</span>
                    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;landcover_class_names&#39;</span><span class="p">],</span>
                    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;landcover_class_palette&#39;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="n">layer</span> <span class="o">==</span> <span class="s1">&#39;impervious&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>  
        <span class="k">elif</span> <span class="n">layer</span> <span class="o">==</span> <span class="s1">&#39;impervious_descriptor&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="n">value</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;#</span><span class="si">{</span><span class="n">palette</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">}</span> <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">palette</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;impervious_descriptor_class_values&#39;</span><span class="p">],</span>
                    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;impervious_descriptor_class_names&#39;</span><span class="p">],</span>
                    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;impervious_descriptor_class_palette&#39;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="n">layer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;science_products&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="n">value</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;#</span><span class="si">{</span><span class="n">palette</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">}</span> <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">palette</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="n">info</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">layer</span><span class="si">}</span><span class="s1">_class_values&#39;</span><span class="p">],</span>
                    <span class="n">info</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">layer</span><span class="si">}</span><span class="s1">_class_names&#39;</span><span class="p">],</span>
                    <span class="n">info</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">layer</span><span class="si">}</span><span class="s1">_class_palette&#39;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_cmap</span><span class="p">(</span><span class="n">classes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">classes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span>
        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="n">classes</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">classes</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">legend_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;impervious&#39;</span><span class="p">:</span>
            <span class="n">class_values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">class_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">class_values</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">class_values</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">class_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">]</span> <span class="o">+</span> <span class="n">bounds</span> <span class="o">+</span> <span class="p">[</span><span class="n">class_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">]</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

            <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">legend_handles</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">class_names</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">class_value</span><span class="p">,</span> <span class="n">class_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">legend_handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">class_info</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">class_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

            <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="n">legend_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
            <span class="n">default_legend_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">),</span>
                <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ncols&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                <span class="s2">&quot;frameon&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;handlelength&quot;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">,</span>
                <span class="s2">&quot;handleheight&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">default_legend_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">}</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_handles</span><span class="p">,</span> <span class="n">class_names</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span> 
            <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">],</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Percent impervious surface [%]&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
        <span class="c1">#ax.axis(&#39;equal&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NLCD </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> (2021)&quot;</span><span class="p">)</span>
        <span class="c1">#f.tight_layout(pad=0, w_pad=0, h_pad=0)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span>

        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">ax</span>

    <span class="n">class_info</span> <span class="o">=</span> <span class="n">get_class_info</span><span class="p">()</span>
    <span class="n">nlcd_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">class_info</span>
    <span class="n">nlcd_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_class_cmap</span><span class="p">(</span><span class="n">class_info</span><span class="p">)</span>
    <span class="n">nlcd_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;example_plot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_classes</span>

    <span class="n">nlcd_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;data_citation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Dewitz, J., 2023, National Land Cover Database (NLCD) 2021 Products: U.S. Geological Survey data release, doi:10.5066/P9JZ7AO3&quot;</span>


    <span class="k">return</span> <span class="n">nlcd_da</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="easysnowdata.remote_sensing.get_seasonal_mountain_snow_mask" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_seasonal_mountain_snow_mask</span><span class="p">(</span><span class="n">bbox_input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_product</span><span class="o">=</span><span class="s1">&#39;mountain_snow&#39;</span><span class="p">,</span> <span class="n">mask_nodata</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.get_seasonal_mountain_snow_mask" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Fetches ~1km static global seasonal (mountain snow / snow) mask for a given bounding box.</p>
<p>Description:
Seasonal Mountain Snow (SMS) mask derived from MODIS MOD10A2 snow cover extent and GTOPO30 digital elevation model
produced at 30 arcsecond spatial resolution.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox_input</code></td>
        <td><code>geopandas.geodataframe.GeoDataFrame | tuple | shapely.geometry.base.BaseGeometry | None</code></td>
        <td><p>GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>data_product</code></td>
        <td><code>str</code></td>
        <td><p>Data product to fetch. Choose from 'snow' or 'mountain_snow'. Default is 'mountain_snow'.</p></td>
        <td><code>&#39;mountain_snow&#39;</code></td>
      </tr>
      <tr>
        <td><code>mask_nodata</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to mask no data values. Default is False.
If False: (dtype=uint8, rio.nodata=255, rio.encoded_nodata=None)
If True: (dtype=float32, rio.nodata=nan, rio.encoded_nodata=255)</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataArray</code></td>
      <td><p>Mountain snow DataArray with class information in attributes.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_seasonal_mountain_snow_mask</span><span class="p">(</span>
    <span class="n">bbox_input</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseGeometry</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">data_product</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mountain_snow&quot;</span><span class="p">,</span> <span class="n">mask_nodata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetches ~1km static global seasonal (mountain snow / snow) mask for a given bounding box.</span>

<span class="sd">    Description:</span>
<span class="sd">    Seasonal Mountain Snow (SMS) mask derived from MODIS MOD10A2 snow cover extent and GTOPO30 digital elevation model</span>
<span class="sd">    produced at 30 arcsecond spatial resolution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bbox_input : geopandas.GeoDataFrame or tuple or shapely.Geometry</span>
<span class="sd">        GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">    data_product : str, optional</span>
<span class="sd">        Data product to fetch. Choose from &#39;snow&#39; or &#39;mountain_snow&#39;. Default is &#39;mountain_snow&#39;.</span>
<span class="sd">    mask_nodata : bool, optional</span>
<span class="sd">        Whether to mask no data values. Default is False.</span>
<span class="sd">        If False: (dtype=uint8, rio.nodata=255, rio.encoded_nodata=None)</span>
<span class="sd">        If True: (dtype=float32, rio.nodata=nan, rio.encoded_nodata=255)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xarray.DataArray</span>
<span class="sd">        Mountain snow DataArray with class information in attributes.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; import easysnowdata</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Define a bounding box for a mountainous area</span>
<span class="sd">    &gt;&gt;&gt; bbox = (-106.0, 39.0, -105.0, 40.0)</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Fetch mountain snow mask data</span>
<span class="sd">    &gt;&gt;&gt; mountain_snow_da = easysnowdata.remote_sensing.get_seasonal_mountain_snow_mask(bbox)</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Plot the data using the example plot function</span>
<span class="sd">    &gt;&gt;&gt; f, ax = mountain_snow_da.attrs[&#39;example_plot&#39;](mountain_snow_da)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Data citation:</span>
<span class="sd">    Wrzesien, M., Pavelsky, T., Durand, M., Lundquist, J., &amp; Dozier, J. (2019).</span>
<span class="sd">    Global Seasonal Mountain Snow Mask from MODIS MOD10A2 [Data set]. Zenodo. https://doi.org/10.5281/zenodo.2626737</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_info</span><span class="p">(</span><span class="n">data_product</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">data_product</span> <span class="o">==</span> <span class="s2">&quot;snow&quot;</span><span class="p">:</span>
            <span class="n">classes</span> <span class="o">=</span> <span class="p">{</span>
                <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Little-to-no snow&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#030303&quot;</span><span class="p">},</span>
                <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Indeterminate due to clouds&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#755F4A&quot;</span><span class="p">},</span>
                <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Ephemeral snow&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#792B8E&quot;</span><span class="p">},</span>
                <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Seasonal snow&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#679ACF&quot;</span><span class="p">},</span>
                <span class="mi">255</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Fill&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">},</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="n">data_product</span> <span class="o">==</span> <span class="s2">&quot;mountain_snow&quot;</span><span class="p">:</span>
            <span class="n">classes</span> <span class="o">=</span> <span class="p">{</span>
                <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Mountains with little-to-no snow&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#030303&quot;</span><span class="p">},</span>
                <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Indeterminate due to clouds&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#755F4A&quot;</span><span class="p">},</span>
                <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Mountains with ephemeral snow&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#792B8E&quot;</span><span class="p">},</span>
                <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Mountains with seasonal snow&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#679ACF&quot;</span><span class="p">},</span>
                <span class="mi">255</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Fill&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">},</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid data_product. Choose from &quot;snow&quot; or &quot;mountain_snow&quot;.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">classes</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_cmap</span><span class="p">(</span><span class="n">classes</span><span class="p">):</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span>
            <span class="p">[</span><span class="n">classes</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">classes</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">cmap</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">legend_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>

        <span class="n">class_values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">class_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">class_values</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">class_values</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">class_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">]</span> <span class="o">+</span> <span class="n">bounds</span> <span class="o">+</span> <span class="p">[</span><span class="n">class_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">]</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

        <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1">#ax.set_aspect(&quot;equal&quot;)</span>

        <span class="n">legend_handles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">class_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">class_value</span><span class="p">,</span> <span class="n">class_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">legend_handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">class_info</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">class_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

        <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="n">legend_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">default_legend_kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">),</span>
            <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ncol&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_names</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;frameon&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;handlelength&quot;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">,</span>
            <span class="s2">&quot;handleheight&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">default_legend_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">}</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_handles</span><span class="p">,</span> <span class="n">class_names</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Longitude&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Latitude&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Global seasonal </span><span class="si">{</span><span class="s1">&#39;mountain &#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">data_product</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;mountain_snow&#39;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">snow mask</span><span class="se">\n</span><span class="s2">from Wrzesien et al 2019&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">5.5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">5.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span>

        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">ax</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;This function takes a moment, getting zipped file from zenodo...&#39;</span><span class="p">)</span>
    <span class="c1"># Convert the input to a GeoDataFrame if it&#39;s not already one</span>
    <span class="n">bbox_gdf</span> <span class="o">=</span> <span class="n">convert_bbox_to_geodataframe</span><span class="p">(</span><span class="n">bbox_input</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;zip+https://zenodo.org/records/2626737/files/MODIS_</span><span class="si">{</span><span class="s1">&#39;mtnsnow&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">data_product</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;mountain_snow&#39;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;snow&#39;</span><span class="si">}</span><span class="s2">_classes.zip!/MODIS_</span><span class="si">{</span><span class="s1">&#39;mtnsnow&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">data_product</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;mountain_snow&#39;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;snow&#39;</span><span class="si">}</span><span class="s2">_classes.tif&quot;</span>

    <span class="n">mountain_snow_da</span> <span class="o">=</span> <span class="n">rxr</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">mask_and_scale</span><span class="o">=</span><span class="n">mask_nodata</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip_box</span><span class="p">(</span><span class="o">*</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>

    <span class="c1"># looks like the creators accidently set no data to 256 and 265 instead of 255, therefore unmasked the data is of type uint32 :(</span>
    <span class="c1"># attempt to fix this by setting all invalid values to 255, then converting types</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">mountain_snow_da</span> <span class="o">&gt;</span> <span class="mi">3</span>
    <span class="n">mountain_snow_da</span> <span class="o">=</span> <span class="n">mountain_snow_da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">mask</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mask_nodata</span><span class="p">:</span>
        <span class="n">mountain_snow_da</span> <span class="o">=</span> <span class="n">mountain_snow_da</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_nodata</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mountain_snow_da</span> <span class="o">=</span> <span class="n">mountain_snow_da</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">set_nodata</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>


    <span class="n">mountain_snow_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_class_info</span><span class="p">(</span><span class="n">data_product</span><span class="p">)</span>
    <span class="n">mountain_snow_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_class_cmap</span><span class="p">(</span><span class="n">mountain_snow_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">])</span>
    <span class="n">mountain_snow_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;data_citation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Wrzesien, M., Pavelsky, T., Durand, M., Lundquist, J., &amp; Dozier, J. (2019). Global Seasonal Mountain Snow Mask from MODIS MOD10A2 [Data set]. Zenodo. https://doi.org/10.5281/zenodo.2626737&quot;</span>

    <span class="n">mountain_snow_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;example_plot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_classes</span>

    <span class="k">return</span> <span class="n">mountain_snow_da</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="easysnowdata.remote_sensing.get_seasonal_snow_classification" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_seasonal_snow_classification</span><span class="p">(</span><span class="n">bbox_input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_nodata</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#easysnowdata.remote_sensing.get_seasonal_snow_classification" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Fetches 10arcsec (~300m) Sturm &amp; Liston 2021 seasonal snow classification data for a given bounding box.</p>
<p>Description:
This dataset consists of global, seasonal snow classifications determined from air temperature,
precipitation, and wind speed climatologies. This is the 10 arcsec (~300m) product in EPSG:4326.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox_input</code></td>
        <td><code>geopandas.geodataframe.GeoDataFrame | tuple | shapely.geometry.base.BaseGeometry | None</code></td>
        <td><p>GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>mask_nodata</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to mask no data values. Default is False.
If False: (dtype=uint8, rio.nodata=9, rio.encoded_nodata=None)
If True: (dtype=float32, rio.nodata=nan, rio.encoded_nodata=9)</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataArray</code></td>
      <td><p>Seasonal snow class DataArray with class information in attributes.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>easysnowdata/remote_sensing.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_seasonal_snow_classification</span><span class="p">(</span><span class="n">bbox_input</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseGeometry</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mask_nodata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetches 10arcsec (~300m) Sturm &amp; Liston 2021 seasonal snow classification data for a given bounding box.</span>

<span class="sd">    Description:</span>
<span class="sd">    This dataset consists of global, seasonal snow classifications determined from air temperature,</span>
<span class="sd">    precipitation, and wind speed climatologies. This is the 10 arcsec (~300m) product in EPSG:4326.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bbox_input : geopandas.GeoDataFrame or tuple or Shapely Geometry</span>
<span class="sd">        GeoDataFrame containing the bounding box, or a tuple of (xmin, ymin, xmax, ymax), or a Shapely geometry.</span>
<span class="sd">    mask_nodata : bool, optional</span>
<span class="sd">        Whether to mask no data values. Default is False.</span>
<span class="sd">        If False: (dtype=uint8, rio.nodata=9, rio.encoded_nodata=None)</span>
<span class="sd">        If True: (dtype=float32, rio.nodata=nan, rio.encoded_nodata=9)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xarray.DataArray</span>
<span class="sd">        Seasonal snow class DataArray with class information in attributes.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; import easysnowdata</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Define a bounding box for an area of interest</span>
<span class="sd">    &gt;&gt;&gt; bbox = (-120.0, 40.0, -118.0, 42.0)</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Fetch seasonal snow classification data</span>
<span class="sd">    &gt;&gt;&gt; snow_classification_da = easysnowdata.remote_sensing.get_seasonal_snow_classification(bbox)</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; # Plot the data using the example plot function</span>
<span class="sd">    &gt;&gt;&gt; f,ax = snow_classification_da.attrs[&#39;example_plot&#39;](snow_classification_da)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Data citation:</span>
<span class="sd">    Liston, G. E. and M. Sturm. (2021). Global Seasonal-Snow Classification, Version 1 [Data Set].</span>
<span class="sd">    Boulder, Colorado USA. National Snow and Ice Data Center. https://doi.org/10.5067/99FTCYYYLAQ0. Date Accessed 03-06-2024.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_info</span><span class="p">():</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Tundra&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#a100c8&quot;</span><span class="p">},</span>
            <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Boreal Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#00a0fe&quot;</span><span class="p">},</span>
            <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Maritime&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#fe0000&quot;</span><span class="p">},</span>
            <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Ephemeral (includes no snow)&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#e7dc32&quot;</span><span class="p">},</span>
            <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Prairie&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#f08328&quot;</span><span class="p">},</span>
            <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Montane Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#00dc00&quot;</span><span class="p">},</span>
            <span class="mi">7</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Ice (glaciers and ice sheets)&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#aaaaaa&quot;</span><span class="p">},</span>
            <span class="mi">8</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Ocean&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#0000ff&quot;</span><span class="p">},</span>
            <span class="mi">9</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Fill&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">},</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">classes</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_cmap</span><span class="p">(</span><span class="n">classes</span><span class="p">):</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span>
            <span class="p">[</span><span class="n">classes</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">classes</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">cmap</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">legend_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>

        <span class="n">class_values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">class_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">class_values</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">class_values</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">class_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">]</span> <span class="o">+</span> <span class="n">bounds</span> <span class="o">+</span> <span class="p">[</span><span class="n">class_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">]</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

        <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1">#ax.set_aspect(&quot;equal&quot;)</span>


        <span class="n">legend_handles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">class_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">class_value</span><span class="p">,</span> <span class="n">class_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">legend_handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">class_info</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">class_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

        <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="n">legend_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">default_legend_kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">),</span>
            <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ncol&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_names</span><span class="p">)</span> <span class="o">//</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;frameon&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;handlelength&quot;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">,</span>
            <span class="s2">&quot;handleheight&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">default_legend_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">}</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_handles</span><span class="p">,</span> <span class="n">class_names</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Longitude&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Latitude&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Seasonal snow classification</span><span class="se">\n</span><span class="s2">from Sturm &amp; Liston 2021&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span>

        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">ax</span>

    <span class="c1"># Convert the input to a GeoDataFrame if it&#39;s not already one</span>
    <span class="n">bbox_gdf</span> <span class="o">=</span> <span class="n">convert_bbox_to_geodataframe</span><span class="p">(</span><span class="n">bbox_input</span><span class="p">)</span>

    <span class="n">snow_classification_da</span> <span class="o">=</span> <span class="n">rxr</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span>
        <span class="s2">&quot;https://snowmelt.blob.core.windows.net/snowmelt/eric/snow_classification/SnowClass_GL_300m_10.0arcsec_2021_v01.0.tif&quot;</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">mask_and_scale</span><span class="o">=</span><span class="n">mask_nodata</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">snow_classification_da</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">snow_classification_da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip_box</span><span class="p">(</span><span class="o">*</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">,</span><span class="n">crs</span><span class="o">=</span><span class="n">bbox_gdf</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">mask_nodata</span><span class="p">:</span>
        <span class="n">snow_classification_da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_nodata</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">snow_classification_da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">set_nodata</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">snow_classification_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_class_info</span><span class="p">()</span>
    <span class="n">snow_classification_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_class_cmap</span><span class="p">(</span><span class="n">snow_classification_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;class_info&quot;</span><span class="p">])</span>
    <span class="n">snow_classification_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;data_citation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Liston, G. E. and M. Sturm. (2021). Global Seasonal-Snow Classification, Version 1 [Data Set]. Boulder, Colorado USA. National Snow and Ice Data Center. https://doi.org/10.5067/99FTCYYYLAQ0. Date Accessed 03-06-2024.&quot;</span>

    <span class="n">snow_classification_da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;example_plot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_classes</span>

    <span class="k">return</span> <span class="n">snow_classification_da</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-03-03T20:15:48+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-03-03</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-03-03T20:15:48+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-03-03</span>
  </span>

    
    
    
  </aside>





                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 - 2024 Eric Gagliano
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.top", "search.highlight", "search.share"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../js/timeago.min.js"></script>
      
        <script src="../js/timeago_mkdocs_material.js"></script>
      
    
  </body>
</html>